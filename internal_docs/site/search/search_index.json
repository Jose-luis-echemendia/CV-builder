{"config":{"lang":["es"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"\ud83d\udcda Documentaci\u00f3n Interna de la Plataforma","text":"<p>Bienvenido a la documentaci\u00f3n t\u00e9cnica completa del proyecto Feature Model. Esta documentaci\u00f3n est\u00e1 organizada en tres secciones principales que cubren todos los aspectos del sistema.</p>"},{"location":"#acceso-rapido","title":"\ud83d\ude80 Acceso R\u00e1pido","text":""},{"location":"#repositorio","title":"Repositorio","text":"<p> Repositorio GitHub</p>"},{"location":"#proyecto-root","title":"\ud83d\udce6 Proyecto (Root)","text":"<p>Documentaci\u00f3n general del proyecto, arquitectura global y configuraci\u00f3n de despliegue.</p> <p> Explorar Documentaci\u00f3n del Proyecto</p>"},{"location":"#backend","title":"\u2699\ufe0f Backend","text":"<p>API, modelos de datos, servicios, migraciones y documentaci\u00f3n t\u00e9cnica del backend.</p> <p> Explorar Documentaci\u00f3n del Backend</p>"},{"location":"#frontend","title":"\ud83c\udfa8 Frontend","text":"<p>Componentes, p\u00e1ginas, hooks y documentaci\u00f3n del frontend (En construcci\u00f3n).</p> <p> Explorar Documentaci\u00f3n del Frontend</p>"},{"location":"#estructura-de-la-documentacion","title":"\ud83d\udcd6 Estructura de la Documentaci\u00f3n","text":""},{"location":"#proyecto-root_1","title":"\ud83d\udce6 Proyecto (Root)","text":"<p>Documentaci\u00f3n de nivel superior que abarca:</p> <ul> <li>Arquitectura: Estructura de carpetas, base de datos, arquitectura de despliegue</li> <li>Configuraci\u00f3n: Entornos de desarrollo y producci\u00f3n</li> <li>Requisitos: Requisitos funcionales y no funcionales del sistema</li> </ul> <p>Archivos principales:</p> <ul> <li>\u00cdndice del Proyecto</li> <li>README</li> <li>Requisitos</li> <li>Arquitectura - Estructura de Carpetas</li> <li>Arquitectura - Base de Datos</li> <li>Arquitectura - Despliegue</li> <li>Configuraci\u00f3n - Desarrollo</li> <li>Configuraci\u00f3n - Despliegue</li> </ul>"},{"location":"#backend_1","title":"\u2699\ufe0f Backend","text":"<p>Documentaci\u00f3n t\u00e9cnica del backend (FastAPI + PostgreSQL):</p> <p>Core:</p> <ul> <li>README Backend - Introducci\u00f3n y setup</li> <li>Comandos - Comandos \u00fatiles de desarrollo</li> <li>Base de Datos - Esquema y migraciones</li> <li>Arquitectura S3 - Gesti\u00f3n de archivos</li> </ul> <p>Refactorings y Mejoras:</p> <ul> <li>Cambios Educativos</li> <li>Login Endpoints Refactor</li> <li>Resumen Refactor Login</li> <li>Maestr\u00eda Ciencia de Datos</li> <li>Orden de Migraciones</li> <li>Servicio Prestart</li> </ul> <p>Servicios S3:</p> <ul> <li>Refactoring S3</li> <li>Ejemplos S3 Dependencies</li> <li>Cambios Servicio S3</li> <li>Uso Servicio S3</li> </ul> <p>Gesti\u00f3n de Usuarios:</p> <ul> <li>Migraci\u00f3n User Endpoints</li> <li>Roles de Usuario</li> <li>Sugerencias de C\u00f3digo</li> <li>Requisitos Funcionales</li> </ul>"},{"location":"#frontend_1","title":"\ud83c\udfa8 Frontend","text":"<p>Documentaci\u00f3n del frontend (Next.js + TypeScript):</p> <p>En construcci\u00f3n</p> <p>La documentaci\u00f3n del frontend est\u00e1 actualmente en desarrollo. Pr\u00f3ximamente se agregar\u00e1n documentos sobre componentes, hooks, p\u00e1ginas y servicios.</p>"},{"location":"#caracteristicas-de-esta-documentacion","title":"\ud83d\udd27 Caracter\u00edsticas de esta Documentaci\u00f3n","text":"<p>Esta documentaci\u00f3n incluye:</p> <ul> <li>\u2705 B\u00fasqueda en tiempo real - Busca en todo el contenido</li> <li>\u2705 Modo oscuro/claro - Cambia el tema seg\u00fan tu preferencia</li> <li>\u2705 Navegaci\u00f3n por pesta\u00f1as - Organizaci\u00f3n clara por secciones</li> <li>\u2705 C\u00f3digo con resaltado - Syntax highlighting para m\u00faltiples lenguajes</li> <li>\u2705 Diagramas Mermaid - Visualizaci\u00f3n de flujos y arquitecturas</li> <li>\u2705 Responsive - Optimizada para desktop y m\u00f3vil</li> </ul>"},{"location":"#tecnologias-documentadas","title":"\ud83d\udcca Tecnolog\u00edas Documentadas","text":"BackendFrontendDevOps <ul> <li>Framework: FastAPI 0.104+</li> <li>Base de Datos: PostgreSQL 17</li> <li>ORM: SQLModel + SQLAlchemy</li> <li>Cache: Redis</li> <li>Storage: MinIO (S3 compatible)</li> <li>Tasks: Celery</li> <li>Migraciones: Alembic</li> </ul> <ul> <li>Framework: Next.js 14+</li> <li>Lenguaje: TypeScript</li> <li>UI Library: React</li> <li>Estilos: CSS Modules / Tailwind</li> <li>State: Zustand / React Query</li> </ul> <ul> <li>Containerizaci\u00f3n: Docker + Docker Compose</li> <li>CI/CD: GitHub Actions</li> <li>Documentaci\u00f3n: MkDocs Material</li> <li>Linting: ESLint, Ruff, MyPy</li> </ul>"},{"location":"#ayuda-y-soporte","title":"\ud83c\udd98 Ayuda y Soporte","text":"<p>Si encuentras alg\u00fan problema o tienes sugerencias:</p> <ol> <li>\ud83d\udcdd Documentaci\u00f3n incompleta: Abre un issue en GitHub</li> <li>\ud83d\udc1b Bug en la aplicaci\u00f3n: Reporta en el repositorio</li> <li>\ud83d\udca1 Sugerencia de mejora: Crea una discusi\u00f3n en GitHub</li> </ol>"},{"location":"#enlaces-utiles","title":"\ud83d\udccc Enlaces \u00datiles","text":"<ul> <li> Repositorio GitHub</li> </ul> <p>Servicios de la Aplicaci\u00f3n:</p> <p>URLs Din\u00e1micas</p> <p>Los siguientes enlaces se configuran autom\u00e1ticamente seg\u00fan el entorno:</p> <pre><code>- **Desarrollo:** `http://localhost:8000` (backend), `http://localhost:5173` (frontend)\n- **Producci\u00f3n:** Configurado mediante variables de entorno `DOMAIN` y `FRONTEND_URL`\n</code></pre> API DocumentationFrontend <ul> <li>Swagger UI: <code>{{ config.extra.domain }}/docs</code></li> <li>ReDoc: <code>{{ config.extra.domain }}/redoc</code></li> </ul> <ul> <li>Dashboard: <code>{{ config.extra.frontend_url }}</code></li> </ul> <p>Enlaces R\u00e1pidos (Desarrollo):</p> <ul> <li> API Docs - Swagger</li> </ul> <p>Documentaci\u00f3n interactiva de la API con interfaz Swagger UI</p> <p> Abrir Swagger</p> <ul> <li> API Docs - ReDoc</li> </ul> <p>Documentaci\u00f3n de la API en formato ReDoc</p> <p> Abrir ReDoc</p> <ul> <li> Dashboard Frontend</li> </ul> <p>Interfaz de usuario de la aplicaci\u00f3n</p> <p> Abrir Dashboard</p>   **Feature Model Platform** | Documentaci\u00f3n Interna   \u00daltima actualizaci\u00f3n: {{ git.date }}"},{"location":"backend_commands/","title":"\ud83d\udcda Comandos Esenciales del Backend","text":"<p>Este documento contiene todos los comandos importantes para trabajar con el backend de Feature Models.</p>"},{"location":"backend_commands/#comandos-de-base-de-datos","title":"\ud83d\uddc4\ufe0f Comandos de Base de Datos","text":""},{"location":"backend_commands/#migraciones-con-alembic","title":"Migraciones con Alembic","text":""},{"location":"backend_commands/#crear-una-nueva-migracion-auto-detecta-cambios","title":"Crear una nueva migraci\u00f3n (auto-detecta cambios)","text":"<pre><code>alembic revision --autogenerate -m \"descripci\u00f3n de los cambios\"\n</code></pre> <p>Ejemplos:</p> <pre><code>alembic revision --autogenerate -m \"add user roles\"\nalembic revision --autogenerate -m \"add feature constraints table\"\nalembic revision --autogenerate -m \"update feature model relationships\"\n</code></pre>"},{"location":"backend_commands/#crear-una-nueva-migracion-manual","title":"Crear una nueva migraci\u00f3n manual","text":"<pre><code>alembic revision -m \"descripci\u00f3n de los cambios\"\n</code></pre> <p>Ejemplos:</p> <pre><code>alembic revision -m \"add user roles\"\nalembic revision -m \"add feature constraints table\"\nalembic revision -m \"update feature model relationships\"\n</code></pre>"},{"location":"backend_commands/#aplicar-migraciones-pendientes","title":"Aplicar migraciones pendientes","text":"<pre><code>alembic upgrade head\n</code></pre>"},{"location":"backend_commands/#ver-historial-de-migraciones","title":"Ver historial de migraciones","text":"<pre><code>alembic history\n</code></pre>"},{"location":"backend_commands/#ver-migracion-actual","title":"Ver migraci\u00f3n actual","text":"<pre><code>alembic current\n</code></pre>"},{"location":"backend_commands/#revertir-ultima-migracion","title":"Revertir \u00faltima migraci\u00f3n","text":"<pre><code>alembic downgrade -1\n</code></pre>"},{"location":"backend_commands/#revertir-a-una-revision-especifica","title":"Revertir a una revisi\u00f3n espec\u00edfica","text":"<pre><code>alembic downgrade &lt;revision_id&gt;\n</code></pre>"},{"location":"backend_commands/#revertir-todas-las-migraciones","title":"Revertir todas las migraciones","text":"<pre><code>alembic downgrade base\n</code></pre>"},{"location":"backend_commands/#comandos-de-seeding-poblacion-de-datos","title":"\ud83c\udf31 Comandos de Seeding (Poblaci\u00f3n de Datos)","text":""},{"location":"backend_commands/#ejecutar-seeding-completo-automatico-segun-entorno","title":"Ejecutar seeding completo (autom\u00e1tico seg\u00fan entorno)","text":"<pre><code>python -m app.seed.main\n</code></pre> <ul> <li>Producci\u00f3n/Staging: Solo datos esenciales (settings, FIRST_SUPERUSER, usuarios de producci\u00f3n)</li> <li>Local/Development: Datos completos (esenciales + ejemplos + usuarios de prueba)</li> </ul>"},{"location":"backend_commands/#script-legacy-redirige-a-seedmain","title":"Script Legacy (redirige a seed.main)","text":"<pre><code>python -m app.seed_data\n</code></pre>"},{"location":"backend_commands/#comandos-de-docker","title":"\ud83d\udc33 Comandos de Docker","text":""},{"location":"backend_commands/#desarrollo-local","title":"Desarrollo Local","text":""},{"location":"backend_commands/#iniciar-todos-los-servicios","title":"Iniciar todos los servicios","text":"<pre><code>docker-compose -f docker-compose.dev.yml up\n</code></pre>"},{"location":"backend_commands/#iniciar-en-segundo-plano-detached","title":"Iniciar en segundo plano (detached)","text":"<pre><code>docker-compose -f docker-compose.dev.yml up -d\n</code></pre>"},{"location":"backend_commands/#reconstruir-imagenes-antes-de-iniciar","title":"Reconstruir im\u00e1genes antes de iniciar","text":"<pre><code>docker-compose -f docker-compose.dev.yml up --build\n</code></pre>"},{"location":"backend_commands/#ver-logs-de-un-servicio-especifico","title":"Ver logs de un servicio espec\u00edfico","text":"<pre><code>docker-compose -f docker-compose.dev.yml logs -f backend\ndocker-compose -f docker-compose.dev.yml logs -f db\ndocker-compose -f docker-compose.dev.yml logs -f redis\n</code></pre>"},{"location":"backend_commands/#detener-todos-los-servicios","title":"Detener todos los servicios","text":"<pre><code>docker-compose -f docker-compose.dev.yml down\n</code></pre>"},{"location":"backend_commands/#detener-y-eliminar-volumenes-borra-la-base-de-datos","title":"Detener y eliminar vol\u00famenes (\u26a0\ufe0f BORRA LA BASE DE DATOS)","text":"<pre><code>docker-compose -f docker-compose.dev.yml down -v\n</code></pre>"},{"location":"backend_commands/#ejecutar-comandos-dentro-del-contenedor-backend","title":"Ejecutar comandos dentro del contenedor backend","text":"<pre><code>docker-compose -f docker-compose.dev.yml exec backend bash\ndocker-compose -f docker-compose.dev.yml exec backend python -m pytest\ndocker-compose -f docker-compose.dev.yml exec backend alembic upgrade head\n</code></pre>"},{"location":"backend_commands/#reiniciar-solo-el-backend","title":"Reiniciar solo el backend","text":"<pre><code>docker-compose -f docker-compose.dev.yml restart backend\n</code></pre>"},{"location":"backend_commands/#produccion","title":"Producci\u00f3n","text":""},{"location":"backend_commands/#iniciar-servicios-de-produccion","title":"Iniciar servicios de producci\u00f3n","text":"<pre><code>docker-compose -f docker-compose.prod.yml up -d\n</code></pre>"},{"location":"backend_commands/#ver-logs-de-produccion","title":"Ver logs de producci\u00f3n","text":"<pre><code>docker-compose -f docker-compose.prod.yml logs -f\n</code></pre>"},{"location":"backend_commands/#detener-servicios-de-produccion","title":"Detener servicios de producci\u00f3n","text":"<pre><code>docker-compose -f docker-compose.prod.yml down\n</code></pre>"},{"location":"backend_commands/#comandos-de-testing","title":"\ud83e\uddea Comandos de Testing","text":""},{"location":"backend_commands/#ejecutar-todos-los-tests","title":"Ejecutar todos los tests","text":"<pre><code>pytest\n</code></pre>"},{"location":"backend_commands/#ejecutar-tests-con-cobertura","title":"Ejecutar tests con cobertura","text":"<pre><code>pytest --cov=app --cov-report=html\n</code></pre>"},{"location":"backend_commands/#ejecutar-tests-especificos","title":"Ejecutar tests espec\u00edficos","text":"<pre><code>pytest tests/test_users.py\npytest tests/test_users.py::test_create_user\n</code></pre>"},{"location":"backend_commands/#ejecutar-tests-en-modo-verbose","title":"Ejecutar tests en modo verbose","text":"<pre><code>pytest -v\n</code></pre>"},{"location":"backend_commands/#ejecutar-tests-y-detener-en-el-primer-fallo","title":"Ejecutar tests y detener en el primer fallo","text":"<pre><code>pytest -x\n</code></pre>"},{"location":"backend_commands/#comandos-del-servidor-desarrollo-sin-docker","title":"\ud83d\ude80 Comandos del Servidor (Desarrollo sin Docker)","text":""},{"location":"backend_commands/#iniciar-servidor-de-desarrollo-con-uvicorn","title":"Iniciar servidor de desarrollo con Uvicorn","text":"<pre><code>uvicorn app.main:app --reload --host 0.0.0.0 --port 8000\n</code></pre>"},{"location":"backend_commands/#con-hot-reload-y-logs-detallados","title":"Con hot-reload y logs detallados","text":"<pre><code>uvicorn app.main:app --reload --log-level debug\n</code></pre>"},{"location":"backend_commands/#comandos-de-dependencias","title":"\ud83d\udce6 Comandos de Dependencias","text":""},{"location":"backend_commands/#instalar-dependencias","title":"Instalar dependencias","text":"<pre><code>pip install -r requirements.txt\n</code></pre>"},{"location":"backend_commands/#instalar-dependencias-de-desarrollo","title":"Instalar dependencias de desarrollo","text":"<pre><code>pip install -r requirements-dev.txt\n</code></pre>"},{"location":"backend_commands/#actualizar-requirements-desde-poetry-si-usas-poetry","title":"Actualizar requirements desde Poetry (si usas Poetry)","text":"<pre><code>poetry export -f requirements.txt --output requirements.txt --without-hashes\n</code></pre>"},{"location":"backend_commands/#ver-dependencias-instaladas","title":"Ver dependencias instaladas","text":"<pre><code>pip list\npip freeze\n</code></pre>"},{"location":"backend_commands/#comandos-de-debugging","title":"\ud83d\udd0d Comandos de Debugging","text":""},{"location":"backend_commands/#acceder-a-shell-interactivo-de-python-con-contexto-de-la-app","title":"Acceder a shell interactivo de Python con contexto de la app","text":"<pre><code>python -c \"from app.core.db import engine; from sqlmodel import Session; session = Session(engine); print('Session ready')\"\n</code></pre>"},{"location":"backend_commands/#ver-configuracion-actual","title":"Ver configuraci\u00f3n actual","text":"<pre><code>python -c \"from app.core.config import settings; print(settings.model_dump())\"\n</code></pre>"},{"location":"backend_commands/#verificar-conexion-a-base-de-datos","title":"Verificar conexi\u00f3n a base de datos","text":"<pre><code>python app/backend_pre_start.py\n</code></pre>"},{"location":"backend_commands/#comandos-de-limpieza","title":"\ud83e\uddf9 Comandos de Limpieza","text":""},{"location":"backend_commands/#limpiar-archivos-python-compilados","title":"Limpiar archivos Python compilados","text":"<pre><code>find . -type d -name __pycache__ -exec rm -r {} +\nfind . -type f -name \"*.pyc\" -delete\n</code></pre>"},{"location":"backend_commands/#limpiar-cache-de-pytest","title":"Limpiar cache de pytest","text":"<pre><code>rm -rf .pytest_cache\n</code></pre>"},{"location":"backend_commands/#limpiar-coverage-reports","title":"Limpiar coverage reports","text":"<pre><code>rm -rf htmlcov .coverage\n</code></pre>"},{"location":"backend_commands/#comandos-de-mantenimiento","title":"\ud83d\udd27 Comandos de Mantenimiento","text":""},{"location":"backend_commands/#crear-backup-de-la-base-de-datos","title":"Crear backup de la base de datos","text":"<pre><code>docker-compose -f docker-compose.dev.yml exec db pg_dump -U postgres featuremodels &gt; backup_$(date +%Y%m%d_%H%M%S).sql\n</code></pre>"},{"location":"backend_commands/#restaurar-backup","title":"Restaurar backup","text":"<pre><code>docker-compose -f docker-compose.dev.yml exec -T db psql -U postgres featuremodels &lt; backup_20231124_120000.sql\n</code></pre>"},{"location":"backend_commands/#limpiar-volumenes-docker-no-usados","title":"Limpiar vol\u00famenes Docker no usados","text":"<pre><code>docker volume prune\n</code></pre>"},{"location":"backend_commands/#ver-uso-de-espacio-de-docker","title":"Ver uso de espacio de Docker","text":"<pre><code>docker system df\n</code></pre>"},{"location":"backend_commands/#comandos-utiles-de-desarrollo","title":"\ud83d\udcdd Comandos \u00datiles de Desarrollo","text":""},{"location":"backend_commands/#formatear-codigo-con-black","title":"Formatear c\u00f3digo con Black","text":"<pre><code>black app/\n</code></pre>"},{"location":"backend_commands/#ordenar-imports-con-isort","title":"Ordenar imports con isort","text":"<pre><code>isort app/\n</code></pre>"},{"location":"backend_commands/#linter-con-flake8","title":"Linter con Flake8","text":"<pre><code>flake8 app/\n</code></pre>"},{"location":"backend_commands/#type-checking-con-mypy","title":"Type checking con MyPy","text":"<pre><code>mypy app/\n</code></pre>"},{"location":"backend_commands/#ejecutar-pre-commit-hooks-manualmente","title":"Ejecutar pre-commit hooks manualmente","text":"<pre><code>pre-commit run --all-files\n</code></pre>"},{"location":"backend_commands/#comandos-de-seguridad","title":"\ud83d\udd10 Comandos de Seguridad","text":""},{"location":"backend_commands/#generar-secret_key-nueva","title":"Generar SECRET_KEY nueva","text":"<pre><code>python -c \"import secrets; print(secrets.token_urlsafe(32))\"\n</code></pre>"},{"location":"backend_commands/#hashear-una-contrasena","title":"Hashear una contrase\u00f1a","text":"<pre><code>python -c \"from passlib.context import CryptContext; pwd_context = CryptContext(schemes=['bcrypt'], deprecated='auto'); print(pwd_context.hash('mi_password'))\"\n</code></pre>"},{"location":"backend_commands/#comandos-de-monitoreo","title":"\ud83d\udcca Comandos de Monitoreo","text":""},{"location":"backend_commands/#ver-estado-de-celery-workers","title":"Ver estado de Celery workers","text":"<pre><code>docker-compose -f docker-compose.dev.yml exec celery_worker celery -A app.worker inspect active\n</code></pre>"},{"location":"backend_commands/#ver-tareas-en-cola","title":"Ver tareas en cola","text":"<pre><code>docker-compose -f docker-compose.dev.yml exec celery_worker celery -A app.worker inspect reserved\n</code></pre>"},{"location":"backend_commands/#purgar-todas-las-tareas-de-celery","title":"Purgar todas las tareas de Celery","text":"<pre><code>docker-compose -f docker-compose.dev.yml exec celery_worker celery -A app.worker purge\n</code></pre>"},{"location":"backend_commands/#flujo-tipico-de-desarrollo","title":"\ud83d\udea6 Flujo T\u00edpico de Desarrollo","text":""},{"location":"backend_commands/#1-inicio-del-dia-primera-vez","title":"1. Inicio del d\u00eda (primera vez)","text":"<pre><code># Clonar repositorio (solo primera vez)\ngit clone &lt;repository-url&gt;\ncd feature_model\n\n# Copiar variables de entorno\ncp .env.example .env\n\n# Iniciar servicios\ndocker-compose -f docker-compose.dev.yml up -d\n\n# Ver logs\ndocker-compose -f docker-compose.dev.yml logs -f backend\n</code></pre>"},{"location":"backend_commands/#2-hacer-cambios-en-modelos","title":"2. Hacer cambios en modelos","text":"<pre><code># 1. Modificar models en app/models/\n\n# 2. Crear migraci\u00f3n\ndocker-compose -f docker-compose.dev.yml exec backend alembic revision --autogenerate -m \"descripci\u00f3n\"\n\n# 3. Aplicar migraci\u00f3n\ndocker-compose -f docker-compose.dev.yml exec backend alembic upgrade head\n\n# 4. Si necesitas datos nuevos, ejecutar seeding\ndocker-compose -f docker-compose.dev.yml exec backend python -m app.seed.main\n</code></pre>"},{"location":"backend_commands/#3-ejecutar-tests","title":"3. Ejecutar tests","text":"<pre><code>docker-compose -f docker-compose.dev.yml exec backend pytest -v\n</code></pre>"},{"location":"backend_commands/#4-limpiar-y-reiniciar-desde-cero","title":"4. Limpiar y reiniciar desde cero","text":"<pre><code># \u26a0\ufe0f CUIDADO: Esto borra toda la base de datos\ndocker-compose -f docker-compose.dev.yml down -v\ndocker-compose -f docker-compose.dev.yml up -d\n</code></pre>"},{"location":"backend_commands/#notas-importantes","title":"\ud83d\udccc Notas Importantes","text":"<ul> <li>Migraciones: Siempre revisa las migraciones autogeneradas antes de aplicarlas</li> <li>Seeding: El seeding es autom\u00e1tico en desarrollo, manual en producci\u00f3n</li> <li>Backups: Haz backups antes de cambios importantes en la BD</li> <li>Testing: Ejecuta tests antes de hacer commits importantes</li> <li>Logs: Usa <code>docker-compose logs -f</code> para ver logs en tiempo real</li> </ul>"},{"location":"backend_commands/#comandos-de-emergencia","title":"\ud83c\udd98 Comandos de Emergencia","text":""},{"location":"backend_commands/#backend-no-responde","title":"Backend no responde","text":"<pre><code>docker-compose -f docker-compose.dev.yml restart backend\n</code></pre>"},{"location":"backend_commands/#base-de-datos-corrupta","title":"Base de datos corrupta","text":"<pre><code>docker-compose -f docker-compose.dev.yml down -v\ndocker-compose -f docker-compose.dev.yml up -d\n</code></pre>"},{"location":"backend_commands/#limpiar-todo-y-empezar-de-nuevo","title":"Limpiar todo y empezar de nuevo","text":"<pre><code>docker-compose -f docker-compose.dev.yml down -v\ndocker system prune -a\ndocker-compose -f docker-compose.dev.yml up --build\n</code></pre> <p>\u00daltima actualizaci\u00f3n: 24 de noviembre de 2025</p>"},{"location":"root_1_architecture_ARCHITECTURAL_PATTERN_ANALYSIS/","title":"\ud83c\udfdb\ufe0f An\u00e1lisis del Patr\u00f3n Arquitect\u00f3nico y Motor de Validaci\u00f3n","text":"<p>Fecha: 9 de diciembre de 2025 Proyecto: Feature Models Platform - Backend Enfoque: Identificaci\u00f3n de patr\u00f3n arquitect\u00f3nico actual + Integraci\u00f3n del motor de validaci\u00f3n</p>"},{"location":"root_1_architecture_ARCHITECTURAL_PATTERN_ANALYSIS/#patron-arquitectonico-identificado","title":"\ud83d\udcd0 Patr\u00f3n Arquitect\u00f3nico Identificado","text":""},{"location":"root_1_architecture_ARCHITECTURAL_PATTERN_ANALYSIS/#arquitectura-actual-hibrida-estratificada-layered-plugin-based","title":"Arquitectura Actual: H\u00edbrida Estratificada (Layered + Plugin-based)","text":"<p>Basado en el an\u00e1lisis del c\u00f3digo y la estructura del proyecto, el backend implementa una arquitectura h\u00edbrida que combina:</p>"},{"location":"root_1_architecture_ARCHITECTURAL_PATTERN_ANALYSIS/#1-arquitectura-en-capas-layered-architecture-predominante","title":"1. Arquitectura en Capas (Layered Architecture) - Predominante","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  CAPA DE PRESENTACI\u00d3N (API Layer)              \u2502\n\u2502  - FastAPI Endpoints                            \u2502\n\u2502  - Request/Response Handling                    \u2502\n\u2502  - Dependency Injection                         \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                    \u2193\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  CAPA DE APLICACI\u00d3N (Application/Service Layer)\u2502\n\u2502  - Business Logic                               \u2502\n\u2502  - Orchestration Services                       \u2502\n\u2502  - Feature Flags                                \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                    \u2193\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  CAPA DE DOMINIO (Domain Layer)                \u2502\n\u2502  - Feature Models (Domain Objects)              \u2502\n\u2502  - Feature Trees &amp; Constraints                  \u2502\n\u2502  - Validation Rules                             \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                    \u2193\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  CAPA DE ACCESO A DATOS (Data Access Layer)    \u2502\n\u2502  - Repository Pattern (Sync/Async)              \u2502\n\u2502  - Database Abstraction                         \u2502\n\u2502  - ORM (SQLModel)                               \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                    \u2193\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  CAPA DE INFRAESTRUCTURA (Infrastructure)       \u2502\n\u2502  - PostgreSQL                                   \u2502\n\u2502  - Redis Cache                                  \u2502\n\u2502  - S3/MinIO Storage                             \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"root_1_architecture_ARCHITECTURAL_PATTERN_ANALYSIS/#2-arquitectura-de-plugins-elementos-presentes","title":"2. Arquitectura de Plugins (Elementos Presentes)","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502         CORE APPLICATION                     \u2502\n\u2502                                              \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510            \u2502\n\u2502  \u2502 Repository \u2502  \u2502 Service    \u2502            \u2502\n\u2502  \u2502 Interfaces \u2502  \u2502 Interfaces \u2502            \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518            \u2502\n\u2502        \u2191               \u2191                     \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         \u2502               \u2502\n    \u250c\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n    \u2502 Sync       \u2502  \u2502 Async       \u2502\n    \u2502 Impl.      \u2502  \u2502 Impl.       \u2502\n    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         PLUGINS (Intercambiables)\n</code></pre> <p>Elementos de Plugin Architecture presentes:</p> <ul> <li>\u2705 Interfaces bien definidas (<code>Protocol</code>)</li> <li>\u2705 M\u00faltiples implementaciones intercambiables (sync/async)</li> <li>\u2705 Dependency Injection para selecci\u00f3n en runtime</li> <li>\u274c Falta: Plugin registry formal</li> <li>\u274c Falta: Dynamic plugin loading</li> </ul>"},{"location":"root_1_architecture_ARCHITECTURAL_PATTERN_ANALYSIS/#3-elementos-de-microkernel-architecture","title":"3. Elementos de Microkernel Architecture","text":"<p>El patr\u00f3n Microkernel (o Plugin Architecture avanzado) tambi\u00e9n est\u00e1 presente parcialmente:</p> <pre><code>     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n     \u2502   MINIMAL CORE SYSTEM       \u2502\n     \u2502  - FastAPI Application      \u2502\n     \u2502  - Dependency Injection     \u2502\n     \u2502  - Base Models              \u2502\n     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n              \u2191      \u2191      \u2191\n              \u2502      \u2502      \u2502\n        \u250c\u2500\u2500\u2500\u2500\u2500\u2518      \u2502      \u2514\u2500\u2500\u2500\u2500\u2500\u2510\n        \u2502            \u2502            \u2502\n    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n    \u2502 Redis \u2502  \u2502   S3    \u2502  \u2502 Celery  \u2502\n    \u2502Service\u2502  \u2502 Service \u2502  \u2502 Tasks   \u2502\n    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n     EXTERNAL PLUGINS (Services)\n</code></pre>"},{"location":"root_1_architecture_ARCHITECTURAL_PATTERN_ANALYSIS/#clasificacion-definitiva","title":"\ud83c\udfaf Clasificaci\u00f3n Definitiva","text":""},{"location":"root_1_architecture_ARCHITECTURAL_PATTERN_ANALYSIS/#patron-principal-arquitectura-en-capas-layered-architecture","title":"Patr\u00f3n Principal: Arquitectura en Capas (Layered Architecture)","text":"<p>Justificaci\u00f3n:</p> <ol> <li>\u2705 Clara separaci\u00f3n en capas (<code>api/</code>, <code>services/</code>, <code>models/</code>, <code>repositories/</code>, <code>core/</code>)</li> <li>\u2705 Dependencias unidireccionales (top-down)</li> <li>\u2705 Cada capa tiene responsabilidades bien definidas</li> <li>\u2705 Comunicaci\u00f3n entre capas mediante interfaces</li> <li>\u2705 Aislamiento de infraestructura</li> </ol> <p>Variante espec\u00edfica: Clean Architecture / Hexagonal Architecture (Ports &amp; Adapters)</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502          APPLICATION CORE (Domain)               \u2502\n\u2502  - Feature Models                                \u2502\n\u2502  - Business Rules                                \u2502\n\u2502  - Validation Logic                              \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n              \u2191                    \u2191\n              \u2502                    \u2502\n     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n     \u2502  INPUT PORTS    \u2502   \u2502  OUTPUT PORTS  \u2502\n     \u2502  (Interfaces)   \u2502   \u2502  (Interfaces)  \u2502\n     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n              \u2191                    \u2191\n              \u2502                    \u2502\n     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n     \u2502   ADAPTERS      \u2502   \u2502   ADAPTERS     \u2502\n     \u2502 - API (FastAPI) \u2502   \u2502 - Repositories \u2502\n     \u2502 - CLI           \u2502   \u2502 - External APIs\u2502\n     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre> <p>Evidencia en el c\u00f3digo:</p> <pre><code># PORTS (Interfaces/Protocols)\nclass IDomainRepositoryAsync(Protocol):\n    async def create(self, data: DomainCreate) -&gt; Domain: ...\n    async def get(self, domain_id: UUID) -&gt; Optional[Domain]: ...\n\n# ADAPTERS (Implementaciones concretas)\nclass DomainRepositoryAsync(BaseDomainRepository, IDomainRepositoryAsync):\n    def __init__(self, session: AsyncSession):\n        self.session = session\n\n    async def create(self, data: DomainCreate) -&gt; Domain:\n        # Implementaci\u00f3n espec\u00edfica de PostgreSQL\n        ...\n\n# APPLICATION CORE (Domain)\nclass Domain(BaseTable, DomainBase, table=True):\n    \"\"\"Modelo de dominio puro\"\"\"\n    __tablename__ = \"domains\"\n\n    name: str = Field(max_length=100, index=True)\n    description: Optional[str] = Field(default=None)\n</code></pre>"},{"location":"root_1_architecture_ARCHITECTURAL_PATTERN_ANALYSIS/#integracion-del-motor-de-validacion","title":"\ud83d\udd27 Integraci\u00f3n del Motor de Validaci\u00f3n","text":""},{"location":"root_1_architecture_ARCHITECTURAL_PATTERN_ANALYSIS/#ubicacion-arquitectonica-de-los-3-componentes","title":"Ubicaci\u00f3n Arquitect\u00f3nica de los 3 Componentes","text":"<p>Los tres componentes del motor de validaci\u00f3n se integran en la Capa de Aplicaci\u00f3n/Servicios, creando un subsistema especializado:</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              CAPA DE PRESENTACI\u00d3N (API)                  \u2502\n\u2502  /api/v1/validation/                                     \u2502\n\u2502  /api/v1/configuration/                                  \u2502\n\u2502  /api/v1/analysis/                                       \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                         \u2193\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502          CAPA DE APLICACI\u00d3N (Services)                   \u2502\n\u2502                                                          \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502\n\u2502  \u2502      \ud83d\udd0d MOTOR DE VALIDACI\u00d3N (Subsistema)           \u2502 \u2502\n\u2502  \u2502                                                    \u2502 \u2502\n\u2502  \u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502 \u2502\n\u2502  \u2502  \u2502 1\ufe0f\u20e3 VALIDADOR L\u00d3GICO (SAT/SMT Solver)        \u2502 \u2502 \u2502\n\u2502  \u2502  \u2502  - python-sat (PySAT)                       \u2502 \u2502 \u2502\n\u2502  \u2502  \u2502  - z3-solver                                \u2502 \u2502 \u2502\n\u2502  \u2502  \u2502  - Validaci\u00f3n de constraints                \u2502 \u2502 \u2502\n\u2502  \u2502  \u2502  - Verificaci\u00f3n de consistencia             \u2502 \u2502 \u2502\n\u2502  \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502 \u2502\n\u2502  \u2502                                                    \u2502 \u2502\n\u2502  \u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502 \u2502\n\u2502  \u2502  \u2502 2\ufe0f\u20e3 GENERADOR DE CONFIGURACIONES             \u2502 \u2502 \u2502\n\u2502  \u2502  \u2502  - Algoritmos gen\u00e9ticos (DEAP)              \u2502 \u2502 \u2502\n\u2502  \u2502  \u2502  - Beam search                              \u2502 \u2502 \u2502\n\u2502  \u2502  \u2502  - Random sampling guiado                   \u2502 \u2502 \u2502\n\u2502  \u2502  \u2502  - Integraci\u00f3n con SAT solver               \u2502 \u2502 \u2502\n\u2502  \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502 \u2502\n\u2502  \u2502                                                    \u2502 \u2502\n\u2502  \u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502 \u2502\n\u2502  \u2502  \u2502 3\ufe0f\u20e3 ANALIZADOR ESTRUCTURAL                   \u2502 \u2502 \u2502\n\u2502  \u2502  \u2502  - NetworkX (an\u00e1lisis de grafos)            \u2502 \u2502 \u2502\n\u2502  \u2502  \u2502  - Dead features detection                  \u2502 \u2502 \u2502\n\u2502  \u2502  \u2502  - Componentes fuertemente conexas          \u2502 \u2502 \u2502\n\u2502  \u2502  \u2502  - M\u00e9tricas de impacto                      \u2502 \u2502 \u2502\n\u2502  \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502 \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                         \u2193\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              CAPA DE DOMINIO (Models)                    \u2502\n\u2502  - Feature, FeatureModel, Constraint, Configuration      \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"root_1_architecture_ARCHITECTURAL_PATTERN_ANALYSIS/#stack-tecnologico-recomendado-por-componente","title":"\ud83d\udcda Stack Tecnol\u00f3gico Recomendado por Componente","text":""},{"location":"root_1_architecture_ARCHITECTURAL_PATTERN_ANALYSIS/#1-validador-logico-satsmt-solver","title":"1\ufe0f\u20e3 Validador L\u00f3gico (SAT/SMT Solver)","text":""},{"location":"root_1_architecture_ARCHITECTURAL_PATTERN_ANALYSIS/#librerias-recomendadas","title":"Librer\u00edas Recomendadas:","text":"Librer\u00eda Uso Principal Ventajas Instalaci\u00f3n python-sat (PySAT) \u2b50 SAT solving primario - M\u00faltiples solvers (Glucose, MiniSat)- API Pythonic- Excelente documentaci\u00f3n <code>pip install python-sat</code> z3-solver SMT solving avanzado - Teor\u00edas combinadas- Optimizaci\u00f3n- Microsoft Research <code>pip install z3-solver</code> pycosat SAT solving ligero - Muy r\u00e1pido- M\u00ednimas dependencias <code>pip install pycosat</code>"},{"location":"root_1_architecture_ARCHITECTURAL_PATTERN_ANALYSIS/#recomendacion-principal-python-sat-pysat","title":"Recomendaci\u00f3n Principal: python-sat (PySAT)","text":"<p>Justificaci\u00f3n:</p> <ul> <li>\u2705 Dise\u00f1ado espec\u00edficamente para Python</li> <li>\u2705 Soporte para CNF/DNF</li> <li>\u2705 M\u00faltiples backends de solvers</li> <li>\u2705 API de alto nivel y bajo nivel</li> <li>\u2705 Usado en investigaci\u00f3n de SPL</li> </ul> <p>Ejemplo de integraci\u00f3n:</p> <pre><code># backend/app/services/validation/sat_validator.py\n\nfrom pysat.solvers import Glucose3\nfrom pysat.formula import CNF\nfrom typing import List, Tuple, Set\nfrom app.models import Feature, Constraint, Configuration\n\nclass SATValidator:\n    \"\"\"Validador l\u00f3gico usando SAT solver.\"\"\"\n\n    def __init__(self):\n        self.solver = None\n        self.var_mapping = {}  # feature_id -&gt; SAT variable\n\n    def build_cnf_from_feature_model(\n        self,\n        features: List[Feature],\n        constraints: List[Constraint]\n    ) -&gt; CNF:\n        \"\"\"Convierte un Feature Model a formato CNF.\"\"\"\n        cnf = CNF()\n        var_counter = 1\n\n        # 1. Mapear features a variables SAT\n        for feature in features:\n            self.var_mapping[str(feature.id)] = var_counter\n            var_counter += 1\n\n        # 2. Codificar jerarqu\u00eda (parent-child)\n        for feature in features:\n            if feature.parent_id:\n                parent_var = self.var_mapping[str(feature.parent_id)]\n                child_var = self.var_mapping[str(feature.id)]\n\n                # Si parent est\u00e1 seleccionado y feature es MANDATORY\n                if feature.type == FeatureType.MANDATORY:\n                    # parent \u2192 child (equivalente a: \u00acparent \u2228 child)\n                    cnf.append([-parent_var, child_var])\n\n                # child \u2192 parent (si hijo est\u00e1, padre debe estar)\n                cnf.append([-child_var, parent_var])\n\n        # 3. Codificar grupos (OR/XOR)\n        for feature in features:\n            if feature.feature_group_id:\n                # Implementar cardinalidad del grupo\n                # min &lt;= seleccionados &lt;= max\n                pass  # Ver implementaci\u00f3n completa abajo\n\n        # 4. Codificar cross-tree constraints\n        for constraint in constraints:\n            source_var = self.var_mapping[str(constraint.source_feature_id)]\n            target_var = self.var_mapping[str(constraint.target_feature_id)]\n\n            if constraint.type == ConstraintType.REQUIRES:\n                # source \u2192 target: \u00acsource \u2228 target\n                cnf.append([-source_var, target_var])\n\n            elif constraint.type == ConstraintType.EXCLUDES:\n                # source \u2227 target = false: \u00acsource \u2228 \u00actarget\n                cnf.append([-source_var, -target_var])\n\n        return cnf\n\n    async def validate_configuration(\n        self,\n        configuration: Configuration,\n        feature_model_version_id: UUID\n    ) -&gt; Tuple[bool, List[str]]:\n        \"\"\"\n        Valida si una configuraci\u00f3n es v\u00e1lida seg\u00fan el FM.\n\n        Returns:\n            (is_valid, error_messages)\n        \"\"\"\n        # 1. Obtener FM y constraints\n        features = await self._get_features(feature_model_version_id)\n        constraints = await self._get_constraints(feature_model_version_id)\n\n        # 2. Construir CNF del modelo\n        cnf = self.build_cnf_from_feature_model(features, constraints)\n\n        # 3. Agregar decisiones del usuario como cl\u00e1usulas unitarias\n        selected_ids = configuration.selected_feature_ids\n        for feature_id in selected_ids:\n            var = self.var_mapping.get(str(feature_id))\n            if var:\n                cnf.append([var])  # Forzar que est\u00e9 seleccionada\n\n        # 4. Resolver con SAT solver\n        solver = Glucose3()\n        solver.append_formula(cnf)\n\n        is_satisfiable = solver.solve()\n\n        if not is_satisfiable:\n            # Encontrar conflicto (core insatisfacible)\n            errors = self._diagnose_conflicts(solver, configuration)\n            return False, errors\n\n        return True, []\n\n    async def is_feature_model_consistent(\n        self,\n        feature_model_version_id: UUID\n    ) -&gt; Tuple[bool, str]:\n        \"\"\"\n        Verifica si el FM es consistente (tiene al menos una configuraci\u00f3n v\u00e1lida).\n        \"\"\"\n        features = await self._get_features(feature_model_version_id)\n        constraints = await self._get_constraints(feature_model_version_id)\n\n        cnf = self.build_cnf_from_feature_model(features, constraints)\n\n        solver = Glucose3()\n        solver.append_formula(cnf)\n\n        if solver.solve():\n            return True, \"Feature Model es consistente\"\n        else:\n            return False, \"Feature Model es inconsistente - no tiene configuraciones v\u00e1lidas\"\n</code></pre>"},{"location":"root_1_architecture_ARCHITECTURAL_PATTERN_ANALYSIS/#2-generador-de-configuraciones","title":"2\ufe0f\u20e3 Generador de Configuraciones","text":""},{"location":"root_1_architecture_ARCHITECTURAL_PATTERN_ANALYSIS/#librerias-recomendadas_1","title":"Librer\u00edas Recomendadas:","text":"Librer\u00eda Uso Principal Ventajas Instalaci\u00f3n DEAP \u2b50 Algoritmos gen\u00e9ticos - Framework completo GA- Flexible- Bien documentado <code>pip install deap</code> scipy.optimize Optimizaci\u00f3n general - Parte de SciPy- M\u00faltiples algoritmos Incluido en scipy ortools Constraint Programming - Google OR-Tools- CP-SAT solver- Optimizaci\u00f3n <code>pip install ortools</code>"},{"location":"root_1_architecture_ARCHITECTURAL_PATTERN_ANALYSIS/#recomendacion-enfoque-hibrido","title":"Recomendaci\u00f3n: Enfoque H\u00edbrido","text":"<p>Estrategia 1: Generaci\u00f3n Aleatoria Guiada (R\u00e1pida)</p> <pre><code># backend/app/services/generation/random_generator.py\n\nimport random\nfrom typing import List, Set\nfrom app.models import Feature, FeatureType\n\nclass RandomConfigurationGenerator:\n    \"\"\"Generador simple mediante muestreo aleatorio guiado.\"\"\"\n\n    async def generate(\n        self,\n        feature_model_version_id: UUID,\n        count: int = 10\n    ) -&gt; List[Set[UUID]]:\n        \"\"\"Genera configuraciones aleatorias v\u00e1lidas.\"\"\"\n        configurations = []\n\n        features = await self._get_features(feature_model_version_id)\n        feature_tree = self._build_tree(features)\n\n        for _ in range(count):\n            selected = set()\n\n            # Estrategia: DFS desde root, decidiendo aleatoriamente\n            self._select_recursive(\n                feature_tree.root,\n                selected,\n                feature_tree\n            )\n\n            # Validar con SAT solver\n            if await self.sat_validator.is_valid(selected):\n                configurations.append(selected)\n\n        return configurations\n\n    def _select_recursive(\n        self,\n        feature: Feature,\n        selected: Set[UUID],\n        tree\n    ):\n        \"\"\"Selecci\u00f3n recursiva con decisiones aleatorias.\"\"\"\n        # Si es MANDATORY, siempre incluir\n        if feature.type == FeatureType.MANDATORY:\n            selected.add(feature.id)\n            for child in tree.get_children(feature.id):\n                self._select_recursive(child, selected, tree)\n\n        # Si es OPTIONAL, decidir aleatoriamente\n        elif feature.type == FeatureType.OPTIONAL:\n            if random.random() &gt; 0.5:  # 50% probabilidad\n                selected.add(feature.id)\n                for child in tree.get_children(feature.id):\n                    self._select_recursive(child, selected, tree)\n\n        # Si es grupo OR/XOR, seleccionar seg\u00fan cardinalidad\n        # ...\n</code></pre> <p>Estrategia 2: Algoritmos Gen\u00e9ticos (Exploraci\u00f3n Avanzada)</p> <pre><code># backend/app/services/generation/genetic_generator.py\n\nfrom deap import base, creator, tools, algorithms\nimport random\nfrom typing import List, Set, Tuple\n\nclass GeneticConfigurationGenerator:\n    \"\"\"Generador usando algoritmos gen\u00e9ticos (DEAP).\"\"\"\n\n    def __init__(self, feature_model_version_id: UUID):\n        self.fm_version_id = feature_model_version_id\n        self.features = None\n        self.sat_validator = SATValidator()\n\n        # Configurar DEAP\n        creator.create(\"FitnessMax\", base.Fitness, weights=(1.0,))\n        creator.create(\"Individual\", list, fitness=creator.FitnessMax)\n\n        self.toolbox = base.Toolbox()\n\n    async def setup(self):\n        \"\"\"Inicializar generador con features del modelo.\"\"\"\n        self.features = await self._get_features(self.fm_version_id)\n\n        # Gen: cada bit representa si una feature est\u00e1 seleccionada\n        self.toolbox.register(\n            \"attr_bool\",\n            random.randint,\n            0, 1\n        )\n\n        # Individual: lista de bits (uno por feature)\n        self.toolbox.register(\n            \"individual\",\n            tools.initRepeat,\n            creator.Individual,\n            self.toolbox.attr_bool,\n            n=len(self.features)\n        )\n\n        # Population\n        self.toolbox.register(\n            \"population\",\n            tools.initRepeat,\n            list,\n            self.toolbox.individual\n        )\n\n        # Operadores gen\u00e9ticos\n        self.toolbox.register(\"mate\", tools.cxTwoPoint)\n        self.toolbox.register(\"mutate\", tools.mutFlipBit, indpb=0.05)\n        self.toolbox.register(\"select\", tools.selTournament, tournsize=3)\n        self.toolbox.register(\"evaluate\", self._fitness_function)\n\n    def _fitness_function(self, individual: List[int]) -&gt; Tuple[float,]:\n        \"\"\"\n        Funci\u00f3n de fitness para evaluar configuraciones.\n\n        Criterios:\n        1. Validez l\u00f3gica (SAT) - peso m\u00e1ximo\n        2. N\u00famero de features seleccionadas - preferir m\u00e1s features\n        3. Diversidad - explorar espacio de soluciones\n        \"\"\"\n        # Convertir individual a set de feature IDs\n        selected_ids = {\n            self.features[i].id\n            for i, bit in enumerate(individual)\n            if bit == 1\n        }\n\n        # Validar con SAT\n        is_valid = asyncio.run(\n            self.sat_validator.validate_partial(selected_ids, self.fm_version_id)\n        )\n\n        if not is_valid:\n            return (0.0,)  # Fitness 0 para configuraciones inv\u00e1lidas\n\n        # Fitness basado en n\u00famero de features\n        num_selected = sum(individual)\n        fitness = num_selected / len(self.features)\n\n        return (fitness,)\n\n    async def generate(\n        self,\n        population_size: int = 50,\n        generations: int = 100,\n        count: int = 10\n    ) -&gt; List[Set[UUID]]:\n        \"\"\"\n        Genera configuraciones usando algoritmo gen\u00e9tico.\n\n        Args:\n            population_size: Tama\u00f1o de poblaci\u00f3n\n            generations: N\u00famero de generaciones\n            count: N\u00famero de configuraciones \u00fanicas a retornar\n        \"\"\"\n        # Crear poblaci\u00f3n inicial\n        population = self.toolbox.population(n=population_size)\n\n        # Evolucionar\n        algorithms.eaSimple(\n            population,\n            self.toolbox,\n            cxpb=0.7,  # Probabilidad de crossover\n            mutpb=0.2,  # Probabilidad de mutaci\u00f3n\n            ngen=generations,\n            verbose=False\n        )\n\n        # Extraer mejores configuraciones \u00fanicas\n        valid_configs = set()\n        for individual in population:\n            if individual.fitness.values[0] &gt; 0:  # Solo v\u00e1lidas\n                config = frozenset(\n                    self.features[i].id\n                    for i, bit in enumerate(individual)\n                    if bit == 1\n                )\n                valid_configs.add(config)\n\n        # Retornar top N\n        return [set(config) for config in list(valid_configs)[:count]]\n</code></pre> <p>Estrategia 3: Constraint Programming (Google OR-Tools)</p> <pre><code># backend/app/services/generation/cp_generator.py\n\nfrom ortools.sat.python import cp_model\nfrom typing import List, Set\n\nclass CPConfigurationGenerator:\n    \"\"\"Generador usando Constraint Programming (OR-Tools).\"\"\"\n\n    async def generate_optimal(\n        self,\n        feature_model_version_id: UUID,\n        objective: str = \"maximize_features\"  # o \"minimize_cost\"\n    ) -&gt; Set[UUID]:\n        \"\"\"\n        Genera configuraci\u00f3n \u00f3ptima seg\u00fan objetivo.\n        \"\"\"\n        features = await self._get_features(feature_model_version_id)\n        constraints = await self._get_constraints(feature_model_version_id)\n\n        # Crear modelo CP\n        model = cp_model.CpModel()\n\n        # Variables: una por feature (0 = no seleccionada, 1 = seleccionada)\n        feature_vars = {}\n        for f in features:\n            feature_vars[str(f.id)] = model.NewBoolVar(f\"feature_{f.id}\")\n\n        # Constraints de jerarqu\u00eda\n        for f in features:\n            if f.parent_id:\n                parent_var = feature_vars[str(f.parent_id)]\n                child_var = feature_vars[str(f.id)]\n\n                # child \u2192 parent\n                model.Add(child_var &lt;= parent_var)\n\n                # Si MANDATORY: parent \u2192 child\n                if f.type == FeatureType.MANDATORY:\n                    model.Add(parent_var &lt;= child_var)\n\n        # Constraints cross-tree\n        for c in constraints:\n            source_var = feature_vars[str(c.source_feature_id)]\n            target_var = feature_vars[str(c.target_feature_id)]\n\n            if c.type == ConstraintType.REQUIRES:\n                model.Add(source_var &lt;= target_var)\n            elif c.type == ConstraintType.EXCLUDES:\n                model.Add(source_var + target_var &lt;= 1)\n\n        # Objetivo\n        if objective == \"maximize_features\":\n            model.Maximize(sum(feature_vars.values()))\n        elif objective == \"minimize_cost\":\n            # Asumir que features tienen costo en properties\n            costs = [\n                f.properties.get(\"cost\", 1) * feature_vars[str(f.id)]\n                for f in features\n            ]\n            model.Minimize(sum(costs))\n\n        # Resolver\n        solver = cp_model.CpSolver()\n        status = solver.Solve(model)\n\n        if status == cp_model.OPTIMAL or status == cp_model.FEASIBLE:\n            selected = {\n                f.id\n                for f in features\n                if solver.Value(feature_vars[str(f.id)]) == 1\n            }\n            return selected\n\n        return set()\n</code></pre>"},{"location":"root_1_architecture_ARCHITECTURAL_PATTERN_ANALYSIS/#3-analizador-estructural","title":"3\ufe0f\u20e3 Analizador Estructural","text":""},{"location":"root_1_architecture_ARCHITECTURAL_PATTERN_ANALYSIS/#librerias-recomendadas_2","title":"Librer\u00edas Recomendadas:","text":"Librer\u00eda Uso Principal Ventajas Instalaci\u00f3n NetworkX \u2b50 An\u00e1lisis de grafos - Completo- Algoritmos cl\u00e1sicos- Visualizaci\u00f3n <code>pip install networkx</code> graph-tool Grafos grandes - Alto rendimiento- C++ backend <code>pip install graph-tool</code> igraph Grafos cient\u00edficos - R\u00e1pido- M\u00e9tricas avanzadas <code>pip install python-igraph</code>"},{"location":"root_1_architecture_ARCHITECTURAL_PATTERN_ANALYSIS/#recomendacion-principal-networkx","title":"Recomendaci\u00f3n Principal: NetworkX","text":"<pre><code># backend/app/services/analysis/structural_analyzer.py\n\nimport networkx as nx\nfrom typing import List, Dict, Set, Tuple\nfrom app.models import Feature, Constraint\n\nclass StructuralAnalyzer:\n    \"\"\"Analizador estructural de Feature Models usando teor\u00eda de grafos.\"\"\"\n\n    def __init__(self):\n        self.graph = None\n        self.feature_map = {}\n\n    async def analyze(\n        self,\n        feature_model_version_id: UUID\n    ) -&gt; Dict[str, any]:\n        \"\"\"\n        An\u00e1lisis estructural completo del FM.\n\n        Returns:\n            {\n                \"dead_features\": [...],\n                \"core_features\": [...],\n                \"redundant_constraints\": [...],\n                \"strongly_connected_components\": [...],\n                \"metrics\": {...}\n            }\n        \"\"\"\n        features = await self._get_features(feature_model_version_id)\n        constraints = await self._get_constraints(feature_model_version_id)\n\n        # Construir grafo dirigido\n        self.graph = self._build_directed_graph(features, constraints)\n\n        results = {\n            \"dead_features\": await self._detect_dead_features(),\n            \"core_features\": await self._detect_core_features(),\n            \"false_optional\": await self._detect_false_optional(),\n            \"redundant_constraints\": await self._detect_redundant_constraints(),\n            \"scc\": self._find_strongly_connected_components(),\n            \"metrics\": self._compute_metrics(),\n            \"impact_analysis\": await self._compute_impact_scores(),\n        }\n\n        return results\n\n    def _build_directed_graph(\n        self,\n        features: List[Feature],\n        constraints: List[Constraint]\n    ) -&gt; nx.DiGraph:\n        \"\"\"Construye grafo dirigido del FM.\"\"\"\n        G = nx.DiGraph()\n\n        # Agregar nodos (features)\n        for f in features:\n            self.feature_map[str(f.id)] = f\n            G.add_node(\n                str(f.id),\n                type=f.type,\n                name=f.name,\n                mandatory=f.type == FeatureType.MANDATORY\n            )\n\n        # Agregar aristas (relaciones parent-child)\n        for f in features:\n            if f.parent_id:\n                G.add_edge(\n                    str(f.parent_id),\n                    str(f.id),\n                    relation=\"parent_child\",\n                    mandatory=f.type == FeatureType.MANDATORY\n                )\n\n        # Agregar aristas de constraints\n        for c in constraints:\n            G.add_edge(\n                str(c.source_feature_id),\n                str(c.target_feature_id),\n                relation=\"constraint\",\n                type=c.type\n            )\n\n        return G\n\n    async def _detect_dead_features(self) -&gt; List[Dict]:\n        \"\"\"\n        Detecta features muertas (nunca pueden ser seleccionadas).\n\n        M\u00e9todo:\n        1. Para cada feature, verificar con SAT si existe configuraci\u00f3n v\u00e1lida que la incluya\n        2. Si no existe, es dead feature\n        \"\"\"\n        dead_features = []\n        sat_validator = SATValidator()\n\n        for feature_id in self.graph.nodes():\n            # Intentar configuraci\u00f3n forzando esta feature\n            is_possible = await sat_validator.can_select_feature(\n                feature_id,\n                self.fm_version_id\n            )\n\n            if not is_possible:\n                feature = self.feature_map[feature_id]\n                dead_features.append({\n                    \"id\": feature_id,\n                    \"name\": feature.name,\n                    \"reason\": \"No existe configuraci\u00f3n v\u00e1lida que incluya esta feature\"\n                })\n\n        return dead_features\n\n    async def _detect_core_features(self) -&gt; List[Dict]:\n        \"\"\"\n        Detecta features core (siempre deben estar en configuraciones v\u00e1lidas).\n\n        M\u00e9todo:\n        1. Para cada feature, verificar con SAT si existe configuraci\u00f3n v\u00e1lida sin ella\n        2. Si no existe, es core feature\n        \"\"\"\n        core_features = []\n        sat_validator = SATValidator()\n\n        for feature_id in self.graph.nodes():\n            # Intentar configuraci\u00f3n excluyendo esta feature\n            is_possible = await sat_validator.can_exclude_feature(\n                feature_id,\n                self.fm_version_id\n            )\n\n            if not is_possible:\n                feature = self.feature_map[feature_id]\n                core_features.append({\n                    \"id\": feature_id,\n                    \"name\": feature.name,\n                    \"reason\": \"Todas las configuraciones v\u00e1lidas deben incluirla\"\n                })\n\n        return core_features\n\n    async def _detect_false_optional(self) -&gt; List[Dict]:\n        \"\"\"\n        Detecta features marcadas como OPTIONAL pero que en realidad son MANDATORY.\n        \"\"\"\n        false_optional = []\n\n        for feature_id in self.graph.nodes():\n            feature = self.feature_map[feature_id]\n\n            if feature.type == FeatureType.OPTIONAL:\n                # Verificar si en realidad es core\n                is_core = await self._is_core_feature(feature_id)\n\n                if is_core:\n                    false_optional.append({\n                        \"id\": feature_id,\n                        \"name\": feature.name,\n                        \"declared_type\": \"OPTIONAL\",\n                        \"actual_type\": \"MANDATORY\",\n                        \"reason\": \"Constraints implican que siempre debe estar seleccionada\"\n                    })\n\n        return false_optional\n\n    def _find_strongly_connected_components(self) -&gt; List[List[str]]:\n        \"\"\"\n        Encuentra componentes fuertemente conexas (ciclos de dependencias).\n        \"\"\"\n        sccs = list(nx.strongly_connected_components(self.graph))\n\n        # Filtrar solo SCCs con m\u00e1s de un nodo (ciclos reales)\n        cycles = [list(scc) for scc in sccs if len(scc) &gt; 1]\n\n        return cycles\n\n    async def _detect_redundant_constraints(self) -&gt; List[Dict]:\n        \"\"\"\n        Detecta constraints redundantes (impl\u00edcitas por otras constraints).\n        \"\"\"\n        redundant = []\n        constraints = await self._get_constraints(self.fm_version_id)\n\n        for constraint in constraints:\n            # Temporalmente remover este constraint\n            is_redundant = await self._is_constraint_redundant(constraint)\n\n            if is_redundant:\n                redundant.append({\n                    \"constraint_id\": str(constraint.id),\n                    \"type\": constraint.type,\n                    \"source\": str(constraint.source_feature_id),\n                    \"target\": str(constraint.target_feature_id),\n                    \"reason\": \"Impl\u00edcito por otras constraints o jerarqu\u00eda\"\n                })\n\n        return redundant\n\n    def _compute_metrics(self) -&gt; Dict[str, any]:\n        \"\"\"\n        Calcula m\u00e9tricas estructurales del FM.\n        \"\"\"\n        return {\n            \"total_features\": self.graph.number_of_nodes(),\n            \"total_edges\": self.graph.number_of_edges(),\n            \"max_depth\": self._compute_max_depth(),\n            \"branching_factor_avg\": self._compute_avg_branching_factor(),\n            \"density\": nx.density(self.graph),\n            \"diameter\": nx.diameter(self.graph.to_undirected()) if nx.is_connected(self.graph.to_undirected()) else None,\n            \"clustering_coefficient\": nx.average_clustering(self.graph.to_undirected()),\n        }\n\n    async def _compute_impact_scores(self) -&gt; Dict[str, float]:\n        \"\"\"\n        Calcula score de impacto para cada feature.\n\n        Impacto = cu\u00e1ntas otras features se ven afectadas si esta cambia.\n        \"\"\"\n        impact_scores = {}\n\n        for feature_id in self.graph.nodes():\n            # Contar descendientes directos e indirectos\n            descendants = nx.descendants(self.graph, feature_id)\n\n            # Contar features que dependen por constraints\n            dependents = [\n                target\n                for source, target, data in self.graph.edges(data=True)\n                if source == feature_id and data.get(\"relation\") == \"constraint\"\n            ]\n\n            # Score combinado\n            impact_scores[feature_id] = len(descendants) + len(dependents)\n\n        return impact_scores\n\n    def _compute_max_depth(self) -&gt; int:\n        \"\"\"Calcula profundidad m\u00e1xima del \u00e1rbol de features.\"\"\"\n        # Encontrar nodos ra\u00edz (sin padres)\n        roots = [n for n in self.graph.nodes() if self.graph.in_degree(n) == 0]\n\n        max_depth = 0\n        for root in roots:\n            # BFS para encontrar camino m\u00e1s largo\n            depths = nx.single_source_shortest_path_length(self.graph, root)\n            max_depth = max(max_depth, max(depths.values()) if depths else 0)\n\n        return max_depth\n\n    def _compute_avg_branching_factor(self) -&gt; float:\n        \"\"\"Calcula factor de ramificaci\u00f3n promedio.\"\"\"\n        out_degrees = [d for n, d in self.graph.out_degree() if d &gt; 0]\n        return sum(out_degrees) / len(out_degrees) if out_degrees else 0\n</code></pre>"},{"location":"root_1_architecture_ARCHITECTURAL_PATTERN_ANALYSIS/#patron-de-integracion-strategy-pattern","title":"\ud83c\udfa8 Patr\u00f3n de Integraci\u00f3n: Strategy Pattern","text":"<p>Para integrar los 3 componentes de manera flexible, recomiendo usar Strategy Pattern:</p> <pre><code># backend/app/services/validation/validator_strategy.py\n\nfrom abc import ABC, abstractmethod\nfrom typing import Protocol, List, Tuple\nfrom enum import Enum\n\nclass ValidationStrategy(str, Enum):\n    SAT = \"sat\"  # SAT solver (exacto)\n    SMT = \"smt\"  # SMT solver (con teor\u00edas)\n    HEURISTIC = \"heuristic\"  # Validaci\u00f3n heur\u00edstica r\u00e1pida\n\nclass IValidator(Protocol):\n    \"\"\"Interfaz para validadores.\"\"\"\n\n    async def validate_configuration(\n        self,\n        configuration: Configuration,\n        fm_version_id: UUID\n    ) -&gt; Tuple[bool, List[str]]:\n        \"\"\"Valida configuraci\u00f3n.\"\"\"\n        ...\n\nclass ValidatorFactory:\n    \"\"\"Factory para crear validadores seg\u00fan estrategia.\"\"\"\n\n    @staticmethod\n    def create(strategy: ValidationStrategy) -&gt; IValidator:\n        if strategy == ValidationStrategy.SAT:\n            return SATValidator()\n        elif strategy == ValidationStrategy.SMT:\n            return SMTValidator()\n        elif strategy == ValidationStrategy.HEURISTIC:\n            return HeuristicValidator()\n        else:\n            raise ValueError(f\"Unknown strategy: {strategy}\")\n\n# Uso en endpoints\n@router.post(\"/validate/\")\nasync def validate_configuration(\n    config: Configuration,\n    strategy: ValidationStrategy = ValidationStrategy.SAT\n):\n    validator = ValidatorFactory.create(strategy)\n    is_valid, errors = await validator.validate_configuration(config)\n\n    return {\n        \"valid\": is_valid,\n        \"errors\": errors,\n        \"strategy_used\": strategy\n    }\n</code></pre>"},{"location":"root_1_architecture_ARCHITECTURAL_PATTERN_ANALYSIS/#dependencias-a-agregar","title":"\ud83d\udce6 Dependencias a Agregar","text":"<pre><code># backend/pyproject.toml\n\n[project]\ndependencies = [\n    # ... existentes ...\n\n    # Motor de Validaci\u00f3n\n    \"python-sat&gt;=0.1.8.dev13\",  # SAT solving\n    \"z3-solver&gt;=4.12.2.0\",       # SMT solving\n    \"networkx&gt;=3.2\",             # An\u00e1lisis de grafos\n    \"deap&gt;=1.4.1\",               # Algoritmos gen\u00e9ticos\n    \"ortools&gt;=9.8.3296\",         # Constraint Programming\n\n    # Opcional: Visualizaci\u00f3n\n    \"matplotlib&gt;=3.8.0\",         # Para visualizar grafos\n    \"graphviz&gt;=0.20.1\",          # Para exportar grafos\n]\n</code></pre>"},{"location":"root_1_architecture_ARCHITECTURAL_PATTERN_ANALYSIS/#llm-langchain-cuando-usarlo","title":"\ud83d\ude80 LLM / LangChain - \u00bfCu\u00e1ndo Usarlo?","text":""},{"location":"root_1_architecture_ARCHITECTURAL_PATTERN_ANALYSIS/#recomendacion-no-usar-llm-para-validacion-formal","title":"Recomendaci\u00f3n: NO usar LLM para validaci\u00f3n formal","text":"<p>Razones:</p> <ol> <li>\u274c No determin\u00edstico: LLMs no garantizan correcci\u00f3n formal</li> <li>\u274c Lento: Latencia de inferencia vs. microsegundos del SAT solver</li> <li>\u274c Costoso: Tokens vs. computaci\u00f3n local gratuita</li> <li>\u274c No explicable: Dif\u00edcil debugging de decisiones</li> </ol>"},{"location":"root_1_architecture_ARCHITECTURAL_PATTERN_ANALYSIS/#si-usar-llm-para","title":"S\u00cd usar LLM para:","text":""},{"location":"root_1_architecture_ARCHITECTURAL_PATTERN_ANALYSIS/#1-asistencia-al-usuario-ux","title":"1. Asistencia al Usuario (UX)","text":"<pre><code># backend/app/services/ai/feature_assistant.py\n\nfrom langchain.chat_models import ChatOpenAI\nfrom langchain.prompts import ChatPromptTemplate\n\nclass FeatureModelAssistant:\n    \"\"\"Asistente LLM para ayudar a usuarios a entender FMs.\"\"\"\n\n    def __init__(self):\n        self.llm = ChatOpenAI(model=\"gpt-4\")\n\n    async def explain_constraint(\n        self,\n        constraint: Constraint,\n        context: str\n    ) -&gt; str:\n        \"\"\"Explica en lenguaje natural por qu\u00e9 existe un constraint.\"\"\"\n        prompt = ChatPromptTemplate.from_messages([\n            (\"system\", \"Eres un experto en Feature Models educativos.\"),\n            (\"user\",\n             f\"Explica en espa\u00f1ol por qu\u00e9 esta restricci\u00f3n existe:\\n\"\n             f\"Tipo: {constraint.type}\\n\"\n             f\"Desde: {constraint.source_feature.name}\\n\"\n             f\"Hacia: {constraint.target_feature.name}\\n\"\n             f\"Contexto: {context}\")\n        ])\n\n        response = await self.llm.ainvoke(prompt.format_messages())\n        return response.content\n\n    async def suggest_features(\n        self,\n        partial_config: Set[UUID],\n        fm_version_id: UUID\n    ) -&gt; List[str]:\n        \"\"\"Sugiere features complementarias usando LLM.\"\"\"\n        selected_names = [f.name for f in await self._get_features_by_ids(partial_config)]\n\n        prompt = f\"\"\"\n        El estudiante ha seleccionado: {', '.join(selected_names)}\n\n        Bas\u00e1ndote en un plan de estudios de ingenier\u00eda, \u00bfqu\u00e9 otras materias\n        complementarias recomendar\u00edas y por qu\u00e9?\n        \"\"\"\n\n        response = await self.llm.ainvoke(prompt)\n        return self._parse_suggestions(response.content)\n</code></pre>"},{"location":"root_1_architecture_ARCHITECTURAL_PATTERN_ANALYSIS/#2-generacion-de-explicaciones-de-errores","title":"2. Generaci\u00f3n de Explicaciones de Errores","text":"<pre><code>async def explain_validation_error(\n    self,\n    error_type: str,\n    conflicting_features: List[str]\n) -&gt; str:\n    \"\"\"Traduce errores t\u00e9cnicos a lenguaje comprensible.\"\"\"\n    prompt = f\"\"\"\n    Un estudiante intent\u00f3 seleccionar: {', '.join(conflicting_features)}\n\n    Error t\u00e9cnico: {error_type}\n\n    Explica en t\u00e9rminos pedag\u00f3gicos simples por qu\u00e9 esta combinaci\u00f3n no es v\u00e1lida.\n    \"\"\"\n\n    response = await self.llm.ainvoke(prompt)\n    return response.content\n</code></pre>"},{"location":"root_1_architecture_ARCHITECTURAL_PATTERN_ANALYSIS/#3-generacion-de-descripciones-automaticas","title":"3. Generaci\u00f3n de Descripciones Autom\u00e1ticas","text":"<pre><code>async def generate_feature_description(\n    self,\n    feature_name: str,\n    context: Dict\n) -&gt; str:\n    \"\"\"Genera descripci\u00f3n pedag\u00f3gica de una feature.\"\"\"\n    # \u00datil para features creadas autom\u00e1ticamente\n</code></pre>"},{"location":"root_1_architecture_ARCHITECTURAL_PATTERN_ANALYSIS/#arquitectura-hibrida-recomendada","title":"Arquitectura H\u00edbrida Recomendada:","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502         USER REQUEST                   \u2502\n\u2502  \"\u00bfPor qu\u00e9 no puedo seleccionar X?\"   \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n              \u2193\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502     1. SAT VALIDATOR (Formal)         \u2502\n\u2502  Determina: \"Constraint violation\"    \u2502\n\u2502  Identifica: features conflictivas    \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n              \u2193\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502     2. LLM EXPLAINER (Natural)        \u2502\n\u2502  Traduce: error t\u00e9cnico \u2192 lenguaje    \u2502\n\u2502  natural comprensible                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n              \u2193\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502         USER RESPONSE                  \u2502\n\u2502  \"No puedes tomar C\u00e1lculo 2 porque    \u2502\n\u2502   no has aprobado C\u00e1lculo 1\"          \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"root_1_architecture_ARCHITECTURAL_PATTERN_ANALYSIS/#resumen-ejecutivo","title":"\ud83d\udcca Resumen Ejecutivo","text":""},{"location":"root_1_architecture_ARCHITECTURAL_PATTERN_ANALYSIS/#patron-arquitectonico","title":"Patr\u00f3n Arquitect\u00f3nico:","text":"<p>\u2705 Layered Architecture (Clean/Hexagonal variant)</p> <ul> <li>Clara separaci\u00f3n de responsabilidades</li> <li>Dependency Injection</li> <li>Ports &amp; Adapters</li> </ul>"},{"location":"root_1_architecture_ARCHITECTURAL_PATTERN_ANALYSIS/#motor-de-validacion","title":"Motor de Validaci\u00f3n:","text":"Componente Librer\u00eda Principal Alternativas Complejidad Validador L\u00f3gico python-sat z3-solver, pycosat Media Generador DEAP + OR-Tools scipy.optimize Alta Analizador NetworkX igraph, graph-tool Baja-Media"},{"location":"root_1_architecture_ARCHITECTURAL_PATTERN_ANALYSIS/#estrategia-de-implementacion","title":"Estrategia de Implementaci\u00f3n:","text":"<pre><code>Fase 1 (2-3 semanas):\n\u251c\u2500\u2500 Validador SAT b\u00e1sico (python-sat)\n\u251c\u2500\u2500 Generador aleatorio guiado\n\u2514\u2500\u2500 Analizador NetworkX (dead features, core features)\n\nFase 2 (3-4 semanas):\n\u251c\u2500\u2500 Validador SMT (z3-solver)\n\u251c\u2500\u2500 Generador gen\u00e9tico (DEAP)\n\u2514\u2500\u2500 Analizador avanzado (m\u00e9tricas, impacto)\n\nFase 3 (2-3 semanas):\n\u251c\u2500\u2500 Generador CP (OR-Tools)\n\u251c\u2500\u2500 Optimizaci\u00f3n de performance\n\u2514\u2500\u2500 LLM Assistant (explicaciones)\n</code></pre>"},{"location":"root_1_architecture_ARCHITECTURAL_PATTERN_ANALYSIS/#no-usar-llm-para","title":"NO usar LLM para:","text":"<p>\u274c Validaci\u00f3n formal (usar SAT/SMT) \u274c Generaci\u00f3n de configuraciones (usar algoritmos exactos) \u274c An\u00e1lisis estructural (usar grafos)</p>"},{"location":"root_1_architecture_ARCHITECTURAL_PATTERN_ANALYSIS/#si-usar-llm-para_1","title":"S\u00cd usar LLM para:","text":"<p>\u2705 Explicaciones en lenguaje natural \u2705 Asistencia pedag\u00f3gica \u2705 Generaci\u00f3n de descripciones\\begin{figure}[H]             \\centering             \\resizebox{\\textwidth}{!}{%                 \\begin{forest}                     for tree={                         draw,                         rounded corners,                         font=\\footnotesize,                         node options={align=center},                         anchor=north,                         parent anchor=south,                         l sep=15pt,                         s sep=15pt,                         edge={-latex},                         grow=0,                         child anchor=west,                         parent anchor=east                     }                     [Estructura de Datos I                         [Fundamentos y An\u00e1lisis]                         [Estructuras Lineales                             [Arreglos]                             [Listas Enlazadas]                             [Listas Circulares (Opc.)]                         ]                         [Pilas                             [Implementaci\u00f3n (XOR)                                 [Con Arreglos]                                 [Con Listas]                             ]                         ]                         [Colas                             [FIFO]                             [Prioridad]                             [Deque (Opc.)]                         ]                         [\u00c1rboles Binarios]                         [Algoritmos Ordenamiento]                     ]                     \\end{forest}%             }             \\caption{Representaci\u00f3n simplificada del \\ac{FM} de la asignatura Estructura de Datos I.}             \\label{fig:fm_data_structures}             \\end{figure} \u2705 Traducci\u00f3n de errores t\u00e9cnicos</p> <p>Documento generado: 9 de diciembre de 2025 Versi\u00f3n: 1.0 Integraci\u00f3n con: SPL_TECHNIQUES_ANALYSIS.md</p>"},{"location":"root_1_architecture_DEPLOYMENT_ARCHITECTURE/","title":"\ud83c\udfd7\ufe0f Arquitectura de Despliegue en Producci\u00f3n","text":""},{"location":"root_1_architecture_DEPLOYMENT_ARCHITECTURE/#diagrama-de-arquitectura","title":"Diagrama de Arquitectura","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                          INTERNET                                \u2502\n\u2502                             \u2193                                    \u2502\n\u2502                    (HTTPS - Puerto 443)                          \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                               \u2193\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    TRAEFIK (Reverse Proxy)                      \u2502\n\u2502  \u2022 Enrutamiento basado en Host                                 \u2502\n\u2502  \u2022 Certificados SSL autom\u00e1ticos (Let's Encrypt)                \u2502\n\u2502  \u2022 Red: traefik-public                                         \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n               \u2193                         \u2193\n    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510      \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n    \u2502 dashboard.domain \u2502      \u2502  api.domain      \u2502\n    \u2502   (Frontend)     \u2502      \u2502  (Backend)       \u2502\n    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518      \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n             \u2193                         \u2193\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502   FRONTEND SERVICE     \u2502  \u2502   BACKEND SERVICE       \u2502\n\u2502 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502  \u2502 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502\n\u2502 \u2502   Next.js          \u2502 \u2502  \u2502 \u2502  Gunicorn           \u2502 \u2502\n\u2502 \u2502   Standalone       \u2502 \u2502  \u2502 \u2502  + Uvicorn Workers  \u2502 \u2502\n\u2502 \u2502   Server           \u2502 \u2502  \u2502 \u2502  (4 workers)        \u2502 \u2502\n\u2502 \u2502   Puerto: 3000     \u2502 \u2502  \u2502 \u2502  Puerto: 8000       \u2502 \u2502\n\u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502  \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502\n\u2502                        \u2502  \u2502                         \u2502\n\u2502 \u2022 Node 20 Alpine       \u2502  \u2502 \u2022 Python 3.10+          \u2502\n\u2502 \u2022 Usuario no-root      \u2502  \u2502 \u2022 FastAPI + SQLModel    \u2502\n\u2502 \u2022 Build optimizado     \u2502  \u2502 \u2022 Healthcheck activo    \u2502\n\u2502 \u2022 Red: public +        \u2502  \u2502 \u2022 Red: public +         \u2502\n\u2502   internal_network     \u2502  \u2502   internal_network      \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                                       \u2193\n                         \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                         \u2502    PRESTART SERVICE         \u2502\n                         \u2502  \u2022 Migraciones Alembic      \u2502\n                         \u2502  \u2022 Crear superusuario       \u2502\n                         \u2502  \u2022 Inicializaci\u00f3n DB        \u2502\n                         \u2502  \u2022 Depende de: db (healthy) \u2502\n                         \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                                       \u2193\n              \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n              \u2193                                                  \u2193\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502   POSTGRESQL SERVICE    \u2502                    \u2502   REDIS SERVICE         \u2502\n\u2502 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502                    \u2502 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502\n\u2502 \u2502  PostgreSQL 17      \u2502 \u2502                    \u2502 \u2502  Redis 7 Alpine     \u2502 \u2502\n\u2502 \u2502  Puerto: 5432       \u2502 \u2502                    \u2502 \u2502  Puerto: 6379       \u2502 \u2502\n\u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502                    \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502\n\u2502                         \u2502                    \u2502                         \u2502\n\u2502 \u2022 Volumen persistente:  \u2502                    \u2502 \u2022 Cache de sesiones     \u2502\n\u2502   featuremodels-db-data \u2502                    \u2502 \u2022 Cola de Celery        \u2502\n\u2502 \u2022 Healthcheck activo    \u2502                    \u2502 \u2022 Volumen: redis_data   \u2502\n\u2502 \u2022 Red: internal_network \u2502                    \u2502 \u2022 Red: internal_network \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                                                           \u2193\n                                              \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                                              \u2502  CELERY WORKER SERVICE  \u2502\n                                              \u2502 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502\n                                              \u2502 \u2502  Celery Worker      \u2502 \u2502\n                                              \u2502 \u2502  Tareas as\u00edncronas  \u2502 \u2502\n                                              \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502\n                                              \u2502                         \u2502\n                                              \u2502 \u2022 Depende de: Redis, DB \u2502\n                                              \u2502 \u2022 Red: internal_network \u2502\n                                              \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"root_1_architecture_DEPLOYMENT_ARCHITECTURE/#flujo-de-peticiones","title":"Flujo de Peticiones","text":""},{"location":"root_1_architecture_DEPLOYMENT_ARCHITECTURE/#1-usuario-accede-al-frontend","title":"1. Usuario accede al Frontend","text":"<pre><code>Usuario \u2192 https://dashboard.domain.com\n    \u2193\nTraefik (puerto 443, SSL/TLS)\n    \u2193\nFrontend Service (Next.js en puerto 3000)\n    \u2193\nRespuesta HTML + JavaScript\n</code></pre>"},{"location":"root_1_architecture_DEPLOYMENT_ARCHITECTURE/#2-frontend-realiza-peticiones-a-la-api","title":"2. Frontend realiza peticiones a la API","text":"<pre><code>Frontend (JavaScript) \u2192 https://api.domain.com/api/v1/...\n    \u2193\nTraefik (puerto 443, SSL/TLS)\n    \u2193\nBackend Service (Gunicorn en puerto 8000)\n    \u2193\n    \u251c\u2500\u2192 PostgreSQL (consultas de datos)\n    \u251c\u2500\u2192 Redis (cache, sesiones)\n    \u2514\u2500\u2192 Celery Worker (tareas as\u00edncronas)\n    \u2193\nRespuesta JSON\n</code></pre>"},{"location":"root_1_architecture_DEPLOYMENT_ARCHITECTURE/#detalles-de-servicios","title":"Detalles de Servicios","text":""},{"location":"root_1_architecture_DEPLOYMENT_ARCHITECTURE/#frontend-container","title":"Frontend Container","text":"<pre><code>Imagen: feature-models-frontend:latest\nBase: node:20-alpine\nProceso: node server.js (Next.js standalone)\nPuerto Interno: 3000\nRedes: public, internal_network\nVariables de Entorno:\n  - NEXT_PUBLIC_API_URL=https://api.domain.com\n  - NODE_ENV=production\n  - HOSTNAME=0.0.0.0\n  - PORT=3000\n</code></pre>"},{"location":"root_1_architecture_DEPLOYMENT_ARCHITECTURE/#backend-container","title":"Backend Container","text":"<pre><code>Imagen: feature-models-backend:latest\nBase: python:3.10+\nProceso: gunicorn app.main:app -w 4 -k uvicorn.workers.UvicornWorker\nPuerto Interno: 8000\nRedes: public, internal_network\nHealthcheck: curl http://localhost:8000/api/v1/utils/health-check/\nVariables de Entorno:\n  - POSTGRES_SERVER=db\n  - POSTGRES_PORT=5432\n  - DOMAIN, SECRET_KEY, etc.\n</code></pre>"},{"location":"root_1_architecture_DEPLOYMENT_ARCHITECTURE/#postgresql-container","title":"PostgreSQL Container","text":"<pre><code>Imagen: postgres:17\nPuerto Interno: 5432\nVolumen: featuremodels-db-data:/var/lib/postgresql/data/pgdata\nRed: internal_network\nHealthcheck: pg_isready -U $POSTGRES_USER -d $POSTGRES_DB\nVariables de Entorno:\n  - POSTGRES_USER\n  - POSTGRES_PASSWORD\n  - POSTGRES_DB\n  - PGDATA=/var/lib/postgresql/data/pgdata\n</code></pre>"},{"location":"root_1_architecture_DEPLOYMENT_ARCHITECTURE/#redis-container","title":"Redis Container","text":"<pre><code>Imagen: redis:7-alpine\nPuerto Interno: 6379\nVolumen: redis_data:/data\nRed: internal_network\n</code></pre>"},{"location":"root_1_architecture_DEPLOYMENT_ARCHITECTURE/#celery-worker-container","title":"Celery Worker Container","text":"<pre><code>Imagen: feature-models-backend:latest (misma que backend)\nProceso: celery -A app.core.celery.celery_app worker --loglevel=info\nRed: internal_network\nDepende de: db, redis\n</code></pre>"},{"location":"root_1_architecture_DEPLOYMENT_ARCHITECTURE/#redes-docker","title":"Redes Docker","text":""},{"location":"root_1_architecture_DEPLOYMENT_ARCHITECTURE/#traefik-public-externa","title":"traefik-public (Externa)","text":"<ul> <li>Compartida con Traefik</li> <li>Permite que Traefik enrute tr\u00e1fico a los servicios</li> <li>Servicios conectados: <code>frontend</code>, <code>feature_models_backend</code></li> </ul>"},{"location":"root_1_architecture_DEPLOYMENT_ARCHITECTURE/#internal_network-externa","title":"internal_network (Externa)","text":"<ul> <li>Comunicaci\u00f3n interna entre servicios</li> <li>NO expuesta a internet</li> <li>Servicios conectados: todos excepto cuando necesitan acceso p\u00fablico</li> </ul>"},{"location":"root_1_architecture_DEPLOYMENT_ARCHITECTURE/#volumenes-persistentes","title":"Vol\u00famenes Persistentes","text":""},{"location":"root_1_architecture_DEPLOYMENT_ARCHITECTURE/#featuremodels-db-data","title":"featuremodels-db-data","text":"<ul> <li>Prop\u00f3sito: Almacenar datos de PostgreSQL</li> <li>Tipo: External (creado manualmente)</li> <li>Ubicaci\u00f3n: Gestionado por Docker</li> <li>Backup: Necesario configurar backups regulares</li> </ul>"},{"location":"root_1_architecture_DEPLOYMENT_ARCHITECTURE/#redis_data","title":"redis_data","text":"<ul> <li>Prop\u00f3sito: Persistencia de Redis (opcional pero recomendado)</li> <li>Tipo: Named volume</li> <li>Ubicaci\u00f3n: Gestionado por Docker</li> </ul>"},{"location":"root_1_architecture_DEPLOYMENT_ARCHITECTURE/#seguridad","title":"Seguridad","text":""},{"location":"root_1_architecture_DEPLOYMENT_ARCHITECTURE/#niveles-de-seguridad","title":"Niveles de Seguridad","text":"<ol> <li> <p>Capa de Red</p> </li> <li> <p>Firewall del servidor: solo puertos 80, 443 abiertos</p> </li> <li>Redes Docker aisladas</li> <li> <p>Servicios internos NO expuestos directamente</p> </li> <li> <p>Capa de Aplicaci\u00f3n</p> </li> <li> <p>CORS configurado correctamente</p> </li> <li>JWT para autenticaci\u00f3n</li> <li>HTTPS obligatorio (redireccionamiento autom\u00e1tico)</li> <li> <p>Usuarios no-root en contenedores</p> </li> <li> <p>Capa de Datos</p> </li> <li>PostgreSQL accesible solo desde internal_network</li> <li>Passwords seguros en variables de entorno</li> <li>Backups regulares</li> </ol>"},{"location":"root_1_architecture_DEPLOYMENT_ARCHITECTURE/#escalabilidad","title":"Escalabilidad","text":""},{"location":"root_1_architecture_DEPLOYMENT_ARCHITECTURE/#backend","title":"Backend","text":"<ul> <li>Actualmente: 4 workers de Gunicorn</li> <li>Escalable horizontalmente: aumentar n\u00famero de workers</li> <li>O desplegar m\u00faltiples instancias con load balancer</li> </ul>"},{"location":"root_1_architecture_DEPLOYMENT_ARCHITECTURE/#frontend","title":"Frontend","text":"<ul> <li>Servidor standalone de Next.js</li> <li>Escalable horizontalmente: m\u00faltiples instancias detr\u00e1s de Traefik</li> </ul>"},{"location":"root_1_architecture_DEPLOYMENT_ARCHITECTURE/#base-de-datos","title":"Base de Datos","text":"<ul> <li>Actualmente: Single instance</li> <li>Para producci\u00f3n alta disponibilidad: PostgreSQL con r\u00e9plicas</li> <li>O usar servicio gestionado (AWS RDS, Azure Database, etc.)</li> </ul>"},{"location":"root_1_architecture_DEPLOYMENT_ARCHITECTURE/#cache","title":"Cache","text":"<ul> <li>Redis puede configurarse en cluster</li> <li>Actualmente: Single instance suficiente para cargas moderadas</li> </ul>"},{"location":"root_1_architecture_DEPLOYMENT_ARCHITECTURE/#monitoreo-y-observabilidad","title":"Monitoreo y Observabilidad","text":""},{"location":"root_1_architecture_DEPLOYMENT_ARCHITECTURE/#healthchecks-configurados","title":"Healthchecks Configurados","text":"<pre><code>Backend:\n  - Endpoint: /api/v1/utils/health-check/\n  - Intervalo: 10s\n  - Timeout: 5s\n  - Retries: 5\n\nPostgreSQL:\n  - Comando: pg_isready\n  - Intervalo: 10s\n  - Timeout: 10s\n  - Retries: 5\n</code></pre>"},{"location":"root_1_architecture_DEPLOYMENT_ARCHITECTURE/#logs","title":"Logs","text":"<ul> <li>Ubicaci\u00f3n: STDOUT/STDERR de cada contenedor</li> <li>Acceso: <code>docker-compose logs -f [servicio]</code></li> <li>Recomendaci\u00f3n: Implementar soluci\u00f3n centralizada (ELK, Loki, etc.)</li> </ul>"},{"location":"root_1_architecture_DEPLOYMENT_ARCHITECTURE/#metricas","title":"M\u00e9tricas","text":"<ul> <li>Recursos: <code>docker stats</code></li> <li>Aplicaci\u00f3n: Considerar Prometheus + Grafana</li> <li>APM: Sentry configurado (opcional)</li> </ul>"},{"location":"root_1_architecture_DEPLOYMENT_ARCHITECTURE/#proceso-de-deployment","title":"Proceso de Deployment","text":"<pre><code>1. Desarrollador hace push a Git\n2. CI/CD construye im\u00e1genes Docker\n3. Push de im\u00e1genes a registry\n4. Pull de im\u00e1genes en servidor de producci\u00f3n\n5. docker-compose up -d (zero-downtime con healthchecks)\n6. Traefik detecta nuevos servicios autom\u00e1ticamente\n7. Certificados SSL generados/renovados autom\u00e1ticamente\n</code></pre>"},{"location":"root_1_architecture_DEPLOYMENT_ARCHITECTURE/#consideraciones-de-produccion","title":"Consideraciones de Producci\u00f3n","text":""},{"location":"root_1_architecture_DEPLOYMENT_ARCHITECTURE/#critico","title":"Cr\u00edtico","text":"<ul> <li>\u2705 Backups autom\u00e1ticos de base de datos</li> <li>\u2705 Monitoreo de recursos del servidor</li> <li>\u2705 Alertas de errores (Sentry, etc.)</li> <li>\u2705 Certificados SSL renovados autom\u00e1ticamente</li> <li>\u2705 Logs centralizados</li> </ul>"},{"location":"root_1_architecture_DEPLOYMENT_ARCHITECTURE/#recomendado","title":"Recomendado","text":"<ul> <li>\ud83d\udd04 Implementar CI/CD completo</li> <li>\ud83d\udd04 Monitoreo de aplicaci\u00f3n (APM)</li> <li>\ud83d\udd04 Testing autom\u00e1tico</li> <li>\ud83d\udd04 Blue-green deployment</li> <li>\ud83d\udd04 Disaster recovery plan</li> </ul>"},{"location":"root_1_architecture_DEPLOYMENT_ARCHITECTURE/#opcional-pero-util","title":"Opcional pero \u00datil","text":"<ul> <li>\u2699\ufe0f Auto-scaling basado en carga</li> <li>\u2699\ufe0f CDN para assets est\u00e1ticos</li> <li>\u2699\ufe0f Rate limiting</li> <li>\u2699\ufe0f Web Application Firewall (WAF)</li> </ul> <p>Nota: Esta arquitectura est\u00e1 optimizada para cargas peque\u00f1as a medianas. Para aplicaciones de alta escala, considera usar Kubernetes, servicios gestionados en la nube, o arquitecturas de microservicios.</p>"},{"location":"root_1_architecture_DESIGN_PATTERNS_IMPLEMENTED/","title":"\ud83c\udfa8 Patrones de Dise\u00f1o Implementados en el Backend","text":"<p>Fecha de an\u00e1lisis: 9 de diciembre de 2025 Proyecto: Feature Models Platform - Backend Evaluador: An\u00e1lisis de patrones de dise\u00f1o</p>"},{"location":"root_1_architecture_DESIGN_PATTERNS_IMPLEMENTED/#resumen-ejecutivo","title":"\ud83d\udccb Resumen Ejecutivo","text":"<p>Este documento identifica y documenta los 13 patrones de dise\u00f1o que est\u00e1n actualmente implementados en el backend del proyecto Feature Models Platform. El an\u00e1lisis revela una arquitectura s\u00f3lida basada en principios SOLID y patrones modernos de desarrollo.</p> <p>Estado general: \u2705 Excelente - 10 patrones completos, 3 parciales</p>"},{"location":"root_1_architecture_DESIGN_PATTERNS_IMPLEMENTED/#patrones-de-diseno-implementados","title":"\ud83c\udfaf Patrones de Dise\u00f1o Implementados","text":""},{"location":"root_1_architecture_DESIGN_PATTERNS_IMPLEMENTED/#1-repository-pattern-completo","title":"\u2705 1. Repository Pattern (COMPLETO)","text":"<p>Categor\u00eda: Architectural Pattern Ubicaci\u00f3n: <code>backend/app/repositories/</code>, <code>backend/app/interfaces/</code></p>"},{"location":"root_1_architecture_DESIGN_PATTERNS_IMPLEMENTED/#descripcion","title":"Descripci\u00f3n","text":"<p>El patr\u00f3n Repository abstrae la l\u00f3gica de acceso a datos, proporcionando una interfaz uniforme para operaciones CRUD independiente del mecanismo de persistencia subyacente.</p>"},{"location":"root_1_architecture_DESIGN_PATTERNS_IMPLEMENTED/#implementacion","title":"Implementaci\u00f3n","text":"<pre><code># Interfaz (Contrato)\n# backend/app/interfaces/a_sync/domain.py\nclass IDomainRepositoryAsync(Protocol):\n    \"\"\"Protocolo que define el contrato para repositorios de dominios.\"\"\"\n\n    async def create(self, data: DomainCreate) -&gt; Domain: ...\n    async def get(self, domain_id: UUID) -&gt; Optional[Domain]: ...\n    async def get_all(self, skip: int, limit: int) -&gt; List[Domain]: ...\n    async def update(self, domain_id: UUID, data: DomainUpdate) -&gt; Domain: ...\n    async def delete(self, domain_id: UUID) -&gt; None: ...\n\n# Implementaci\u00f3n Concreta\n# backend/app/repositories/a_sync/domain.py\nclass DomainRepositoryAsync(BaseDomainRepository, IDomainRepositoryAsync):\n    \"\"\"Implementaci\u00f3n as\u00edncrona del repositorio de dominios.\"\"\"\n\n    def __init__(self, session: AsyncSession):\n        self.session = session\n\n    async def create(self, data: DomainCreate) -&gt; Domain:\n        db_obj = Domain.model_validate(data)\n        self.session.add(db_obj)\n        await self.session.commit()\n        await self.session.refresh(db_obj)\n        return db_obj\n\n    async def get(self, domain_id: UUID) -&gt; Optional[Domain]:\n        stmt = select(Domain).where(Domain.id == domain_id)\n        result = await self.session.execute(stmt)\n        return result.scalar_one_or_none()\n</code></pre>"},{"location":"root_1_architecture_DESIGN_PATTERNS_IMPLEMENTED/#beneficios-obtenidos","title":"Beneficios Obtenidos","text":"<ul> <li>\u2705 Abstracci\u00f3n de persistencia: El c\u00f3digo de negocio no conoce SQLAlchemy</li> <li>\u2705 Testability: F\u00e1cil crear mocks/stubs de repositorios</li> <li>\u2705 M\u00faltiples implementaciones: Sync y async sin cambiar consumidores</li> <li>\u2705 Centralizaci\u00f3n: Queries complejos en un solo lugar</li> </ul>"},{"location":"root_1_architecture_DESIGN_PATTERNS_IMPLEMENTED/#variantes-implementadas","title":"Variantes Implementadas","text":"<pre><code>repositories/\n\u251c\u2500\u2500 a_sync/          # Implementaciones as\u00edncronas\n\u2502   \u251c\u2500\u2500 domain.py\n\u2502   \u251c\u2500\u2500 feature.py\n\u2502   \u2514\u2500\u2500 feature_model.py\n\u251c\u2500\u2500 sync/            # Implementaciones s\u00edncronas\n\u2502   \u251c\u2500\u2500 domain.py\n\u2502   \u2514\u2500\u2500 feature_model.py\n\u2514\u2500\u2500 base.py          # Clases base compartidas\n</code></pre>"},{"location":"root_1_architecture_DESIGN_PATTERNS_IMPLEMENTED/#2-dependency-injection-di-completo","title":"\u2705 2. Dependency Injection (DI) (COMPLETO)","text":"<p>Categor\u00eda: Architectural Pattern Ubicaci\u00f3n: <code>backend/app/api/deps.py</code>, endpoints</p>"},{"location":"root_1_architecture_DESIGN_PATTERNS_IMPLEMENTED/#descripcion_1","title":"Descripci\u00f3n","text":"<p>Inversi\u00f3n de control donde las dependencias se inyectan en lugar de ser creadas internamente, promoviendo bajo acoplamiento y alta cohesi\u00f3n.</p>"},{"location":"root_1_architecture_DESIGN_PATTERNS_IMPLEMENTED/#implementacion_1","title":"Implementaci\u00f3n","text":"<pre><code># backend/app/api/deps.py\n\n# Definici\u00f3n de f\u00e1bricas de dependencias\nasync def aget_domain_repo(session: AsyncSessionDep):\n    \"\"\"Factory que inyecta el repositorio de dominios.\"\"\"\n    return DomainRepositoryAsync(session)\n\n# Type alias para uso en endpoints\nAsyncDomainRepoDep = Annotated[DomainRepositoryAsync, Depends(aget_domain_repo)]\n\n# Uso en endpoints\n# backend/app/api/v1/endpoints/domain.py\n@router.get(\"/domains/\")\nasync def read_domains(\n    domain_repo: AsyncDomainRepoDep,  # \u2b05\ufe0f Inyecci\u00f3n autom\u00e1tica\n    skip: int = 0,\n    limit: int = 100,\n) -&gt; DomainListResponse:\n    domains = await domain_repo.get_all(skip=skip, limit=limit)\n    total = await domain_repo.count()\n    return DomainListResponse(data=domains, total=total)\n</code></pre>"},{"location":"root_1_architecture_DESIGN_PATTERNS_IMPLEMENTED/#beneficios-obtenidos_1","title":"Beneficios Obtenidos","text":"<ul> <li>\u2705 Bajo acoplamiento: Endpoints no instancian repositorios directamente</li> <li>\u2705 Testability: F\u00e1cil sustituir dependencias reales por mocks</li> <li>\u2705 Configuraci\u00f3n flexible: Cambiar implementaciones sin tocar c\u00f3digo</li> <li>\u2705 Gesti\u00f3n autom\u00e1tica de recursos: FastAPI maneja ciclo de vida</li> </ul>"},{"location":"root_1_architecture_DESIGN_PATTERNS_IMPLEMENTED/#ejemplo-de-testing","title":"Ejemplo de Testing","text":"<pre><code># backend/app/tests/api/routes/test_domains.py\n\ndef test_create_domain(client: TestClient, superuser_token_headers: dict):\n    \"\"\"El repositorio se inyecta autom\u00e1ticamente en testing.\"\"\"\n    data = {\"name\": \"Test Domain\", \"description\": \"Test\"}\n    response = client.post(\n        \"/api/v1/domains/\",\n        headers=superuser_token_headers,\n        json=data,\n    )\n    assert response.status_code == 200\n</code></pre>"},{"location":"root_1_architecture_DESIGN_PATTERNS_IMPLEMENTED/#3-singleton-pattern-implicito","title":"\u2705 3. Singleton Pattern (IMPL\u00cdCITO)","text":"<p>Categor\u00eda: Creational Pattern Ubicaci\u00f3n: <code>backend/app/core/config.py</code>, <code>backend/app/core/db.py</code></p>"},{"location":"root_1_architecture_DESIGN_PATTERNS_IMPLEMENTED/#descripcion_2","title":"Descripci\u00f3n","text":"<p>Garantiza que una clase tenga una \u00fanica instancia y proporciona un punto de acceso global a ella.</p>"},{"location":"root_1_architecture_DESIGN_PATTERNS_IMPLEMENTED/#implementacion_2","title":"Implementaci\u00f3n","text":"<pre><code># backend/app/core/config.py\nclass Settings(BaseSettings):\n    \"\"\"Configuraci\u00f3n global de la aplicaci\u00f3n (Singleton por dise\u00f1o).\"\"\"\n\n    ENVIRONMENT: Literal[\"local\", \"staging\", \"production\"] = \"local\"\n    POSTGRES_SERVER: str\n    POSTGRES_PORT: int = 5432\n\n    # ... m\u00e1s configuraci\u00f3n\n\n    model_config = SettingsConfigDict(\n        env_file=\".env\",\n        env_ignore_empty=True,\n        extra=\"ignore\",\n    )\n\n# Instancia \u00fanica global\nsettings = Settings()  # \u2b05\ufe0f Singleton\n</code></pre> <pre><code># backend/app/core/db.py\n\n# Motor de base de datos (Singleton)\nengine = create_async_engine(\n    str(settings.SQLALCHEMY_DATABASE_URI),\n    echo=True,\n    future=True,\n)\n\n# SessionMaker (Singleton)\nasync_session_maker = sessionmaker(\n    engine,\n    class_=AsyncSession,\n    expire_on_commit=False,\n)\n</code></pre>"},{"location":"root_1_architecture_DESIGN_PATTERNS_IMPLEMENTED/#beneficios-obtenidos_2","title":"Beneficios Obtenidos","text":"<ul> <li>\u2705 \u00danica fuente de verdad: Configuraci\u00f3n centralizada</li> <li>\u2705 Gesti\u00f3n eficiente de recursos: Una sola conexi\u00f3n pool de DB</li> <li>\u2705 Acceso global: Settings disponible en todo el c\u00f3digo</li> <li>\u2705 Thread-safe: Pydantic garantiza seguridad</li> </ul>"},{"location":"root_1_architecture_DESIGN_PATTERNS_IMPLEMENTED/#4-factory-method-pattern-parcial","title":"\u2705 4. Factory Method Pattern (PARCIAL)","text":"<p>Categor\u00eda: Creational Pattern Ubicaci\u00f3n: <code>backend/app/api/deps.py</code></p>"},{"location":"root_1_architecture_DESIGN_PATTERNS_IMPLEMENTED/#descripcion_3","title":"Descripci\u00f3n","text":"<p>Define una interfaz para crear objetos, pero deja que las subclases decidan qu\u00e9 clase instanciar.</p>"},{"location":"root_1_architecture_DESIGN_PATTERNS_IMPLEMENTED/#implementacion_3","title":"Implementaci\u00f3n","text":"<pre><code># backend/app/api/deps.py\n\n# Factory methods para crear repositorios\nasync def aget_domain_repo(session: AsyncSessionDep):\n    \"\"\"Factory Method para DomainRepository.\"\"\"\n    return DomainRepositoryAsync(session)\n\nasync def aget_feature_repo(session: AsyncSessionDep):\n    \"\"\"Factory Method para FeatureRepository.\"\"\"\n    return FeatureRepositoryAsync(session)\n\nasync def aget_feature_model_repo(session: AsyncSessionDep):\n    \"\"\"Factory Method para FeatureModelRepository.\"\"\"\n    return FeatureModelRepositoryAsync(session)\n\n# Uso\n@router.post(\"/domains/\")\nasync def create_domain(\n    domain_in: DomainCreate,\n    domain_repo: AsyncDomainRepoDep,  # \u2b05\ufe0f Creado por factory\n):\n    return await domain_repo.create(domain_in)\n</code></pre>"},{"location":"root_1_architecture_DESIGN_PATTERNS_IMPLEMENTED/#limitaciones-actuales","title":"Limitaciones Actuales","text":"<p>\u26a0\ufe0f No es un Abstract Factory completo - No hay jerarqu\u00eda de factories para crear familias de objetos relacionados.</p> <p>Mejora sugerida (ver documento SPL_TECHNIQUES_ANALYSIS.md):</p> <pre><code># Propuesta: backend/app/factories/repository_factory.py\nclass RepositoryFactory(ABC):\n    @abstractmethod\n    def create_domain_repo(self): ...\n    @abstractmethod\n    def create_feature_repo(self): ...\n\nclass AsyncRepositoryFactory(RepositoryFactory):\n    def create_domain_repo(self):\n        return DomainRepositoryAsync(self.session)\n</code></pre>"},{"location":"root_1_architecture_DESIGN_PATTERNS_IMPLEMENTED/#5-builder-pattern-implicito-en-pydantic","title":"\u2705 5. Builder Pattern (IMPL\u00cdCITO en Pydantic)","text":"<p>Categor\u00eda: Creational Pattern Ubicaci\u00f3n: <code>backend/app/models</code></p>"},{"location":"root_1_architecture_DESIGN_PATTERNS_IMPLEMENTED/#descripcion_4","title":"Descripci\u00f3n","text":"<p>Separa la construcci\u00f3n de un objeto complejo de su representaci\u00f3n, permitiendo el mismo proceso de construcci\u00f3n crear diferentes representaciones.</p>"},{"location":"root_1_architecture_DESIGN_PATTERNS_IMPLEMENTED/#implementacion_4","title":"Implementaci\u00f3n","text":"<pre><code># backend/app/models/domain.py\n\nclass DomainCreate(BaseModel):\n    \"\"\"Builder impl\u00edcito para crear dominios.\"\"\"\n\n    name: str = Field(max_length=255, min_length=1)\n    description: Optional[str] = Field(default=None, max_length=1000)\n\n    # Validaciones en construcci\u00f3n\n    @field_validator(\"name\")\n    @classmethod\n    def name_must_not_be_empty(cls, v: str) -&gt; str:\n        if not v.strip():\n            raise ValueError(\"El nombre no puede estar vac\u00edo\")\n        return v\n\n# Construcci\u00f3n fluida y validada\ndomain = DomainCreate(\n    name=\"Ingenier\u00eda de Software\",\n    description=\"Dominio relacionado con ingenier\u00eda de software\"\n)\n\n# Pydantic valida autom\u00e1ticamente:\n# - Tipos correctos\n# - Longitudes\n# - Valores no nulos\n# - Reglas personalizadas\n</code></pre>"},{"location":"root_1_architecture_DESIGN_PATTERNS_IMPLEMENTED/#beneficios-obtenidos_3","title":"Beneficios Obtenidos","text":"<ul> <li>\u2705 Validaci\u00f3n en construcci\u00f3n: Objetos siempre v\u00e1lidos</li> <li>\u2705 Valores por defecto: Configuraci\u00f3n simplificada</li> <li>\u2705 Inmutabilidad opcional: Con <code>frozen=True</code></li> <li>\u2705 Documentaci\u00f3n autom\u00e1tica: OpenAPI schemas</li> </ul>"},{"location":"root_1_architecture_DESIGN_PATTERNS_IMPLEMENTED/#6-proxy-pattern-en-middleware","title":"\u2705 6. Proxy Pattern (en Middleware)","text":"<p>Categor\u00eda: Structural Pattern Ubicaci\u00f3n: <code>backend/app/middlewares.py</code></p>"},{"location":"root_1_architecture_DESIGN_PATTERNS_IMPLEMENTED/#descripcion_5","title":"Descripci\u00f3n","text":"<p>Proporciona un sustituto o intermediario que controla el acceso a otro objeto.</p>"},{"location":"root_1_architecture_DESIGN_PATTERNS_IMPLEMENTED/#implementacion_5","title":"Implementaci\u00f3n","text":"<pre><code># backend/app/middlewares.py\n\nasync def protect_internal_docs_middleware(request: Request, call_next):\n    \"\"\"\n    Proxy que intercepta peticiones a /docs y /redoc.\n\n    En desarrollo: acceso libre\n    En producci\u00f3n: requiere autenticaci\u00f3n\n    \"\"\"\n    if request.url.path in [\"/docs\", \"/redoc\"]:\n        # En desarrollo: pasar directo (proxy transparente)\n        if settings.ENVIRONMENT in (\"development\", \"local\"):\n            return await call_next(request)\n\n        # En producci\u00f3n: validar autenticaci\u00f3n (proxy protector)\n        token = request.headers.get(\"Authorization\")\n        if not token or not is_valid_admin_token(token):\n            return JSONResponse(\n                status_code=status.HTTP_403_FORBIDDEN,\n                content={\"detail\": \"Documentation access restricted\"}\n            )\n\n    return await call_next(request)\n\n\nasync def invalidate_cache_on_write_middleware(request: Request, call_next):\n    \"\"\"\n    Proxy que gestiona cach\u00e9 autom\u00e1ticamente.\n\n    Intercepta respuestas y invalida cach\u00e9 si hay escritura.\n    \"\"\"\n    response = await call_next(request)\n\n    # Proxy activo: invalidar cach\u00e9 despu\u00e9s de escritura\n    if request.method in [\"POST\", \"PUT\", \"PATCH\", \"DELETE\"]:\n        from fastapi_cache import FastAPICache\n        await FastAPICache.clear()\n\n    return response\n</code></pre>"},{"location":"root_1_architecture_DESIGN_PATTERNS_IMPLEMENTED/#beneficios-obtenidos_4","title":"Beneficios Obtenidos","text":"<ul> <li>\u2705 Control de acceso transparente: Sin modificar endpoints</li> <li>\u2705 Gesti\u00f3n de cach\u00e9 autom\u00e1tica: DRY principle</li> <li>\u2705 Separaci\u00f3n de concerns: L\u00f3gica transversal aislada</li> <li>\u2705 Configuraci\u00f3n por entorno: Comportamiento din\u00e1mico</li> </ul>"},{"location":"root_1_architecture_DESIGN_PATTERNS_IMPLEMENTED/#7-decorator-pattern-extensivo","title":"\u2705 7. Decorator Pattern (EXTENSIVO)","text":"<p>Categor\u00eda: Structural Pattern Ubicaci\u00f3n: Endpoints, validaciones, cach\u00e9</p>"},{"location":"root_1_architecture_DESIGN_PATTERNS_IMPLEMENTED/#descripcion_6","title":"Descripci\u00f3n","text":"<p>Adjunta responsabilidades adicionales a un objeto din\u00e1micamente, proporcionando una alternativa flexible a la herencia para extender funcionalidad.</p>"},{"location":"root_1_architecture_DESIGN_PATTERNS_IMPLEMENTED/#implementacion_6","title":"Implementaci\u00f3n","text":"<pre><code># backend/app/api/v1/endpoints/domain.py\n\n# M\u00faltiples decoradores componiendo comportamiento\n@router.get(\"/domains/{domain_id}/\")\n@cache(expire=300)  # \u2b05\ufe0f Decorator: a\u00f1ade cach\u00e9\nasync def read_domain(\n    domain_id: UUID,\n    domain_repo: AsyncDomainRepoDep,  # \u2b05\ufe0f Decorator: inyecta dependencia\n    current_user: CurrentUser = Depends(get_current_user),  # \u2b05\ufe0f Decorator: autenticaci\u00f3n\n) -&gt; DomainPublic:\n    \"\"\"\n    Composici\u00f3n de decoradores:\n    1. FastAPI router decorator (@router.get)\n    2. Cache decorator (@cache)\n    3. Dependency injection (Depends)\n    4. Authentication (get_current_user)\n    \"\"\"\n    domain = await domain_repo.get(domain_id)\n    if not domain:\n        raise HTTPException(status_code=404, detail=\"Domain not found\")\n    return domain\n\n\n# Decorador personalizado de autorizaci\u00f3n\n# backend/app/api/deps.py\ndef get_current_active_superuser(current_user: CurrentUser) -&gt; User:\n    \"\"\"\n    Decorator que a\u00f1ade validaci\u00f3n de rol de superusuario.\n    \"\"\"\n    if not current_user.is_superuser:\n        raise HTTPException(\n            status_code=403,\n            detail=\"The user doesn't have enough privileges\"\n        )\n    return current_user\n\n# Uso: composici\u00f3n de decoradores\n@router.post(\"/domains/\")\nasync def create_domain(\n    domain_in: DomainCreate,\n    current_user: CurrentUser = Depends(get_current_active_superuser),  # \u2b05\ufe0f Auth + Authorization\n    domain_repo: AsyncDomainRepoDep,\n):\n    return await domain_repo.create(domain_in)\n</code></pre>"},{"location":"root_1_architecture_DESIGN_PATTERNS_IMPLEMENTED/#decoradores-personalizados-implementados","title":"Decoradores Personalizados Implementados","text":"<pre><code># backend/app/api/deps.py\n\nCurrentUser = Annotated[User, Depends(get_current_user)]\nCurrentActiveUser = Annotated[User, Depends(get_current_active_user)]\nCurrentSuperuser = Annotated[User, Depends(get_current_active_superuser)]\n\nAsyncSessionDep = Annotated[AsyncSession, Depends(get_async_session)]\nSessionDep = Annotated[Session, Depends(get_session)]\n\nAsyncDomainRepoDep = Annotated[DomainRepositoryAsync, Depends(aget_domain_repo)]\nAsyncFeatureRepoDep = Annotated[FeatureRepositoryAsync, Depends(aget_feature_repo)]\n</code></pre>"},{"location":"root_1_architecture_DESIGN_PATTERNS_IMPLEMENTED/#beneficios-obtenidos_5","title":"Beneficios Obtenidos","text":"<ul> <li>\u2705 Composici\u00f3n flexible: auth + cache + validaci\u00f3n</li> <li>\u2705 Reutilizaci\u00f3n: Decoradores compartidos</li> <li>\u2705 Legibilidad: Intent claro en firmas</li> <li>\u2705 Testability: Cada decorador se prueba aislado</li> </ul>"},{"location":"root_1_architecture_DESIGN_PATTERNS_IMPLEMENTED/#8-strategy-pattern-limitado","title":"\u2705 8. Strategy Pattern (LIMITADO)","text":"<p>Categor\u00eda: Behavioral Pattern Ubicaci\u00f3n: <code>backend/app/feature_flags.py</code>, repositorios sync/async</p>"},{"location":"root_1_architecture_DESIGN_PATTERNS_IMPLEMENTED/#descripcion_7","title":"Descripci\u00f3n","text":"<p>Define una familia de algoritmos, encapsula cada uno y los hace intercambiables.</p>"},{"location":"root_1_architecture_DESIGN_PATTERNS_IMPLEMENTED/#implementacion_7","title":"Implementaci\u00f3n","text":"<pre><code># Estrategia 1: Repositorios As\u00edncronos\n# backend/app/repositories/a_sync/domain.py\nclass DomainRepositoryAsync:\n    \"\"\"Estrategia async para persistencia.\"\"\"\n\n    async def create(self, data: DomainCreate) -&gt; Domain:\n        # Implementaci\u00f3n con async/await\n        db_obj = Domain.model_validate(data)\n        self.session.add(db_obj)\n        await self.session.commit()\n        return db_obj\n\n\n# Estrategia 2: Repositorios S\u00edncronos\n# backend/app/repositories/sync/domain.py\nclass DomainRepositorySync:\n    \"\"\"Estrategia sync para persistencia.\"\"\"\n\n    def create(self, data: DomainCreate) -&gt; Domain:\n        # Implementaci\u00f3n s\u00edncrona tradicional\n        db_obj = Domain.model_validate(data)\n        self.session.add(db_obj)\n        self.session.commit()\n        return db_obj\n\n\n# Selecci\u00f3n de estrategia en runtime\n# backend/app/api/deps.py\nasync def aget_domain_repo(session: AsyncSessionDep):\n    \"\"\"Usa estrategia async.\"\"\"\n    return DomainRepositoryAsync(session)\n\ndef get_domain_repo(session: SessionDep):\n    \"\"\"Usa estrategia sync.\"\"\"\n    return DomainRepositorySync(session)\n</code></pre>"},{"location":"root_1_architecture_DESIGN_PATTERNS_IMPLEMENTED/#feature-flags-strategy-basico","title":"Feature Flags (Strategy B\u00e1sico)","text":"<pre><code># backend/app/feature_flags.py\n\nFEATURE_FLAGS = {\n    \"use_phone_number\": False,\n    \"enable_advanced_search\": True,\n}\n\ndef is_enabled(flag_name: str) -&gt; bool:\n    \"\"\"Estrategia de decisi\u00f3n de features.\"\"\"\n    return FEATURE_FLAGS.get(flag_name, False)\n\n# Uso: estrategias alternativas seg\u00fan flag\nif is_enabled(\"use_phone_number\"):\n    # Estrategia A: validar con tel\u00e9fono\n    validate_with_phone(user)\nelse:\n    # Estrategia B: validar solo email\n    validate_with_email(user)\n</code></pre>"},{"location":"root_1_architecture_DESIGN_PATTERNS_IMPLEMENTED/#limitaciones-actuales_1","title":"Limitaciones Actuales","text":"<p>\u26a0\ufe0f Implementaci\u00f3n b\u00e1sica - No hay jerarqu\u00eda formal de estrategias intercambiables.</p> <p>Mejora sugerida:</p> <pre><code># Propuesta: backend/app/strategies/validation.py\nclass ConstraintValidatorStrategy(ABC):\n    @abstractmethod\n    def validate(self, config: Configuration) -&gt; ValidationResult:\n        pass\n\nclass SATValidatorStrategy(ConstraintValidatorStrategy):\n    def validate(self, config):\n        # Validaci\u00f3n con SAT solver\n        pass\n\nclass RuleBasedValidatorStrategy(ConstraintValidatorStrategy):\n    def validate(self, config):\n        # Validaci\u00f3n con reglas simples\n        pass\n</code></pre>"},{"location":"root_1_architecture_DESIGN_PATTERNS_IMPLEMENTED/#9-template-method-pattern-implicito","title":"\u2705 9. Template Method Pattern (IMPL\u00cdCITO)","text":"<p>Categor\u00eda: Behavioral Pattern Ubicaci\u00f3n: <code>backend/app/repositories/base.py</code></p>"},{"location":"root_1_architecture_DESIGN_PATTERNS_IMPLEMENTED/#descripcion_8","title":"Descripci\u00f3n","text":"<p>Define el esqueleto de un algoritmo en una operaci\u00f3n, delegando algunos pasos a las subclases.</p>"},{"location":"root_1_architecture_DESIGN_PATTERNS_IMPLEMENTED/#implementacion_8","title":"Implementaci\u00f3n","text":"<pre><code># backend/app/repositories/base.py\n\nclass BaseDomainRepository:\n    \"\"\"\n    Clase base con algoritmo template.\n    Define pasos comunes que subclases pueden reutilizar.\n    \"\"\"\n\n    def validate_name_unique(self, existing_domain: Optional[Domain]):\n        \"\"\"\n        Paso com\u00fan del algoritmo de creaci\u00f3n.\n        Template method: validaci\u00f3n compartida.\n        \"\"\"\n        if existing_domain:\n            raise ValueError(\n                f\"Ya existe un dominio con el nombre: {existing_domain.name}\"\n            )\n\n    def validate_permissions(self, user: User, action: str):\n        \"\"\"Template method: validaci\u00f3n de permisos.\"\"\"\n        if not user.is_superuser and action in [\"create\", \"update\", \"delete\"]:\n            raise PermissionError(\"Insufficient permissions\")\n\n\n# Subclase implementa pasos espec\u00edficos\n# backend/app/repositories/a_sync/domain.py\nclass DomainRepositoryAsync(BaseDomainRepository):\n    \"\"\"Implementaci\u00f3n as\u00edncrona que reutiliza template methods.\"\"\"\n\n    async def create(self, data: DomainCreate) -&gt; Domain:\n        # 1. Validar (template method de clase base)\n        existing = await self.get_by_name(data.name)\n        self.validate_name_unique(existing)  # \u2b05\ufe0f Template method\n\n        # 2. Crear (espec\u00edfico de implementaci\u00f3n async)\n        db_obj = Domain.model_validate(data)\n        self.session.add(db_obj)\n        await self.session.commit()\n        await self.session.refresh(db_obj)\n\n        return db_obj\n</code></pre>"},{"location":"root_1_architecture_DESIGN_PATTERNS_IMPLEMENTED/#beneficios-obtenidos_6","title":"Beneficios Obtenidos","text":"<ul> <li>\u2705 Reutilizaci\u00f3n de l\u00f3gica com\u00fan: DRY principle</li> <li>\u2705 Extensibilidad controlada: Subclases solo cambian pasos necesarios</li> <li>\u2705 Mantenibilidad: Cambios en template afectan todas las subclases</li> </ul>"},{"location":"root_1_architecture_DESIGN_PATTERNS_IMPLEMENTED/#10-observer-pattern-limitado-en-middleware","title":"\u2705 10. Observer Pattern (LIMITADO en Middleware)","text":"<p>Categor\u00eda: Behavioral Pattern Ubicaci\u00f3n: <code>backend/app/middlewares.py</code></p>"},{"location":"root_1_architecture_DESIGN_PATTERNS_IMPLEMENTED/#descripcion_9","title":"Descripci\u00f3n","text":"<p>Define una dependencia uno-a-muchos entre objetos, de manera que cuando un objeto cambia su estado, todos sus dependientes son notificados.</p>"},{"location":"root_1_architecture_DESIGN_PATTERNS_IMPLEMENTED/#implementacion_9","title":"Implementaci\u00f3n","text":"<pre><code># backend/app/middlewares.py\n\nasync def invalidate_cache_on_write_middleware(request: Request, call_next):\n    \"\"\"\n    Observer que escucha eventos de escritura (POST/PUT/PATCH/DELETE)\n    y notifica al sistema de cach\u00e9 para invalidaci\u00f3n.\n\n    Subject: Request\n    Observer: Cache System\n    \"\"\"\n    response = await call_next(request)\n\n    # Observar evento de escritura\n    if request.method in [\"POST\", \"PUT\", \"PATCH\", \"DELETE\"]:\n        # Notificar a observers (invalidar cach\u00e9)\n        from fastapi_cache import FastAPICache\n        await FastAPICache.clear()\n\n        # Podr\u00eda notificar a m\u00faltiples observers:\n        # - Cache\n        # - Analytics\n        # - Audit log\n        # - Webhooks\n\n    return response\n</code></pre>"},{"location":"root_1_architecture_DESIGN_PATTERNS_IMPLEMENTED/#limitaciones-actuales_2","title":"Limitaciones Actuales","text":"<p>\u26a0\ufe0f Implementaci\u00f3n b\u00e1sica - No hay sistema formal de eventos/listeners.</p> <p>Mejora sugerida:</p> <pre><code># Propuesta: backend/app/events/event_bus.py\nclass EventBus:\n    def __init__(self):\n        self.listeners = defaultdict(list)\n\n    def subscribe(self, event_type: str, listener: Callable):\n        self.listeners[event_type].append(listener)\n\n    async def publish(self, event_type: str, data: dict):\n        for listener in self.listeners[event_type]:\n            await listener(data)\n\n# Uso\nevent_bus.subscribe(\"domain.created\", send_analytics)\nevent_bus.subscribe(\"domain.created\", invalidate_cache)\nevent_bus.subscribe(\"domain.created\", log_audit)\n\nawait event_bus.publish(\"domain.created\", {\"domain_id\": domain.id})\n</code></pre>"},{"location":"root_1_architecture_DESIGN_PATTERNS_IMPLEMENTED/#11-adapter-pattern-implicito","title":"\u2705 11. Adapter Pattern (IMPL\u00cdCITO)","text":"<p>Categor\u00eda: Structural Pattern Ubicaci\u00f3n: Integraci\u00f3n con servicios externos (S3, Redis, Sentry)</p>"},{"location":"root_1_architecture_DESIGN_PATTERNS_IMPLEMENTED/#descripcion_10","title":"Descripci\u00f3n","text":"<p>Convierte la interfaz de una clase en otra interfaz que los clientes esperan, permitiendo que clases con interfaces incompatibles trabajen juntas.</p>"},{"location":"root_1_architecture_DESIGN_PATTERNS_IMPLEMENTED/#implementacion_10","title":"Implementaci\u00f3n","text":"<pre><code># backend/app/core/config.py\n\nclass Settings(BaseSettings):\n    \"\"\"Adaptador para servicios externos.\"\"\"\n\n    S3_ENDPOINT: str\n    S3_ACCESS_KEY: str\n    S3_SECRET_KEY: str\n    S3_BUCKET_NAME: str\n\n    def get_s3_client(self):\n        \"\"\"\n        Adapta configuraci\u00f3n interna a cliente S3 de boto3.\n        Oculta detalles de implementaci\u00f3n de boto3.\n        \"\"\"\n        import boto3\n\n        return boto3.client(\n            's3',\n            endpoint_url=self.S3_ENDPOINT,\n            aws_access_key_id=self.S3_ACCESS_KEY,\n            aws_secret_access_key=self.S3_SECRET_KEY,\n            region_name=self.S3_REGION,\n        )\n\n\n# backend/app/main.py - Adaptador para FastAPI Cache\nfrom fastapi_cache import FastAPICache\nfrom fastapi_cache.backends.redis import RedisBackend\n\n# Adapta Redis para FastAPI Cache\n@asynccontextmanager\nasync def lifespan(app: FastAPI):\n    redis_client = redis.asyncio.from_url(\n        f\"redis://{settings.REDIS_HOST}:{settings.REDIS_PORT}\",\n        encoding=\"utf8\",\n        decode_responses=True\n    )\n\n    # Adapter: convierte redis client a backend de FastAPI Cache\n    FastAPICache.init(\n        RedisBackend(redis_client),\n        prefix=\"fastapi-cache\"\n    )\n\n    yield\n</code></pre>"},{"location":"root_1_architecture_DESIGN_PATTERNS_IMPLEMENTED/#beneficios-obtenidos_7","title":"Beneficios Obtenidos","text":"<ul> <li>\u2705 Abstracci\u00f3n de bibliotecas externas: F\u00e1cil cambiar de S3 a otro storage</li> <li>\u2705 Interfaces consistentes: API interna simplificada</li> <li>\u2705 Testability: Mockear servicios externos f\u00e1cilmente</li> </ul>"},{"location":"root_1_architecture_DESIGN_PATTERNS_IMPLEMENTED/#12-chain-of-responsibility-en-middleware","title":"\u2705 12. Chain of Responsibility (EN MIDDLEWARE)","text":"<p>Categor\u00eda: Behavioral Pattern Ubicaci\u00f3n: <code>backend/app/main.py</code></p>"},{"location":"root_1_architecture_DESIGN_PATTERNS_IMPLEMENTED/#descripcion_11","title":"Descripci\u00f3n","text":"<p>Evita acoplar el emisor de una petici\u00f3n a su receptor, dando a m\u00e1s de un objeto la posibilidad de responder a la petici\u00f3n.</p>"},{"location":"root_1_architecture_DESIGN_PATTERNS_IMPLEMENTED/#implementacion_11","title":"Implementaci\u00f3n","text":"<pre><code># backend/app/main.py\n\n# Cadena de middlewares procesando requests\napp.add_middleware(\n    CORSMiddleware,  # \u2b05\ufe0f Handler 1: CORS\n    allow_origins=origins,\n    allow_credentials=True,\n    allow_methods=[\"*\"],\n    allow_headers=[\"*\"],\n)\n\n# Handler 2: Protecci\u00f3n de documentaci\u00f3n\napp.middleware(\"http\")(protect_internal_docs_middleware)\n\n# Handler 3: Invalidaci\u00f3n de cach\u00e9\napp.middleware(\"http\")(invalidate_cache_on_write_middleware)\n\n# Flujo de una request:\n# Request \u2192 CORSMiddleware \u2192 ProtectDocs \u2192 InvalidateCache \u2192 Endpoint \u2192 Response\n#\n# Cada handler puede:\n# - Pasar al siguiente (call_next)\n# - Detener la cadena (return response)\n# - Modificar request/response\n</code></pre> <pre><code># backend/app/middlewares.py\n\nasync def protect_internal_docs_middleware(request: Request, call_next):\n    \"\"\"Handler en la cadena.\"\"\"\n    if request.url.path in [\"/docs\", \"/redoc\"]:\n        # Decisi\u00f3n: \u00bfcontinuar o detener?\n        if not authorized:\n            return JSONResponse(status_code=403)  # \u2b05\ufe0f Detener cadena\n\n    return await call_next(request)  # \u2b05\ufe0f Pasar al siguiente handler\n\n\nasync def invalidate_cache_on_write_middleware(request: Request, call_next):\n    \"\"\"Otro handler en la cadena.\"\"\"\n    response = await call_next(request)  # \u2b05\ufe0f Delegar a siguiente\n\n    if request.method in [\"POST\", \"PUT\", \"PATCH\", \"DELETE\"]:\n        await FastAPICache.clear()  # \u2b05\ufe0f Procesar despu\u00e9s\n\n    return response\n</code></pre>"},{"location":"root_1_architecture_DESIGN_PATTERNS_IMPLEMENTED/#beneficios-obtenidos_8","title":"Beneficios Obtenidos","text":"<ul> <li>\u2705 Procesamiento secuencial flexible: Orden declarativo</li> <li>\u2705 Responsabilidad \u00fanica: Cada middleware una tarea</li> <li>\u2705 Extensibilidad: Agregar/quitar handlers f\u00e1cilmente</li> <li>\u2705 Control de flujo: Cada handler decide si continuar</li> </ul>"},{"location":"root_1_architecture_DESIGN_PATTERNS_IMPLEMENTED/#13-composite-pattern-en-modelos","title":"\u2705 13. Composite Pattern (EN MODELOS)","text":"<p>Categor\u00eda: Structural Pattern Ubicaci\u00f3n: <code>backend/app/models/feature.py</code></p>"},{"location":"root_1_architecture_DESIGN_PATTERNS_IMPLEMENTED/#descripcion_12","title":"Descripci\u00f3n","text":"<p>Compone objetos en estructuras de \u00e1rbol para representar jerarqu\u00edas parte-todo, permitiendo a los clientes tratar objetos individuales y composiciones de manera uniforme.</p>"},{"location":"root_1_architecture_DESIGN_PATTERNS_IMPLEMENTED/#implementacion_12","title":"Implementaci\u00f3n","text":"<pre><code># backend/app/models/feature.py\n\nclass Feature(BaseTable, FeatureBase, table=True):\n    \"\"\"\n    Feature puede ser:\n    - Componente individual (hoja del \u00e1rbol)\n    - Componente compuesto (nodo con hijos)\n\n    Ambos se tratan uniformemente.\n    \"\"\"\n    __tablename__ = \"features\"\n\n    # Auto-referencia para crear \u00e1rbol\n    parent_id: Optional[UUID] = Field(default=None, foreign_key=\"features.id\")\n\n    # Relaciones bidireccionales\n    parent: Optional[\"Feature\"] = Relationship(back_populates=\"children\")\n    children: list[\"Feature\"] = Relationship(back_populates=\"parent\")  # \u2b05\ufe0f Composite\n\n    # Propiedades del feature\n    name: str\n    type: FeatureType\n    is_abstract: bool = False\n\n\n# Operaciones recursivas uniformes\ndef get_all_descendants(feature: Feature) -&gt; list[Feature]:\n    \"\"\"\n    Operaci\u00f3n recursiva que funciona igual para:\n    - Hojas (sin children)\n    - Nodos compuestos (con children)\n    \"\"\"\n    descendants = []\n    for child in feature.children:\n        descendants.append(child)\n        descendants.extend(get_all_descendants(child))  # \u2b05\ufe0f Recursi\u00f3n\n    return descendants\n\n\ndef count_total_features(feature: Feature) -&gt; int:\n    \"\"\"Contar features en todo el \u00e1rbol.\"\"\"\n    return 1 + sum(count_total_features(child) for child in feature.children)\n</code></pre>"},{"location":"root_1_architecture_DESIGN_PATTERNS_IMPLEMENTED/#ejemplo-de-uso","title":"Ejemplo de Uso","text":"<pre><code># Crear jerarqu\u00eda de features (\u00e1rbol)\nmatematicas = Feature(name=\"Matem\u00e1ticas\", type=FeatureType.MANDATORY)\n\ncalculo = Feature(name=\"C\u00e1lculo\", type=FeatureType.MANDATORY, parent=matematicas)\nalgebra = Feature(name=\"\u00c1lgebra\", type=FeatureType.OPTIONAL, parent=matematicas)\n\ncalculo_i = Feature(name=\"C\u00e1lculo I\", type=FeatureType.MANDATORY, parent=calculo)\ncalculo_ii = Feature(name=\"C\u00e1lculo II\", type=FeatureType.OPTIONAL, parent=calculo)\n\n# Operaciones uniformes\ntotal = count_total_features(matematicas)  # 5 (ra\u00edz + 4 descendientes)\ndescendants = get_all_descendants(matematicas)  # [calculo, algebra, calculo_i, calculo_ii]\n</code></pre>"},{"location":"root_1_architecture_DESIGN_PATTERNS_IMPLEMENTED/#beneficios-obtenidos_9","title":"Beneficios Obtenidos","text":"<ul> <li>\u2705 Estructura jer\u00e1rquica natural: \u00c1rbol de features</li> <li>\u2705 Operaciones recursivas simples: Mismo c\u00f3digo para hojas y nodos</li> <li>\u2705 Flexibilidad: Agregar/quitar niveles sin cambiar l\u00f3gica</li> <li>\u2705 Navegaci\u00f3n bidireccional: <code>parent</code> y <code>children</code></li> </ul>"},{"location":"root_1_architecture_DESIGN_PATTERNS_IMPLEMENTED/#tabla-resumen-de-patrones","title":"\ud83d\udcca Tabla Resumen de Patrones","text":"# Patr\u00f3n Categor\u00eda Estado Ubicaci\u00f3n Principal 1 Repository Architectural \u2705 Completo <code>repositories/</code>, <code>interfaces/</code> 2 Dependency Injection Architectural \u2705 Completo <code>api/deps.py</code> 3 Singleton Creational \u2705 Completo <code>core/config.py</code>, <code>core/db.py</code> 4 Factory Method Creational \u26a0\ufe0f Parcial <code>api/deps.py</code> 5 Builder Creational \u2705 Completo Pydantic models 6 Proxy Structural \u2705 Completo <code>middlewares.py</code> 7 Decorator Structural \u2705 Completo Endpoints, <code>api/deps.py</code> 8 Strategy Behavioral \u26a0\ufe0f Limitado <code>feature_flags.py</code>, repositories 9 Template Method Behavioral \u2705 Completo <code>repositories/base.py</code> 10 Observer Behavioral \u26a0\ufe0f Limitado <code>middlewares.py</code> 11 Adapter Structural \u2705 Completo Integraciones S3/Redis/Sentry 12 Chain of Responsibility Behavioral \u2705 Completo Middleware stack 13 Composite Structural \u2705 Completo <code>models/feature.py</code> Abstract Factory Creational \u274c Falta - Command Behavioral \u274c Falta - State Behavioral \u274c Falta -"},{"location":"root_1_architecture_DESIGN_PATTERNS_IMPLEMENTED/#analisis-por-categoria","title":"\ud83c\udfaf An\u00e1lisis por Categor\u00eda","text":""},{"location":"root_1_architecture_DESIGN_PATTERNS_IMPLEMENTED/#creational-patterns-creacion","title":"Creational Patterns (Creaci\u00f3n)","text":"Patr\u00f3n Estado Impacto Singleton \u2705 Completo Alto Builder \u2705 Completo Alto Factory Method \u26a0\ufe0f Parcial Medio Abstract Factory \u274c Falta Medio (sugerido) <p>Conclusi\u00f3n: Buena cobertura de patrones creacionales b\u00e1sicos. Abstract Factory podr\u00eda mejorar la flexibilidad.</p>"},{"location":"root_1_architecture_DESIGN_PATTERNS_IMPLEMENTED/#structural-patterns-estructura","title":"Structural Patterns (Estructura)","text":"Patr\u00f3n Estado Impacto Composite \u2705 Completo Alto Decorator \u2705 Completo Alto Adapter \u2705 Completo Medio Proxy \u2705 Completo Medio <p>Conclusi\u00f3n: \u2705 Excelente cobertura de patrones estructurales. Todos los patrones clave implementados.</p>"},{"location":"root_1_architecture_DESIGN_PATTERNS_IMPLEMENTED/#behavioral-patterns-comportamiento","title":"Behavioral Patterns (Comportamiento)","text":"Patr\u00f3n Estado Impacto Template Method \u2705 Completo Alto Chain of Responsibility \u2705 Completo Alto Strategy \u26a0\ufe0f Limitado Medio Observer \u26a0\ufe0f Limitado Bajo Command \u274c Falta Bajo (opcional) State \u274c Falta Bajo (opcional) <p>Conclusi\u00f3n: Buena base. Strategy y Observer podr\u00edan robustecerse para mayor flexibilidad.</p>"},{"location":"root_1_architecture_DESIGN_PATTERNS_IMPLEMENTED/#fortalezas-de-la-arquitectura-actual","title":"\u2705 Fortalezas de la Arquitectura Actual","text":""},{"location":"root_1_architecture_DESIGN_PATTERNS_IMPLEMENTED/#1-separacion-de-concerns-excelente","title":"1. Separaci\u00f3n de Concerns Excelente","text":"<pre><code>api/           \u2190 Capa de presentaci\u00f3n (REST)\n\u251c\u2500\u2500 models/    \u2190 Capa de dominio (entidades)\n\u251c\u2500\u2500 repositories/ \u2190 Capa de datos (persistencia)\n\u251c\u2500\u2500 services/  \u2190 L\u00f3gica de negocio (futuro)\n\u2514\u2500\u2500 interfaces/ \u2190 Contratos (abstracci\u00f3n)\n</code></pre>"},{"location":"root_1_architecture_DESIGN_PATTERNS_IMPLEMENTED/#2-principios-solid-aplicados","title":"2. Principios SOLID Aplicados","text":"<ul> <li>\u2705 **S**ingle Responsibility: Cada clase una responsabilidad</li> <li>\u2705 **O**pen/Closed: Extensible mediante herencia/composici\u00f3n</li> <li>\u2705 **L**iskov Substitution: Interfaces intercambiables (sync/async)</li> <li>\u2705 **I**nterface Segregation: Interfaces espec\u00edficas (<code>Protocol</code>)</li> <li>\u2705 **D**ependency Inversion: Depende de abstracciones, no implementaciones</li> </ul>"},{"location":"root_1_architecture_DESIGN_PATTERNS_IMPLEMENTED/#3-testability-alta","title":"3. Testability Alta","text":"<pre><code># F\u00e1cil mockear dependencias\ndef test_create_domain(mock_domain_repo):\n    mock_domain_repo.create.return_value = Domain(...)\n    # Test aislado\n</code></pre>"},{"location":"root_1_architecture_DESIGN_PATTERNS_IMPLEMENTED/#4-mantenibilidad","title":"4. Mantenibilidad","text":"<ul> <li>\u2705 C\u00f3digo DRY (Don't Repeat Yourself)</li> <li>\u2705 Abstracciones claras</li> <li>\u2705 Naming consistente</li> <li>\u2705 Type hints completos</li> </ul>"},{"location":"root_1_architecture_DESIGN_PATTERNS_IMPLEMENTED/#areas-de-mejora","title":"\u26a0\ufe0f \u00c1reas de Mejora","text":""},{"location":"root_1_architecture_DESIGN_PATTERNS_IMPLEMENTED/#1-abstract-factory-prioridad-media","title":"1. Abstract Factory (Prioridad Media)","text":"<p>Problema: Creaci\u00f3n manual de familias de repositorios relacionados.</p> <p>Soluci\u00f3n propuesta:</p> <pre><code># backend/app/factories/repository_factory.py\nclass RepositoryFactory(ABC):\n    @abstractmethod\n    def create_domain_repo(self): ...\n    @abstractmethod\n    def create_feature_repo(self): ...\n    @abstractmethod\n    def create_feature_model_repo(self): ...\n\nclass AsyncRepositoryFactory(RepositoryFactory):\n    def __init__(self, session: AsyncSession):\n        self.session = session\n\n    def create_domain_repo(self):\n        return DomainRepositoryAsync(self.session)\n\n    # ...\n</code></pre>"},{"location":"root_1_architecture_DESIGN_PATTERNS_IMPLEMENTED/#2-strategy-pattern-robusto-prioridad-alta","title":"2. Strategy Pattern Robusto (Prioridad Alta)","text":"<p>Problema: Feature flags muy b\u00e1sicos, no hay estrategias pluggables.</p> <p>Soluci\u00f3n propuesta:</p> <pre><code># backend/app/strategies/validation.py\nclass ConstraintValidatorStrategy(ABC):\n    @abstractmethod\n    def validate(self, configuration: Configuration) -&gt; ValidationResult:\n        pass\n\nclass SATValidatorStrategy(ConstraintValidatorStrategy):\n    \"\"\"Validaci\u00f3n formal con SAT solver.\"\"\"\n    pass\n\nclass HeuristicValidatorStrategy(ConstraintValidatorStrategy):\n    \"\"\"Validaci\u00f3n r\u00e1pida con heur\u00edsticas.\"\"\"\n    pass\n\n# Configuraci\u00f3n\nCONSTRAINT_VALIDATOR = SATValidatorStrategy()  # Intercambiable\n</code></pre>"},{"location":"root_1_architecture_DESIGN_PATTERNS_IMPLEMENTED/#3-observer-pattern-completo-prioridad-baja","title":"3. Observer Pattern Completo (Prioridad Baja)","text":"<p>Problema: Eventos hardcoded en middleware.</p> <p>Soluci\u00f3n propuesta:</p> <pre><code># backend/app/events/event_bus.py\nclass EventBus:\n    def subscribe(self, event: str, handler: Callable): ...\n    async def publish(self, event: str, data: dict): ...\n\n# Uso\nevent_bus.subscribe(\"domain.created\", invalidate_cache)\nevent_bus.subscribe(\"domain.created\", send_analytics)\nawait event_bus.publish(\"domain.created\", {\"domain_id\": domain.id})\n</code></pre>"},{"location":"root_1_architecture_DESIGN_PATTERNS_IMPLEMENTED/#roadmap-de-mejoras","title":"\ud83d\ude80 Roadmap de Mejoras","text":""},{"location":"root_1_architecture_DESIGN_PATTERNS_IMPLEMENTED/#fase-1-fundamentos-1-2-semanas","title":"Fase 1: Fundamentos (1-2 semanas)","text":"<ol> <li>\u2705 Implementar Abstract Factory para repositorios</li> <li>\u2705 Mejorar Feature Toggles (estrategias, contexto)</li> <li>\u2705 Documentar patrones existentes</li> </ol>"},{"location":"root_1_architecture_DESIGN_PATTERNS_IMPLEMENTED/#fase-2-extensiones-2-4-semanas","title":"Fase 2: Extensiones (2-4 semanas)","text":"<ol> <li>\u2705 Implementar Strategy Pattern para validaci\u00f3n/generaci\u00f3n</li> <li>\u2705 Sistema de eventos (Observer completo)</li> <li>\u2705 Command Pattern para operaciones complejas (opcional)</li> </ol>"},{"location":"root_1_architecture_DESIGN_PATTERNS_IMPLEMENTED/#fase-3-optimizacion-1-2-meses","title":"Fase 3: Optimizaci\u00f3n (1-2 meses)","text":"<ol> <li>\u2705 M\u00e9tricas de uso de patrones</li> <li>\u2705 Refactorizaci\u00f3n basada en m\u00e9tricas</li> <li>\u2705 Gu\u00edas de extensi\u00f3n para desarrolladores</li> </ol>"},{"location":"root_1_architecture_DESIGN_PATTERNS_IMPLEMENTED/#recursos-y-referencias","title":"\ud83d\udcda Recursos y Referencias","text":""},{"location":"root_1_architecture_DESIGN_PATTERNS_IMPLEMENTED/#documentos-relacionados","title":"Documentos Relacionados","text":"<ul> <li><code>docs/1_architecture/SPL_TECHNIQUES_ANALYSIS.md</code> - An\u00e1lisis SPL completo</li> <li><code>docs/1_architecture/ARCHITECTURAL_PATTERN_ANALYSIS.md</code> - Patr\u00f3n arquitect\u00f3nico general</li> <li><code>backend/README.md</code> - Gu\u00eda de desarrollo</li> </ul>"},{"location":"root_1_architecture_DESIGN_PATTERNS_IMPLEMENTED/#libros-recomendados","title":"Libros Recomendados","text":"<ol> <li>Design Patterns: Elements of Reusable Object-Oriented Software (Gang of Four)</li> <li>Patterns of Enterprise Application Architecture (Martin Fowler)</li> <li>Clean Architecture (Robert C. Martin)</li> </ol>"},{"location":"root_1_architecture_DESIGN_PATTERNS_IMPLEMENTED/#herramientas-de-analisis","title":"Herramientas de An\u00e1lisis","text":"<pre><code># Analizar dependencias\npip install pydeps\npydeps backend/app --max-bacon=2\n\n# Analizar complejidad\npip install radon\nradon cc backend/app -a\n\n# Analizar coverage de tests\npytest --cov=app --cov-report=html\n</code></pre>"},{"location":"root_1_architecture_DESIGN_PATTERNS_IMPLEMENTED/#conclusiones","title":"\u2705 Conclusiones","text":""},{"location":"root_1_architecture_DESIGN_PATTERNS_IMPLEMENTED/#resumen-de-estado","title":"Resumen de Estado","text":"<ul> <li>13 patrones implementados (10 completos, 3 parciales)</li> <li>Cobertura excelente de patrones fundamentales</li> <li>Arquitectura s\u00f3lida basada en principios SOLID</li> <li>Testability alta gracias a DI y Repository</li> <li>Mantenibilidad buena con abstracciones claras</li> </ul>"},{"location":"root_1_architecture_DESIGN_PATTERNS_IMPLEMENTED/#fortalezas-clave","title":"Fortalezas Clave","text":"<ol> <li>\u2705 Repository Pattern - Abstracci\u00f3n de datos impecable</li> <li>\u2705 Dependency Injection - Flexibilidad y testability</li> <li>\u2705 Decorator Pattern - Composici\u00f3n de comportamiento</li> <li>\u2705 Composite Pattern - Estructura jer\u00e1rquica de features</li> </ol>"},{"location":"root_1_architecture_DESIGN_PATTERNS_IMPLEMENTED/#proximos-pasos-recomendados","title":"Pr\u00f3ximos Pasos Recomendados","text":"<ol> <li>\ud83d\udd34 Alta prioridad: Abstract Factory, Strategy robusto</li> <li>\ud83d\udfe1 Media prioridad: Observer completo, Command pattern</li> <li>\ud83d\udfe2 Baja prioridad: State pattern, m\u00e9tricas avanzadas</li> </ol>"},{"location":"root_1_architecture_DESIGN_PATTERNS_IMPLEMENTED/#indicadores-de-calidad","title":"Indicadores de Calidad","text":"M\u00e9trica Valor Actual Objetivo Estado Patrones implementados 13 15+ \u2705 Bueno Cobertura de tests ~80% 90% \u26a0\ufe0f Mejorar Complejidad ciclom\u00e1tica Baja Baja \u2705 \u00d3ptimo Acoplamiento Bajo Bajo \u2705 \u00d3ptimo Cohesi\u00f3n Alta Alta \u2705 \u00d3ptimo <p>Documento generado: 9 de diciembre de 2025 Versi\u00f3n: 1.0 Autor: An\u00e1lisis Arquitect\u00f3nico de Patrones de Dise\u00f1o</p>"},{"location":"root_1_architecture_db/","title":"Base de Datos","text":"<p>Excelente \ud83d\ude4c ahora s\u00ed vamos a meternos en lo t\u00e9cnico. Si quieres crear un sistema para manejar Feature Models en varios dominios educativos, lo primero es dise\u00f1ar la base de datos que soporte:</p> <ol> <li>Dominios educativos (ej. LMS, tutor\u00edas, recursos).</li> <li>Feature Models asociados a cada dominio.</li> <li>Caracter\u00edsticas de esos modelos (obligatorias, opcionales, alternativas, OR).</li> <li>Relaciones entre caracter\u00edsticas.</li> <li>Configuraciones generadas (instancias concretas de un Feature Model v\u00e1lido).</li> </ol>"},{"location":"root_1_architecture_db/#modelo-de-base-de-datos-diseno-logico","title":"\ud83d\udcd0 Modelo de Base de Datos (Dise\u00f1o l\u00f3gico)","text":""},{"location":"root_1_architecture_db/#1-tabla-domain","title":"1. Tabla <code>domain</code>","text":"<p>Representa el \u00e1rea educativa.</p> <pre><code>domain (\n    id UUID [PK],\n    name VARCHAR(100),         -- Ej: \"LMS\", \"Tutor\u00edas\", \"Biblioteca\"\n    description TEXT,\n    created_at TIMESTAMP,\n    updated_at TIMESTAMP\n)\n</code></pre>"},{"location":"root_1_architecture_db/#2-tabla-feature_model","title":"2. Tabla <code>feature_model</code>","text":"<p>Cada dominio puede tener uno o varios modelos de caracter\u00edsticas.</p> <pre><code>feature_model (\n    id UUID [PK],\n    domain_id UUID [FK \u2192 domain.id],\n    name VARCHAR(100),         -- Ej: \"Modelo LMS B\u00e1sico\"\n    description TEXT,\n    created_at TIMESTAMP,\n    updated_at TIMESTAMP\n)\n</code></pre>"},{"location":"root_1_architecture_db/#3-tabla-feature","title":"3. Tabla <code>feature</code>","text":"<p>Cada caracter\u00edstica de un modelo.</p> <pre><code>feature (\n    id UUID [PK],\n    feature_model_id UUID [FK \u2192 feature_model.id],\n    name VARCHAR(100),         -- Ej: \"Autenticaci\u00f3n\", \"Chat\", \"Videollamada\"\n    type VARCHAR(20),          -- \"mandatory\", \"optional\", \"alternative\", \"or\"\n    parent_id UUID [FK \u2192 feature.id NULL], -- Para jerarqu\u00eda (subcaracter\u00edsticas)\n    created_at TIMESTAMP,\n    updated_at TIMESTAMP\n)\n</code></pre> <p>\ud83d\udd11 Esto permite definir jerarqu\u00edas tipo \u00e1rbol: un <code>feature</code> puede tener sub-features.</p>"},{"location":"root_1_architecture_db/#4-tabla-feature_relation","title":"4. Tabla <code>feature_relation</code>","text":"<p>Explicita relaciones entre caracter\u00edsticas (cuando no son jer\u00e1rquicas simples).</p> <pre><code>feature_relation (\n    id UUID [PK],\n    feature_id UUID [FK \u2192 feature.id],\n    related_feature_id UUID [FK \u2192 feature.id],\n    relation_type VARCHAR(20)   -- Ej: \"requires\", \"excludes\"\n)\n</code></pre>"},{"location":"root_1_architecture_db/#5-tabla-configuration","title":"5. Tabla <code>configuration</code>","text":"<p>Representa una configuraci\u00f3n concreta de un modelo.</p> <pre><code>configuration (\n    id UUID [PK],\n    feature_model_id UUID [FK \u2192 feature_model.id],\n    name VARCHAR(100),        -- Ej: \"Config LMS Universidad\"\n    description TEXT,\n    created_at TIMESTAMP,\n    updated_at TIMESTAMP\n)\n</code></pre>"},{"location":"root_1_architecture_db/#6-tabla-configuration_feature","title":"6. Tabla <code>configuration_feature</code>","text":"<p>Asocia caracter\u00edsticas activadas en una configuraci\u00f3n.</p> <pre><code>configuration_feature (\n    id UUID [PK],\n    configuration_id UUID [FK \u2192 configuration.id],\n    feature_id UUID [FK \u2192 feature.id],\n    enabled BOOLEAN           -- TRUE si la caracter\u00edstica est\u00e1 activa\n)\n</code></pre>"},{"location":"root_1_architecture_db/#ejemplo-de-uso","title":"\ud83d\udcca Ejemplo de uso","text":""},{"location":"root_1_architecture_db/#dominio","title":"Dominio","text":"<ul> <li>Tutor\u00edas Online</li> </ul>"},{"location":"root_1_architecture_db/#feature-model","title":"Feature Model","text":"<ul> <li>Modelo: <code>Tutor\u00edas Configurable</code></li> </ul>"},{"location":"root_1_architecture_db/#features","title":"Features","text":"<ul> <li> <p>Comunicaci\u00f3n (MANDATORY)</p> </li> <li> <p>Chat (OPTIONAL)</p> </li> <li>Videollamada (OPTIONAL)</li> <li>Pago (ALTERNATIVE \u2192 {Paypal, Tarjeta, Gratuito})</li> <li>Agenda (OPTIONAL)</li> </ul>"},{"location":"root_1_architecture_db/#configuracion-posible","title":"Configuraci\u00f3n posible","text":"<ul> <li>Comunicaci\u00f3n: Chat + Videollamada</li> <li>Pago: Paypal</li> <li>Agenda: S\u00ed</li> </ul> <p>Esto se almacenar\u00eda en <code>configuration</code> + <code>configuration_feature</code>.</p>"},{"location":"root_1_architecture_db/#a-nivel-de-fastapi-orm-con-sqlalchemy","title":"\ud83d\ude80 A nivel de FastAPI (ORM con SQLAlchemy)","text":"<p>Tendr\u00edas clases como:</p> <pre><code>class Domain(Base):\n    __tablename__ = \"domain\"\n    id = Column(UUID(as_uuid=True), primary_key=True, default=uuid.uuid4)\n    name = Column(String, nullable=False)\n    description = Column(Text)\n    feature_models = relationship(\"FeatureModel\", back_populates=\"domain\")\n\n\nclass FeatureModel(Base):\n    __tablename__ = \"feature_model\"\n    id = Column(UUID(as_uuid=True), primary_key=True, default=uuid.uuid4)\n    domain_id = Column(UUID(as_uuid=True), ForeignKey(\"domain.id\"))\n    name = Column(String, nullable=False)\n    description = Column(Text)\n    domain = relationship(\"Domain\", back_populates=\"feature_models\")\n    features = relationship(\"Feature\", back_populates=\"feature_model\")\n</code></pre> <p>\ud83d\udc49 Te puedo armar un esquema completo en SQLAlchemy con Pydantic models para FastAPI (incluyendo relaciones y validaciones) para que lo uses como base de tu sistema.</p> <p>\u00bfQuieres que te arme directamente el esquema completo en FastAPI (modelos ORM + Pydantic) listo para usar, o prefieres que primero lo aterrice en un diagrama visual tipo UML para que lo entiendas mejor antes de pasar al c\u00f3digo?</p>"},{"location":"root_1_architecture_db/#-","title":"----------","text":"<p>Perfecto \ud83d\ude4c. Si tu sistema ser\u00e1 un constructor y gestor de feature models para educaci\u00f3n, lo primero es una buena base de datos relacional que te permita:</p> <ul> <li>Definir modelos de caracter\u00edsticas (ej. Sistema Educativo).</li> <li>Guardar features (ej. Asistencia, Calificaciones, Biblioteca).</li> <li>Especificar relaciones/restricciones entre features (obligatorio, opcional, requiere, excluye).</li> <li>Generar y almacenar configuraciones v\u00e1lidas (ej. Universidad, Primaria).</li> </ul>"},{"location":"root_1_architecture_db/#modelo-de-datos-propuesto","title":"\ud83d\udcca Modelo de datos propuesto","text":""},{"location":"root_1_architecture_db/#1-tabla-feature_models","title":"1. Tabla <code>feature_models</code>","text":"<p>Representa un modelo de caracter\u00edsticas completo.</p> Campo Tipo Descripci\u00f3n id PK (UUID/Auto) Identificador \u00fanico name VARCHAR Nombre del modelo (ej. \u201cSistema Educativo\u201d) description TEXT Descripci\u00f3n general created_at DATETIME Fecha de creaci\u00f3n updated_at DATETIME \u00daltima actualizaci\u00f3n"},{"location":"root_1_architecture_db/#2-tabla-features","title":"2. Tabla <code>features</code>","text":"<p>Cada caracter\u00edstica definida en un modelo.</p> Campo Tipo Descripci\u00f3n id PK (UUID/Auto) Identificador \u00fanico model_id FK \u2192 feature_models.id A qu\u00e9 modelo pertenece name VARCHAR Nombre de la caracter\u00edstica (ej. \u201cAsistencia\u201d) description TEXT Detalle de la feature type ENUM(<code>mandatory</code>, <code>optional</code>, <code>alternative</code>, <code>or</code>) Tipo de feature parent_id FK \u2192 features.id Permite jerarqu\u00eda (ej. \u201cEvaluaci\u00f3n\u201d \u2192 \u201cEx\u00e1menes\u201d)"},{"location":"root_1_architecture_db/#3-tabla-constraints","title":"3. Tabla <code>constraints</code>","text":"<p>Restricciones entre features (ej. \u201cEx\u00e1menes en l\u00ednea requiere Evaluaci\u00f3n\u201d).</p> Campo Tipo Descripci\u00f3n id PK (UUID/Auto) Identificador \u00fanico model_id FK \u2192 feature_models.id Modelo al que pertenece source_feature FK \u2192 features.id Feature origen target_feature FK \u2192 features.id Feature destino relation_type ENUM(<code>requires</code>, <code>excludes</code>) Tipo de relaci\u00f3n"},{"location":"root_1_architecture_db/#4-tabla-configurations","title":"4. Tabla <code>configurations</code>","text":"<p>Cada configuraci\u00f3n es una combinaci\u00f3n v\u00e1lida de features para un caso educativo.</p> Campo Tipo Descripci\u00f3n id PK (UUID/Auto) Identificador \u00fanico model_id FK \u2192 feature_models.id Modelo base name VARCHAR Nombre de la configuraci\u00f3n (ej. \u201cEscuela Primaria\u201d) description TEXT Detalle de la configuraci\u00f3n created_at DATETIME Fecha de creaci\u00f3n"},{"location":"root_1_architecture_db/#5-tabla-configuration_features","title":"5. Tabla <code>configuration_features</code>","text":"<p>Lista de features activadas en una configuraci\u00f3n.</p> Campo Tipo Descripci\u00f3n id PK (UUID/Auto) Identificador \u00fanico configuration_id FK \u2192 configurations.id Configuraci\u00f3n a la que pertenece feature_id FK \u2192 features.id Feature incluida"},{"location":"root_1_architecture_db/#ejemplo-practico","title":"\ud83d\udccc Ejemplo pr\u00e1ctico","text":""},{"location":"root_1_architecture_db/#modelo","title":"Modelo","text":"<ul> <li><code>Sistema Educativo</code></li> </ul>"},{"location":"root_1_architecture_db/#features_1","title":"Features","text":"<ul> <li> <p><code>Gesti\u00f3n Acad\u00e9mica (mandatory)</code></p> </li> <li> <p><code>Calificaciones (mandatory)</code></p> </li> <li><code>Asistencia (optional)</code></li> <li> <p><code>Evaluaci\u00f3n (optional)</code></p> </li> <li> <p><code>Ex\u00e1menes en L\u00ednea (optional)</code></p> </li> <li><code>Comunicaci\u00f3n (optional)</code></li> </ul>"},{"location":"root_1_architecture_db/#restricciones","title":"Restricciones","text":"<ul> <li><code>Ex\u00e1menes en L\u00ednea \u2192 requires \u2192 Evaluaci\u00f3n</code></li> </ul>"},{"location":"root_1_architecture_db/#configuraciones-posibles","title":"Configuraciones posibles","text":"<ol> <li>Primaria: Gesti\u00f3n Acad\u00e9mica + Asistencia.</li> <li>Universidad: Gesti\u00f3n Acad\u00e9mica + Calificaciones + Evaluaci\u00f3n + Ex\u00e1menes en L\u00ednea + Comunicaci\u00f3n.</li> </ol>"},{"location":"root_1_architecture_db/#implementacion-en-fastapi","title":"\ud83d\udccc Implementaci\u00f3n en FastAPI","text":"<ul> <li>Usar\u00edas SQLAlchemy o Tortoise ORM para definir estas tablas.</li> <li> <p>API REST con endpoints como:</p> </li> <li> <p><code>POST /models/</code> \u2192 crear modelo.</p> </li> <li><code>POST /models/{id}/features/</code> \u2192 agregar features.</li> <li><code>POST /models/{id}/constraints/</code> \u2192 agregar restricciones.</li> <li><code>POST /models/{id}/configurations/</code> \u2192 generar configuraci\u00f3n.</li> <li><code>GET /models/{id}/configurations/valid</code> \u2192 listar configuraciones v\u00e1lidas.</li> </ul> <p>\ud83d\udc49 \u00bfQuieres que te escriba un ejemplo en c\u00f3digo con SQLAlchemy (modelos ORM + un par de endpoints de FastAPI) para que tengas la base lista en tu proyecto?</p>"},{"location":"root_1_architecture_folder_structure/","title":"Estructura de Carpetas","text":"<p>\u00a1Excelente pregunta! Como experto en FastAPI, te puedo asegurar que su dise\u00f1o, especialmente el sistema de Inyecci\u00f3n de Dependencias, permite crear arquitecturas incre\u00edblemente limpias y robustas. La clave es pensar en capas y aprovechar al m\u00e1ximo las caracter\u00edsticas del framework.</p> <p>Una estructura bien dise\u00f1ada para una plataforma gigante y robusta con FastAPI se basa en estos principios:</p> <ol> <li>Modularidad por Dominio (Features): El c\u00f3digo se agrupa por funcionalidad (<code>users</code>, <code>products</code>, <code>orders</code>), no por tipo de archivo (<code>views</code>, <code>models</code>).</li> <li>Separaci\u00f3n de Capas Claras: Se distingue n\u00edtidamente entre la capa de API (routers), la capa de l\u00f3gica de negocio (servicios) y la capa de acceso a datos (CRUD/repositorios).</li> <li>Inyecci\u00f3n de Dependencias (DI): Se utiliza el sistema de DI de FastAPI para todo: sesiones de base de datos, autenticaci\u00f3n, etc. Esto desacopla los componentes y facilita enormemente las pruebas.</li> <li>Tipado Estricto con Pydantic: Se usa Pydantic no solo para la validaci\u00f3n de la API, sino tambi\u00e9n para la configuraci\u00f3n y la definici\u00f3n de esquemas de datos claros en toda la aplicaci\u00f3n.</li> </ol>"},{"location":"root_1_architecture_folder_structure/#la-estructura-de-carpetas-recomendada","title":"La Estructura de Carpetas Recomendada","text":"<p>Esta es una estructura probada en batalla que escala muy bien.</p> <pre><code>mi_plataforma_fastapi/\n\u251c\u2500\u2500 .env                 # Variables de entorno (SECRET_KEY, DATABASE_URL)\n\u251c\u2500\u2500 .env.example         # Plantilla de variables de entorno\n\u251c\u2500\u2500 .gitignore\n\u251c\u2500\u2500 pyproject.toml       # O requirements.txt. Define dependencias del proyecto.\n\u251c\u2500\u2500 README.md\n\u2502\n\u251c\u2500\u2500 app/                 # Directorio principal del c\u00f3digo fuente de la aplicaci\u00f3n\n\u2502   \u251c\u2500\u2500 __init__.py\n\u2502   \u251c\u2500\u2500 main.py          # Punto de entrada de la aplicaci\u00f3n FastAPI y uni\u00f3n de routers\n\u2502   \u2502\n\u2502   \u251c\u2500\u2500 core/            # Configuraci\u00f3n global, seguridad y l\u00f3gica del n\u00facleo\n\u2502   \u2502   \u251c\u2500\u2500 __init__.py\n\u2502   \u2502   \u251c\u2500\u2500 config.py    # Gesti\u00f3n de la configuraci\u00f3n (usando Pydantic Settings)\n\u2502   \u2502   \u2514\u2500\u2500 security.py  # Funciones de hashing de contrase\u00f1as, creaci\u00f3n/validaci\u00f3n de JWT\n\u2502   \u2502\n\u2502   \u251c\u2500\u2500 db/              # Todo lo relacionado con la base de datos\n\u2502   \u2502   \u251c\u2500\u2500 __init__.py\n\u2502   \u2502   \u251c\u2500\u2500 base.py      # Base para los modelos de SQLAlchemy (DeclarativeBase)\n\u2502   \u2502   \u2514\u2500\u2500 session.py   # Creaci\u00f3n del motor de BD, SessionLocal y la dependencia get_db\n\u2502   \u2502\n\u2502   \u251c\u2500\u2500 models/          # Modelos del ORM (SQLAlchemy)\n\u2502   \u2502   \u251c\u2500\u2500 __init__.py\n\u2502   \u2502   \u251c\u2500\u2500 user.py\n\u2502   \u2502   \u2514\u2500\u2500 item.py\n\u2502   \u2502\n\u2502   \u251c\u2500\u2500 schemas/         # Esquemas Pydantic (para validaci\u00f3n de API y serializaci\u00f3n)\n\u2502   \u2502   \u251c\u2500\u2500 __init__.py\n\u2502   \u2502   \u251c\u2500\u2500 user.py      # Schemas: UserCreate, UserUpdate, UserInDB, UserRead\n\u2502   \u2502   \u251c\u2500\u2500 item.py\n\u2502   \u2502   \u2514\u2500\u2500 token.py     # Schema para el token de autenticaci\u00f3n\n\u2502   \u2502\n\u2502   \u251c\u2500\u2500 crud/            # Capa de Acceso a Datos (Data Access Layer - DAL)\n\u2502   \u2502   \u251c\u2500\u2500 __init__.py\n\u2502   \u2502   \u251c\u2500\u2500 base.py      # Una clase base para CRUD (opcional, pero muy \u00fatil)\n\u2502   \u2502   \u251c\u2500\u2500 crud_user.py # Funciones CRUD para el modelo User\n\u2502   \u2502   \u2514\u2500\u2500 crud_item.py\n\u2502   \u2502\n\u2502   \u251c\u2500\u2500 services/        # Capa de L\u00f3gica de Negocio (Business Logic Layer - BLL)\n\u2502   \u2502   \u251c\u2500\u2500 __init__.py\n\u2502   \u2502   \u2514\u2500\u2500 user_service.py # Orquesta operaciones complejas (ej. registrar usuario y enviar email)\n\u2502   \u2502\n\u2502   \u2514\u2500\u2500 api/             # Capa de API (Routers/Controllers)\n\u2502       \u251c\u2500\u2500 __init__.py\n\u2502       \u251c\u2500\u2500 deps.py      # Dependencias reutilizables de la API (ej. get_current_user)\n\u2502       \u2514\u2500\u2500 v1/          # Versi\u00f3n 1 de la API\n\u2502           \u251c\u2500\u2500 __init__.py\n\u2502           \u251c\u2500\u2500 api.py     # Archivo que une todos los routers de la v1\n\u2502           \u251c\u2500\u2500 users.py   # Router para los endpoints de /users\n\u2502           \u2514\u2500\u2500 items.py   # Router para los endpoints de /items\n\u2502\n\u2514\u2500\u2500 tests/               # Pruebas para la aplicaci\u00f3n\n    \u251c\u2500\u2500 __init__.py\n    \u251c\u2500\u2500 conftest.py      # Fixtures de Pytest (ej. cliente de prueba, sesi\u00f3n de BD de prueba)\n    \u2514\u2500\u2500 api/\n        \u2514\u2500\u2500 v1/\n            \u251c\u2500\u2500 test_users_api.py\n</code></pre>"},{"location":"root_1_architecture_folder_structure/#explicacion-detallada-de-los-componentes-clave","title":"Explicaci\u00f3n Detallada de los Componentes Clave","text":""},{"location":"root_1_architecture_folder_structure/#1-core-el-nucleo","title":"1. <code>core/</code> - El N\u00facleo","text":"<ul> <li><code>config.py</code>: En lugar de leer variables de entorno directamente, se usa <code>pydantic.BaseSettings</code>. Esto te da validaci\u00f3n de tipos, valores por defecto y carga autom\u00e1tica desde archivos <code>.env</code>. Es extremadamente robusto.</li> <li><code>security.py</code>: A\u00edsla toda la l\u00f3gica criptogr\u00e1fica. Funciones como <code>verify_password</code>, <code>get_password_hash</code>, <code>create_access_token</code> viven aqu\u00ed.</li> </ul>"},{"location":"root_1_architecture_folder_structure/#2-db-la-conexion","title":"2. <code>db/</code> - La Conexi\u00f3n","text":"<ul> <li><code>session.py</code>: Es uno de los archivos m\u00e1s importantes. Aqu\u00ed defines el <code>engine</code> de SQLAlchemy, <code>SessionLocal</code> y, lo m\u00e1s crucial, la dependencia <code>get_db()</code> que se inyectar\u00e1 en los endpoints de la API para proporcionar una sesi\u00f3n de base de datos.     <pre><code># db/session.py (ejemplo simplificado)\ndef get_db():\n    db = SessionLocal()\n    try:\n        yield db\n    finally:\n        db.close()\n</code></pre></li> </ul>"},{"location":"root_1_architecture_folder_structure/#3-schemas-vs-models-la-separacion-esencial","title":"3. <code>schemas/</code> vs <code>models/</code> - La Separaci\u00f3n Esencial","text":"<ul> <li><code>models/</code>: Representa las tablas de tu base de datos (modelos de SQLAlchemy). Es la estructura interna de tus datos.</li> <li><code>schemas/</code>: Representa la \"forma\" de los datos que entran y salen de tu API (modelos Pydantic). Permite exponer solo ciertos campos, validar tipos y formatos. Por ejemplo, <code>UserInDB</code> podr\u00eda tener el <code>hashed_password</code>, pero <code>UserRead</code> (el que se env\u00eda al cliente) no lo tendr\u00eda. Esta separaci\u00f3n es fundamental para la seguridad y la flexibilidad.</li> </ul>"},{"location":"root_1_architecture_folder_structure/#4-la-arquitectura-de-tres-capas-api-services-crud","title":"4. La Arquitectura de Tres Capas (<code>api</code>, <code>services</code>, <code>crud</code>)","text":"<p>Esta es la verdadera clave para la escalabilidad.</p> <ul> <li> <p><code>crud/</code> (Capa de Acceso a Datos):</p> <ul> <li>Su \u00fanica responsabilidad es interactuar con la base de datos.</li> <li>Contiene funciones simples como <code>get_user_by_email(db, email)</code>, <code>create_user(db, user_data)</code>.</li> <li>No contiene ninguna l\u00f3gica de negocio. Solo <code>SELECT</code>, <code>INSERT</code>, <code>UPDATE</code>, <code>DELETE</code>.</li> <li>Recibe una sesi\u00f3n de BD (<code>db</code>) y los datos necesarios.</li> </ul> </li> <li> <p><code>services/</code> (Capa de L\u00f3gica de Negocio):</p> <ul> <li>Esta capa es opcional para endpoints simples, pero indispensable para plataformas complejas.</li> <li>Orquesta la l\u00f3gica que va m\u00e1s all\u00e1 de un simple CRUD. Por ejemplo, una funci\u00f3n <code>register_new_user</code> en <code>user_service.py</code> podr\u00eda:<ol> <li>Llamar a <code>crud.get_user_by_email</code> para ver si el usuario ya existe.</li> <li>Llamar a <code>security.get_password_hash</code> para hashear la contrase\u00f1a.</li> <li>Llamar a <code>crud.create_user</code> para guardar el nuevo usuario en la BD.</li> <li>Disparar una tarea para enviar un email de bienvenida.</li> </ol> </li> <li>Esta capa no sabe nada de HTTP (requests/responses). Se mantiene pura y reutilizable.</li> </ul> </li> <li> <p><code>api/</code> (Capa de Presentaci\u00f3n / Routers):</p> <ul> <li>Es la capa m\u00e1s externa. Su \u00fanica responsabilidad es manejar el protocolo HTTP.</li> <li>Define los endpoints (<code>@router.post(\"/users/\")</code>).</li> <li>Usa la inyecci\u00f3n de dependencias de FastAPI para obtener lo que necesita: <code>db: Session = Depends(get_db)</code>, <code>current_user: models.User = Depends(deps.get_current_active_user)</code>.</li> <li>Valida los datos de entrada usando los esquemas Pydantic.</li> <li>Llama a la capa de servicios (o a la de CRUD para operaciones simples) para ejecutar la acci\u00f3n.</li> <li>Formatea la respuesta saliente usando los esquemas Pydantic.</li> </ul> </li> </ul>"},{"location":"root_1_architecture_folder_structure/#el-flujo-de-una-peticion-en-esta-arquitectura","title":"El Flujo de una Petici\u00f3n en esta Arquitectura","text":"<p>Imaginemos una petici\u00f3n <code>POST /api/v1/users/</code> para registrar un usuario:</p> <ol> <li>Routing: <code>main.py</code> delega <code>/api/v1</code> a <code>api/v1/api.py</code>, que a su vez incluye el router de <code>api/v1/users.py</code>.</li> <li>Endpoint (<code>api/v1/users.py</code>):<ul> <li>La funci\u00f3n decorada con <code>@router.post(\"/\")</code> se ejecuta.</li> <li>FastAPI autom\u00e1ticamente:<ul> <li>Valida el cuerpo de la petici\u00f3n contra el schema <code>schemas.user.UserCreate</code>.</li> <li>Ejecuta la dependencia <code>get_db</code> y le pasa la sesi\u00f3n (<code>db: Session</code>).</li> </ul> </li> <li>El endpoint llama a <code>user_service.register_new_user(db=db, user_data=user_in)</code>.</li> </ul> </li> <li>Servicio (<code>services/user_service.py</code>):<ul> <li>La funci\u00f3n <code>register_new_user</code> ejecuta la l\u00f3gica de negocio (verificar email, hashear contrase\u00f1a) llamando a las funciones de <code>crud</code> y <code>security</code>.</li> <li>Devuelve el objeto <code>models.User</code> reci\u00e9n creado.</li> </ul> </li> <li>Respuesta (<code>api/v1/users.py</code>):<ul> <li>El endpoint recibe el objeto <code>models.User</code> del servicio.</li> <li>Gracias a <code>response_model=schemas.user.UserRead</code>, FastAPI autom\u00e1ticamente convierte el objeto del ORM al esquema Pydantic, filtrando campos sensibles como la contrase\u00f1a.</li> <li>Env\u00eda la respuesta JSON al cliente con un c\u00f3digo <code>201 Created</code>.</li> </ul> </li> </ol> <p>Adoptar esta estructura desde el principio te dar\u00e1 una base s\u00f3lida, testable y mantenible que puede crecer para soportar una plataforma de cualquier tama\u00f1o.</p>"},{"location":"root_2_configuration_celery-health-checks/","title":"\ud83c\udfe5 Health Checks de Celery","text":""},{"location":"root_2_configuration_celery-health-checks/#resumen","title":"\ud83d\udccb Resumen","text":"<p>Se han agregado health checks a los servicios de Celery Worker y Celery Beat para mejorar la confiabilidad y observabilidad del sistema.</p>"},{"location":"root_2_configuration_celery-health-checks/#health-checks-implementados","title":"\u2705 Health Checks Implementados","text":""},{"location":"root_2_configuration_celery-health-checks/#1-celery-worker","title":"1. Celery Worker","text":"<p>Comando de verificaci\u00f3n:</p> <pre><code>celery -A app.tasks.celery_app inspect ping -d celery@$HOSTNAME\n</code></pre> <p>Configuraci\u00f3n:</p> <pre><code>healthcheck:\n  test:\n    [\n      \"CMD-SHELL\",\n      \"celery -A app.tasks.celery_app inspect ping -d celery@$$HOSTNAME || exit 1\",\n    ]\n  interval: 30s # Verifica cada 30 segundos\n  timeout: 10s # Timeout de 10 segundos\n  start_period: 40s # Espera 40s antes de empezar (tiempo de inicio)\n  retries: 3 # 3 reintentos antes de marcar como unhealthy\n</code></pre> <p>\u00bfQu\u00e9 verifica?</p> <ul> <li>\u2705 Worker est\u00e1 respondiendo a comandos de control</li> <li>\u2705 Conexi\u00f3n con Redis funciona</li> <li>\u2705 Worker puede procesar tareas</li> </ul> <p>Estados posibles:</p> <ul> <li><code>healthy</code>: Worker est\u00e1 operativo y respondiendo</li> <li><code>starting</code>: Worker est\u00e1 iniciando (primeros 40s)</li> <li><code>unhealthy</code>: Worker no responde despu\u00e9s de 3 intentos</li> </ul>"},{"location":"root_2_configuration_celery-health-checks/#2-celery-beat","title":"2. Celery Beat","text":"<p>Comando de verificaci\u00f3n:</p> <pre><code>pgrep -f 'celery.*beat'\n</code></pre> <p>Configuraci\u00f3n:</p> <pre><code>healthcheck:\n  test: [\"CMD-SHELL\", \"pgrep -f 'celery.*beat' || exit 1\"]\n  interval: 30s # Verifica cada 30 segundos\n  timeout: 10s # Timeout de 10 segundos\n  start_period: 30s # Espera 30s antes de empezar\n  retries: 3 # 3 reintentos antes de marcar como unhealthy\n</code></pre> <p>\u00bfQu\u00e9 verifica?</p> <ul> <li>\u2705 Proceso de Celery Beat est\u00e1 corriendo</li> <li>\u2705 Scheduler est\u00e1 activo</li> </ul> <p>Estados posibles:</p> <ul> <li><code>healthy</code>: Beat est\u00e1 corriendo</li> <li><code>starting</code>: Beat est\u00e1 iniciando (primeros 30s)</li> <li><code>unhealthy</code>: Proceso no existe o est\u00e1 colgado</li> </ul>"},{"location":"root_2_configuration_celery-health-checks/#como-usar","title":"\ud83d\ude80 C\u00f3mo Usar","text":""},{"location":"root_2_configuration_celery-health-checks/#ver-estado-de-health-checks","title":"Ver Estado de Health Checks","text":""},{"location":"root_2_configuration_celery-health-checks/#opcion-1-script-automatico-recomendado","title":"Opci\u00f3n 1: Script Autom\u00e1tico (Recomendado)","text":"<pre><code># Desarrollo\n./check-health.sh dev\n\n# Producci\u00f3n\n./check-health.sh prod\n</code></pre> <p>Output ejemplo:</p> <pre><code>\ud83c\udfe5 Verificando estado de salud de servicios (dev)\n\n\ud83d\udcca Estado de los contenedores:\n...\n\n\ud83d\udd0d Health checks detallados:\n\n  \u2705 db: Healthy\n  \u2705 redis: Running (sin healthcheck)\n  \u2705 minio: Healthy\n  \u2705 backend: Healthy\n  \u2705 celery_worker: Healthy\n  \u2705 celery_beat: Healthy\n  \u2705 frontend: Running (sin healthcheck)\n  \u2705 playwright: Healthy\n\n\ud83d\udcdd Resumen:\n  \u2705 Healthy: 8\n  \u23f3 Starting: 0\n  \u274c Unhealthy: 0\n  \u23f8\ufe0f  Stopped: 0\n\n\u2705 Todos los servicios est\u00e1n saludables!\n</code></pre>"},{"location":"root_2_configuration_celery-health-checks/#opcion-2-docker-compose","title":"Opci\u00f3n 2: Docker Compose","text":"<pre><code># Ver estado de todos los servicios\ndocker compose -f docker-compose.dev.yml ps\n\n# Ver health de un servicio espec\u00edfico\ndocker inspect &lt;container-id&gt; --format='{{.State.Health.Status}}'\n</code></pre>"},{"location":"root_2_configuration_celery-health-checks/#opcion-3-docker-ps","title":"Opci\u00f3n 3: Docker PS","text":"<pre><code># Ver todos los contenedores con su estado de salud\ndocker ps --format \"table {{.Names}}\\t{{.Status}}\"\n</code></pre> <p>Output ejemplo:</p> <pre><code>NAMES                          STATUS\ncv-builder-celery_worker-1     Up 5 minutes (healthy)\ncv-builder-celery_beat-1       Up 5 minutes (healthy)\ncv-builder-backend-1           Up 5 minutes (healthy)\n</code></pre>"},{"location":"root_2_configuration_celery-health-checks/#debugging-health-checks","title":"\ud83d\udd0d Debugging Health Checks","text":""},{"location":"root_2_configuration_celery-health-checks/#ver-logs-del-health-check","title":"Ver Logs del Health Check","text":"<pre><code># Ver \u00faltimos logs del healthcheck\ndocker inspect &lt;container-id&gt; --format='{{range .State.Health.Log}}{{.Output}}{{end}}'\n\n# Ver log completo del healthcheck\ndocker inspect &lt;container-id&gt; | jq '.[0].State.Health.Log'\n</code></pre>"},{"location":"root_2_configuration_celery-health-checks/#ejecutar-health-check-manualmente","title":"Ejecutar Health Check Manualmente","text":""},{"location":"root_2_configuration_celery-health-checks/#celery-worker","title":"Celery Worker","text":"<pre><code># Entrar al contenedor\ndocker compose -f docker-compose.dev.yml exec celery_worker bash\n\n# Ejecutar el comando de health check manualmente\ncelery -A app.tasks.celery_app inspect ping\n\n# Verificar workers activos\ncelery -A app.tasks.celery_app inspect active\n\n# Ver estad\u00edsticas\ncelery -A app.tasks.celery_app inspect stats\n</code></pre>"},{"location":"root_2_configuration_celery-health-checks/#celery-beat","title":"Celery Beat","text":"<pre><code># Entrar al contenedor\ndocker compose -f docker-compose.dev.yml exec celery_beat bash\n\n# Verificar que el proceso est\u00e1 corriendo\npgrep -f 'celery.*beat'\n\n# Ver el proceso completo\nps aux | grep celery\n\n# Ver logs en tiempo real\ntail -f /var/log/celery-beat.log  # Si existe\n</code></pre>"},{"location":"root_2_configuration_celery-health-checks/#troubleshooting","title":"\ud83d\udc1b Troubleshooting","text":""},{"location":"root_2_configuration_celery-health-checks/#celery-worker-unhealthy","title":"Celery Worker Unhealthy","text":"<p>S\u00edntomas:</p> <pre><code>docker ps\n# celery_worker-1  Up 2 minutes (unhealthy)\n</code></pre> <p>Posibles causas y soluciones:</p> <ol> <li>Redis no disponible:</li> </ol> <pre><code># Verificar que Redis est\u00e1 corriendo\ndocker compose -f docker-compose.dev.yml ps redis\n\n# Ver logs de Redis\ndocker compose -f docker-compose.dev.yml logs redis\n\n# Reiniciar Redis si es necesario\ndocker compose -f docker-compose.dev.yml restart redis\n</code></pre> <ol> <li>Worker bloqueado procesando tarea:</li> </ol> <pre><code># Ver tareas activas\ndocker compose -f docker-compose.dev.yml exec celery_worker \\\n  celery -A app.tasks.celery_app inspect active\n\n# Ver tareas reservadas\ndocker compose -f docker-compose.dev.yml exec celery_worker \\\n  celery -A app.tasks.celery_app inspect reserved\n\n# Revocar tareas problem\u00e1ticas\ndocker compose -f docker-compose.dev.yml exec celery_worker \\\n  celery -A app.tasks.celery_app control revoke &lt;task-id&gt;\n</code></pre> <ol> <li>Memoria/CPU insuficiente:</li> </ol> <pre><code># Ver uso de recursos\ndocker stats celery_worker-1\n\n# Si hay problemas de memoria, reiniciar\ndocker compose -f docker-compose.dev.yml restart celery_worker\n</code></pre> <ol> <li>Error en el c\u00f3digo:</li> </ol> <pre><code># Ver logs del worker\ndocker compose -f docker-compose.dev.yml logs celery_worker --tail=100\n\n# Si hay errores de importaci\u00f3n o configuraci\u00f3n, reconstruir\ndocker compose -f docker-compose.dev.yml build celery_worker\ndocker compose -f docker-compose.dev.yml up -d celery_worker\n</code></pre>"},{"location":"root_2_configuration_celery-health-checks/#celery-beat-unhealthy","title":"Celery Beat Unhealthy","text":"<p>S\u00edntomas:</p> <pre><code>docker ps\n# celery_beat-1  Up 2 minutes (unhealthy)\n</code></pre> <p>Posibles causas y soluciones:</p> <ol> <li>Proceso colgado:</li> </ol> <pre><code># Ver logs\ndocker compose -f docker-compose.dev.yml logs celery_beat --tail=50\n\n# Reiniciar\ndocker compose -f docker-compose.dev.yml restart celery_beat\n</code></pre> <ol> <li>Archivo de schedule corrupto:</li> </ol> <pre><code># Entrar al contenedor\ndocker compose -f docker-compose.dev.yml exec celery_beat bash\n\n# Eliminar schedule file y reiniciar\nrm -f celerybeat-schedule.db\nexit\n\n# Reiniciar beat\ndocker compose -f docker-compose.dev.yml restart celery_beat\n</code></pre> <ol> <li>Permisos en directorio:</li> </ol> <pre><code># Verificar permisos\ndocker compose -f docker-compose.dev.yml exec celery_beat ls -la\n\n# Si hay problemas, corregir permisos y reiniciar\ndocker compose -f docker-compose.dev.yml restart celery_beat\n</code></pre>"},{"location":"root_2_configuration_celery-health-checks/#configuracion-avanzada","title":"\ud83d\udd27 Configuraci\u00f3n Avanzada","text":""},{"location":"root_2_configuration_celery-health-checks/#ajustar-timeouts","title":"Ajustar Timeouts","text":"<p>Si tus tareas son pesadas y el worker necesita m\u00e1s tiempo:</p> <pre><code># docker-compose.dev.yml\ncelery_worker:\n  healthcheck:\n    interval: 60s # Verificar cada minuto\n    timeout: 30s # Timeout m\u00e1s largo\n    start_period: 60s # M\u00e1s tiempo para iniciar\n    retries: 5 # M\u00e1s reintentos\n</code></pre>"},{"location":"root_2_configuration_celery-health-checks/#deshabilitar-health-check-temporalmente","title":"Deshabilitar Health Check Temporalmente","text":"<p>Durante debugging:</p> <pre><code>celery_worker:\n  healthcheck:\n    disable: true\n</code></pre> <p>O desde l\u00ednea de comandos:</p> <pre><code>docker compose -f docker-compose.dev.yml up -d --no-healthcheck\n</code></pre>"},{"location":"root_2_configuration_celery-health-checks/#health-check-con-autorestart","title":"Health Check con Autorestart","text":"<p>Los servicios ya tienen <code>restart: unless-stopped</code>, lo que significa que si el health check falla repetidamente, Docker reiniciar\u00e1 el contenedor autom\u00e1ticamente.</p> <p>Para verificar reintentos:</p> <pre><code># Ver n\u00famero de reinicios\ndocker ps --format \"table {{.Names}}\\t{{.Status}}\"\n\n# Si ves \"Restarting\", hay problemas\n# Ver por qu\u00e9 est\u00e1 reiniciando\ndocker compose -f docker-compose.dev.yml logs celery_worker --tail=100\n</code></pre>"},{"location":"root_2_configuration_celery-health-checks/#monitoreo-con-health-checks","title":"\ud83d\udcca Monitoreo con Health Checks","text":""},{"location":"root_2_configuration_celery-health-checks/#integracion-con-monitoring-tools","title":"Integraci\u00f3n con Monitoring Tools","text":""},{"location":"root_2_configuration_celery-health-checks/#prometheus","title":"Prometheus","text":"<pre><code># docker-compose.monitoring.yml\nservices:\n  prometheus:\n    # ...\n    configs:\n      - source: prometheus_config\n        target: /etc/prometheus/prometheus.yml\n</code></pre> <pre><code># prometheus.yml\nscrape_configs:\n  - job_name: \"docker\"\n    static_configs:\n      - targets: [\"docker-exporter:9323\"]\n</code></pre>"},{"location":"root_2_configuration_celery-health-checks/#grafana-dashboard","title":"Grafana Dashboard","text":"<p>Crear dashboard con m\u00e9tricas:</p> <ul> <li>Container health status</li> <li>Health check failures</li> <li>Restart count</li> <li>Uptime</li> </ul>"},{"location":"root_2_configuration_celery-health-checks/#scripts-de-monitoreo","title":"Scripts de Monitoreo","text":""},{"location":"root_2_configuration_celery-health-checks/#check-periodico-con-notificaciones","title":"Check Peri\u00f3dico con Notificaciones","text":"<pre><code>#!/bin/bash\n# check-health-cron.sh\n\n./check-health.sh dev &gt; /dev/null 2&gt;&amp;1\nSTATUS=$?\n\nif [ $STATUS -ne 0 ]; then\n    # Enviar notificaci\u00f3n (ejemplo con curl a Slack)\n    curl -X POST -H 'Content-type: application/json' \\\n      --data '{\"text\":\"\u26a0\ufe0f Celery services unhealthy!\"}' \\\n      YOUR_SLACK_WEBHOOK_URL\nfi\n</code></pre> <p>Agregar a crontab:</p> <pre><code># Verificar cada 5 minutos\n*/5 * * * * /path/to/check-health-cron.sh\n</code></pre>"},{"location":"root_2_configuration_celery-health-checks/#referencias","title":"\ud83d\udcda Referencias","text":"<ul> <li>Docker Health Checks</li> <li>Celery Monitoring</li> <li>Celery Management</li> </ul>"},{"location":"root_2_configuration_celery-health-checks/#mejores-practicas","title":"\ud83c\udfaf Mejores Pr\u00e1cticas","text":"<ol> <li>\u2705 Siempre usar health checks en servicios cr\u00edticos</li> <li>\u2705 Monitorear logs regularmente con <code>./check-health.sh</code></li> <li>\u2705 Configurar alertas para servicios unhealthy en producci\u00f3n</li> <li>\u2705 Ajustar timeouts seg\u00fan carga de trabajo</li> <li>\u2705 Usar el script <code>check-health.sh</code> antes de deployments</li> <li>\u2705 Verificar health despu\u00e9s de cambios en c\u00f3digo</li> <li>\u2705 Documentar comportamientos anormales</li> </ol>"},{"location":"root_2_configuration_celery-health-checks/#comandos-utiles-rapidos","title":"\ud83d\udca1 Comandos \u00datiles R\u00e1pidos","text":"<pre><code># Ver estado general\n./check-health.sh dev\n\n# Reiniciar solo Celery services\ndocker compose -f docker-compose.dev.yml restart celery_worker celery_beat\n\n# Ver logs en tiempo real\ndocker compose -f docker-compose.dev.yml logs -f celery_worker celery_beat\n\n# Verificar tareas activas\ndocker compose -f docker-compose.dev.yml exec celery_worker \\\n  celery -A app.tasks.celery_app inspect active\n\n# Ver workers conectados\ndocker compose -f docker-compose.dev.yml exec celery_worker \\\n  celery -A app.tasks.celery_app inspect ping\n\n# Limpiar y reiniciar todo\ndocker compose -f docker-compose.dev.yml down\ndocker compose -f docker-compose.dev.yml up -d\n./check-health.sh dev\n</code></pre>"},{"location":"root_2_configuration_deployment/","title":"FastAPI Project - Deployment","text":"<p>You can deploy the project using Docker Compose to a remote server.</p> <p>This project expects you to have a Traefik proxy handling communication to the outside world and HTTPS certificates.</p> <p>You can use CI/CD (continuous integration and continuous deployment) systems to deploy automatically, there are already configurations to do it with GitHub Actions.</p> <p>But you have to configure a couple things first. \ud83e\udd13</p>"},{"location":"root_2_configuration_deployment/#preparation","title":"Preparation","text":"<ul> <li>Have a remote server ready and available.</li> <li>Configure the DNS records of your domain to point to the IP of the server you just created.</li> <li>Configure a wildcard subdomain for your domain, so that you can have multiple subdomains for different services, e.g. <code>*.fastapi-project.example.com</code>. This will be useful for accessing different components, like <code>dashboard.fastapi-project.example.com</code>, <code>api.fastapi-project.example.com</code>, <code>traefik.fastapi-project.example.com</code>, <code>adminer.fastapi-project.example.com</code>, etc. And also for <code>staging</code>, like <code>dashboard.staging.fastapi-project.example.com</code>, <code>adminer.staging.fastapi-project.example.com</code>, etc.</li> <li>Install and configure Docker on the remote server (Docker Engine, not Docker Desktop).</li> </ul>"},{"location":"root_2_configuration_deployment/#public-traefik","title":"Public Traefik","text":"<p>We need a Traefik proxy to handle incoming connections and HTTPS certificates.</p> <p>You need to do these next steps only once.</p>"},{"location":"root_2_configuration_deployment/#traefik-docker-compose","title":"Traefik Docker Compose","text":"<ul> <li>Create a remote directory to store your Traefik Docker Compose file:</li> </ul> <pre><code>mkdir -p /root/code/traefik-public/\n</code></pre> <p>Copy the Traefik Docker Compose file to your server. You could do it by running the command <code>rsync</code> in your local terminal:</p> <pre><code>rsync -a docker-compose.traefik.yml root@your-server.example.com:/root/code/traefik-public/\n</code></pre>"},{"location":"root_2_configuration_deployment/#traefik-public-network","title":"Traefik Public Network","text":"<p>This Traefik will expect a Docker \"public network\" named <code>traefik-public</code> to communicate with your stack(s).</p> <p>This way, there will be a single public Traefik proxy that handles the communication (HTTP and HTTPS) with the outside world, and then behind that, you could have one or more stacks with different domains, even if they are on the same single server.</p> <p>To create a Docker \"public network\" named <code>traefik-public</code> run the following command in your remote server:</p> <pre><code>docker network create traefik-public\n</code></pre>"},{"location":"root_2_configuration_deployment/#traefik-environment-variables","title":"Traefik Environment Variables","text":"<p>The Traefik Docker Compose file expects some environment variables to be set in your terminal before starting it. You can do it by running the following commands in your remote server.</p> <ul> <li>Create the username for HTTP Basic Auth, e.g.:</li> </ul> <pre><code>export USERNAME=admin\n</code></pre> <ul> <li>Create an environment variable with the password for HTTP Basic Auth, e.g.:</li> </ul> <pre><code>export PASSWORD=changethis\n</code></pre> <ul> <li>Use openssl to generate the \"hashed\" version of the password for HTTP Basic Auth and store it in an environment variable:</li> </ul> <pre><code>export HASHED_PASSWORD=$(openssl passwd -apr1 $PASSWORD)\n</code></pre> <p>To verify that the hashed password is correct, you can print it:</p> <pre><code>echo $HASHED_PASSWORD\n</code></pre> <ul> <li>Create an environment variable with the domain name for your server, e.g.:</li> </ul> <pre><code>export DOMAIN=fastapi-project.example.com\n</code></pre> <ul> <li>Create an environment variable with the email for Let's Encrypt, e.g.:</li> </ul> <pre><code>export EMAIL=admin@example.com\n</code></pre> <p>Note: you need to set a different email, an email <code>@example.com</code> won't work.</p>"},{"location":"root_2_configuration_deployment/#start-the-traefik-docker-compose","title":"Start the Traefik Docker Compose","text":"<p>Go to the directory where you copied the Traefik Docker Compose file in your remote server:</p> <pre><code>cd /root/code/traefik-public/\n</code></pre> <p>Now with the environment variables set and the <code>docker-compose.traefik.yml</code> in place, you can start the Traefik Docker Compose running the following command:</p> <pre><code>docker compose -f docker-compose.traefik.yml up -d\n</code></pre>"},{"location":"root_2_configuration_deployment/#deploy-the-fastapi-project","title":"Deploy the FastAPI Project","text":"<p>Now that you have Traefik in place you can deploy your FastAPI project with Docker Compose.</p> <p>Note: You might want to jump ahead to the section about Continuous Deployment with GitHub Actions.</p>"},{"location":"root_2_configuration_deployment/#environment-variables","title":"Environment Variables","text":"<p>You need to set some environment variables first.</p> <p>Set the <code>ENVIRONMENT</code>, by default <code>local</code> (for development), but when deploying to a server you would put something like <code>staging</code> or <code>production</code>:</p> <pre><code>export ENVIRONMENT=production\n</code></pre> <p>Set the <code>DOMAIN</code>, by default <code>localhost</code> (for development), but when deploying you would use your own domain, for example:</p> <pre><code>export DOMAIN=fastapi-project.example.com\n</code></pre> <p>You can set several variables, like:</p> <ul> <li><code>PROJECT_NAME</code>: The name of the project, used in the API for the docs and emails.</li> <li><code>STACK_NAME</code>: The name of the stack used for Docker Compose labels and project name, this should be different for <code>staging</code>, <code>production</code>, etc. You could use the same domain replacing dots with dashes, e.g. <code>fastapi-project-example-com</code> and <code>staging-fastapi-project-example-com</code>.</li> <li><code>BACKEND_CORS_ORIGINS</code>: A list of allowed CORS origins separated by commas.</li> <li><code>SECRET_KEY</code>: The secret key for the FastAPI project, used to sign tokens.</li> <li><code>FIRST_SUPERUSER</code>: The email of the first superuser, this superuser will be the one that can create new users.</li> <li><code>FIRST_SUPERUSER_PASSWORD</code>: The password of the first superuser.</li> <li><code>SMTP_HOST</code>: The SMTP server host to send emails, this would come from your email provider (E.g. Mailgun, Sparkpost, Sendgrid, etc).</li> <li><code>SMTP_USER</code>: The SMTP server user to send emails.</li> <li><code>SMTP_PASSWORD</code>: The SMTP server password to send emails.</li> <li><code>EMAILS_FROM_EMAIL</code>: The email account to send emails from.</li> <li><code>POSTGRES_SERVER</code>: The hostname of the PostgreSQL server. You can leave the default of <code>db</code>, provided by the same Docker Compose. You normally wouldn't need to change this unless you are using a third-party provider.</li> <li><code>POSTGRES_PORT</code>: The port of the PostgreSQL server. You can leave the default. You normally wouldn't need to change this unless you are using a third-party provider.</li> <li><code>POSTGRES_PASSWORD</code>: The Postgres password.</li> <li><code>POSTGRES_USER</code>: The Postgres user, you can leave the default.</li> <li><code>POSTGRES_DB</code>: The database name to use for this application. You can leave the default of <code>app</code>.</li> <li><code>SENTRY_DSN</code>: The DSN for Sentry, if you are using it.</li> </ul>"},{"location":"root_2_configuration_deployment/#github-actions-environment-variables","title":"GitHub Actions Environment Variables","text":"<p>There are some environment variables only used by GitHub Actions that you can configure:</p> <ul> <li><code>LATEST_CHANGES</code>: Used by the GitHub Action latest-changes to automatically add release notes based on the PRs merged. It's a personal access token, read the docs for details.</li> <li><code>SMOKESHOW_AUTH_KEY</code>: Used to handle and publish the code coverage using Smokeshow, follow their instructions to create a (free) Smokeshow key.</li> </ul>"},{"location":"root_2_configuration_deployment/#generate-secret-keys","title":"Generate secret keys","text":"<p>Some environment variables in the <code>.env</code> file have a default value of <code>changethis</code>.</p> <p>You have to change them with a secret key, to generate secret keys you can run the following command:</p> <pre><code>python -c \"import secrets; print(secrets.token_urlsafe(32))\"\n</code></pre> <p>Copy the content and use that as password / secret key. And run that again to generate another secure key.</p>"},{"location":"root_2_configuration_deployment/#deploy-with-docker-compose","title":"Deploy with Docker Compose","text":"<p>With the environment variables in place, you can deploy with Docker Compose:</p> <pre><code>docker compose -f docker-compose.yml up -d\n</code></pre> <p>For production you wouldn't want to have the overrides in <code>docker-compose.override.yml</code>, that's why we explicitly specify <code>docker-compose.yml</code> as the file to use.</p>"},{"location":"root_2_configuration_deployment/#continuous-deployment-cd","title":"Continuous Deployment (CD)","text":"<p>You can use GitHub Actions to deploy your project automatically. \ud83d\ude0e</p> <p>You can have multiple environment deployments.</p> <p>There are already two environments configured, <code>staging</code> and <code>production</code>. \ud83d\ude80</p>"},{"location":"root_2_configuration_deployment/#install-github-actions-runner","title":"Install GitHub Actions Runner","text":"<ul> <li>On your remote server, create a user for your GitHub Actions:</li> </ul> <pre><code>sudo adduser github\n</code></pre> <ul> <li>Add Docker permissions to the <code>github</code> user:</li> </ul> <pre><code>sudo usermod -aG docker github\n</code></pre> <ul> <li>Temporarily switch to the <code>github</code> user:</li> </ul> <pre><code>sudo su - github\n</code></pre> <ul> <li>Go to the <code>github</code> user's home directory:</li> </ul> <pre><code>cd\n</code></pre> <ul> <li> <p>Install a GitHub Action self-hosted runner following the official guide.</p> </li> <li> <p>When asked about labels, add a label for the environment, e.g. <code>production</code>. You can also add labels later.</p> </li> </ul> <p>After installing, the guide would tell you to run a command to start the runner. Nevertheless, it would stop once you terminate that process or if your local connection to your server is lost.</p> <p>To make sure it runs on startup and continues running, you can install it as a service. To do that, exit the <code>github</code> user and go back to the <code>root</code> user:</p> <pre><code>exit\n</code></pre> <p>After you do it, you will be on the previous user again. And you will be on the previous directory, belonging to that user.</p> <p>Before being able to go the <code>github</code> user directory, you need to become the <code>root</code> user (you might already be):</p> <pre><code>sudo su\n</code></pre> <ul> <li>As the <code>root</code> user, go to the <code>actions-runner</code> directory inside of the <code>github</code> user's home directory:</li> </ul> <pre><code>cd /home/github/actions-runner\n</code></pre> <ul> <li>Install the self-hosted runner as a service with the user <code>github</code>:</li> </ul> <pre><code>./svc.sh install github\n</code></pre> <ul> <li>Start the service:</li> </ul> <pre><code>./svc.sh start\n</code></pre> <ul> <li>Check the status of the service:</li> </ul> <pre><code>./svc.sh status\n</code></pre> <p>You can read more about it in the official guide: Configuring the self-hosted runner application as a service.</p>"},{"location":"root_2_configuration_deployment/#set-secrets","title":"Set Secrets","text":"<p>On your repository, configure secrets for the environment variables you need, the same ones described above, including <code>SECRET_KEY</code>, etc. Follow the official GitHub guide for setting repository secrets.</p> <p>The current Github Actions workflows expect these secrets:</p> <ul> <li><code>DOMAIN_PRODUCTION</code></li> <li><code>DOMAIN_STAGING</code></li> <li><code>STACK_NAME_PRODUCTION</code></li> <li><code>STACK_NAME_STAGING</code></li> <li><code>EMAILS_FROM_EMAIL</code></li> <li><code>FIRST_SUPERUSER</code></li> <li><code>FIRST_SUPERUSER_PASSWORD</code></li> <li><code>POSTGRES_PASSWORD</code></li> <li><code>SECRET_KEY</code></li> <li><code>LATEST_CHANGES</code></li> <li><code>SMOKESHOW_AUTH_KEY</code></li> </ul>"},{"location":"root_2_configuration_deployment/#github-action-deployment-workflows","title":"GitHub Action Deployment Workflows","text":"<p>There are GitHub Action workflows in the <code>.github/workflows</code> directory already configured for deploying to the environments (GitHub Actions runners with the labels):</p> <ul> <li><code>staging</code>: after pushing (or merging) to the branch <code>master</code>.</li> <li><code>production</code>: after publishing a release.</li> </ul> <p>If you need to add extra environments you could use those as a starting point.</p>"},{"location":"root_2_configuration_deployment/#urls","title":"URLs","text":"<p>Replace <code>fastapi-project.example.com</code> with your domain.</p>"},{"location":"root_2_configuration_deployment/#main-traefik-dashboard","title":"Main Traefik Dashboard","text":"<p>Traefik UI: <code>https://traefik.fastapi-project.example.com</code></p>"},{"location":"root_2_configuration_deployment/#production","title":"Production","text":"<p>Frontend: <code>https://dashboard.fastapi-project.example.com</code></p> <p>Backend API docs: <code>https://api.fastapi-project.example.com/docs</code></p> <p>Backend API base URL: <code>https://api.fastapi-project.example.com</code></p> <p>Adminer: <code>https://adminer.fastapi-project.example.com</code></p>"},{"location":"root_2_configuration_deployment/#staging","title":"Staging","text":"<p>Frontend: <code>https://dashboard.staging.fastapi-project.example.com</code></p> <p>Backend API docs: <code>https://api.staging.fastapi-project.example.com/docs</code></p> <p>Backend API base URL: <code>https://api.staging.fastapi-project.example.com</code></p> <p>Adminer: <code>https://adminer.staging.fastapi-project.example.com</code></p>"},{"location":"root_2_configuration_development/","title":"FastAPI Project - Development","text":""},{"location":"root_2_configuration_development/#docker-compose","title":"Docker Compose","text":"<ul> <li>Start the local stack with Docker Compose:</li> </ul> <pre><code>docker compose watch\n</code></pre> <ul> <li>Now you can open your browser and interact with these URLs:</li> </ul> <p>Frontend, built with Docker, with routes handled based on the path: http://localhost:5173</p> <p>Backend, JSON based web API based on OpenAPI: http://localhost:8000</p> <p>Automatic interactive documentation with Swagger UI (from the OpenAPI backend): http://localhost:8000/docs</p> <p>Adminer, database web administration: http://localhost:8080</p> <p>Traefik UI, to see how the routes are being handled by the proxy: http://localhost:8090</p> <p>Note: The first time you start your stack, it might take a minute for it to be ready. While the backend waits for the database to be ready and configures everything. You can check the logs to monitor it.</p> <p>To check the logs, run (in another terminal):</p> <pre><code>docker compose logs\n</code></pre> <p>To check the logs of a specific service, add the name of the service, e.g.:</p> <pre><code>docker compose logs backend\n</code></pre>"},{"location":"root_2_configuration_development/#local-development","title":"Local Development","text":"<p>The Docker Compose files are configured so that each of the services is available in a different port in <code>localhost</code>.</p> <p>For the backend and frontend, they use the same port that would be used by their local development server, so, the backend is at <code>http://localhost:8000</code> and the frontend at <code>http://localhost:5173</code>.</p> <p>This way, you could turn off a Docker Compose service and start its local development service, and everything would keep working, because it all uses the same ports.</p> <p>For example, you can stop that <code>frontend</code> service in the Docker Compose, in another terminal, run:</p> <pre><code>docker compose stop frontend\n</code></pre> <p>And then start the local frontend development server:</p> <pre><code>cd frontend\nnpm run dev\n</code></pre> <p>Or you could stop the <code>backend</code> Docker Compose service:</p> <pre><code>docker compose stop backend\n</code></pre> <p>And then you can run the local development server for the backend:</p> <pre><code>cd backend\nfastapi dev app/main.py\n</code></pre>"},{"location":"root_2_configuration_development/#docker-compose-in-localhosttiangolocom","title":"Docker Compose in <code>localhost.tiangolo.com</code>","text":"<p>When you start the Docker Compose stack, it uses <code>localhost</code> by default, with different ports for each service (backend, frontend, adminer, etc).</p> <p>When you deploy it to production (or staging), it will deploy each service in a different subdomain, like <code>api.example.com</code> for the backend and <code>dashboard.example.com</code> for the frontend.</p> <p>In the guide about deployment you can read about Traefik, the configured proxy. That's the component in charge of transmitting traffic to each service based on the subdomain.</p> <p>If you want to test that it's all working locally, you can edit the local <code>.env</code> file, and change:</p> <pre><code>DOMAIN=localhost.tiangolo.com\n</code></pre> <p>That will be used by the Docker Compose files to configure the base domain for the services.</p> <p>Traefik will use this to transmit traffic at <code>api.localhost.tiangolo.com</code> to the backend, and traffic at <code>dashboard.localhost.tiangolo.com</code> to the frontend.</p> <p>The domain <code>localhost.tiangolo.com</code> is a special domain that is configured (with all its subdomains) to point to <code>127.0.0.1</code>. This way you can use that for your local development.</p> <p>After you update it, run again:</p> <pre><code>docker compose watch\n</code></pre> <p>When deploying, for example in production, the main Traefik is configured outside of the Docker Compose files. For local development, there's an included Traefik in <code>docker-compose.override.yml</code>, just to let you test that the domains work as expected, for example with <code>api.localhost.tiangolo.com</code> and <code>dashboard.localhost.tiangolo.com</code>.</p>"},{"location":"root_2_configuration_development/#docker-compose-files-and-env-vars","title":"Docker Compose files and env vars","text":"<p>There is a main <code>docker-compose.yml</code> file with all the configurations that apply to the whole stack, it is used automatically by <code>docker compose</code>.</p> <p>And there's also a <code>docker-compose.override.yml</code> with overrides for development, for example to mount the source code as a volume. It is used automatically by <code>docker compose</code> to apply overrides on top of <code>docker-compose.yml</code>.</p> <p>These Docker Compose files use the <code>.env</code> file containing configurations to be injected as environment variables in the containers.</p> <p>They also use some additional configurations taken from environment variables set in the scripts before calling the <code>docker compose</code> command.</p> <p>After changing variables, make sure you restart the stack:</p> <pre><code>docker compose watch\n</code></pre>"},{"location":"root_2_configuration_development/#the-env-file","title":"The .env file","text":"<p>The <code>.env</code> file is the one that contains all your configurations, generated keys and passwords, etc.</p> <p>Depending on your workflow, you could want to exclude it from Git, for example if your project is public. In that case, you would have to make sure to set up a way for your CI tools to obtain it while building or deploying your project.</p> <p>One way to do it could be to add each environment variable to your CI/CD system, and updating the <code>docker-compose.yml</code> file to read that specific env var instead of reading the <code>.env</code> file.</p>"},{"location":"root_2_configuration_development/#pre-commits-and-code-linting","title":"Pre-commits and code linting","text":"<p>we are using a tool called pre-commit for code linting and formatting.</p> <p>When you install it, it runs right before making a commit in git. This way it ensures that the code is consistent and formatted even before it is committed.</p> <p>You can find a file <code>.pre-commit-config.yaml</code> with configurations at the root of the project.</p>"},{"location":"root_2_configuration_development/#install-pre-commit-to-run-automatically","title":"Install pre-commit to run automatically","text":"<p><code>pre-commit</code> is already part of the dependencies of the project, but you could also install it globally if you prefer to, following the official pre-commit docs.</p> <p>After having the <code>pre-commit</code> tool installed and available, you need to \"install\" it in the local repository, so that it runs automatically before each commit.</p> <p>Using <code>uv</code>, you could do it with:</p> <pre><code>\u276f uv run pre-commit install\npre-commit installed at .git/hooks/pre-commit\n</code></pre> <p>Now whenever you try to commit, e.g. with:</p> <pre><code>git commit\n</code></pre> <p>...pre-commit will run and check and format the code you are about to commit, and will ask you to add that code (stage it) with git again before committing.</p> <p>Then you can <code>git add</code> the modified/fixed files again and now you can commit.</p>"},{"location":"root_2_configuration_development/#running-pre-commit-hooks-manually","title":"Running pre-commit hooks manually","text":"<p>you can also run <code>pre-commit</code> manually on all the files, you can do it using <code>uv</code> with:</p> <pre><code>\u276f uv run pre-commit run --all-files\ncheck for added large files..............................................Passed\ncheck toml...............................................................Passed\ncheck yaml...............................................................Passed\nruff.....................................................................Passed\nruff-format..............................................................Passed\neslint...................................................................Passed\nprettier.................................................................Passed\n</code></pre>"},{"location":"root_2_configuration_development/#urls","title":"URLs","text":"<p>The production or staging URLs would use these same paths, but with your own domain.</p>"},{"location":"root_2_configuration_development/#development-urls","title":"Development URLs","text":"<p>Development URLs, for local development.</p> <p>Frontend: http://localhost:5173</p> <p>Backend: http://localhost:8000</p> <p>Automatic Interactive Docs (Swagger UI): http://localhost:8000/docs</p> <p>Automatic Alternative Docs (ReDoc): http://localhost:8000/redoc</p> <p>Adminer: http://localhost:8080</p> <p>Traefik UI: http://localhost:8090</p> <p>MailCatcher: http://localhost:1080</p>"},{"location":"root_2_configuration_development/#development-urls-with-localhosttiangolocom-configured","title":"Development URLs with <code>localhost.tiangolo.com</code> Configured","text":"<p>Development URLs, for local development.</p> <p>Frontend: http://dashboard.localhost.tiangolo.com</p> <p>Backend: http://api.localhost.tiangolo.com</p> <p>Automatic Interactive Docs (Swagger UI): http://api.localhost.tiangolo.com/docs</p> <p>Automatic Alternative Docs (ReDoc): http://api.localhost.tiangolo.com/redoc</p> <p>Adminer: http://localhost.tiangolo.com:8080</p> <p>Traefik UI: http://localhost.tiangolo.com:8090</p> <p>MailCatcher: http://localhost.tiangolo.com:1080</p>"},{"location":"root_2_configuration_docker-optimization/","title":"Optimizaci\u00f3n de Dockerfiles","text":""},{"location":"root_2_configuration_docker-optimization/#resumen-de-optimizaciones-aplicadas","title":"\ud83d\udccb Resumen de Optimizaciones Aplicadas","text":"<p>Todos los Dockerfiles han sido optimizados siguiendo las mejores pr\u00e1cticas de Docker para mejorar:</p> <ul> <li>Performance: Builds m\u00e1s r\u00e1pidos con mejor uso de cach\u00e9</li> <li>Seguridad: Usuario no-root, im\u00e1genes Alpine, reducci\u00f3n de superficie de ataque</li> <li>Tama\u00f1o: Im\u00e1genes m\u00e1s peque\u00f1as con multi-stage builds</li> <li>Confiabilidad: Health checks integrados</li> </ul>"},{"location":"root_2_configuration_docker-optimization/#backend-pythonfastapi","title":"\ud83c\udfaf Backend (Python/FastAPI)","text":""},{"location":"root_2_configuration_docker-optimization/#dockerfile-de-produccion","title":"Dockerfile de Producci\u00f3n","text":"<p>Mejoras aplicadas:</p> <ol> <li>Multi-stage build con 2 stages:</li> <li><code>builder</code>: Compila dependencias con herramientas de build</li> <li> <p><code>runtime</code>: Solo runtime dependencies, sin compiladores</p> </li> <li> <p>Seguridad:</p> </li> <li>Usuario no-root <code>appuser</code> (UID 1001)</li> <li>Solo dependencias de runtime en imagen final</li> <li> <p><code>PYTHONDONTWRITEBYTECODE=1</code> para evitar archivos .pyc</p> </li> <li> <p>Optimizaci\u00f3n:</p> </li> <li>Usa <code>--no-install-recommends</code> para paquetes m\u00ednimos</li> <li>Limpia cache de apt: <code>rm -rf /var/lib/apt/lists/*</code></li> <li> <p>Usa <code>uv sync --no-dev</code> para excluir dependencias de desarrollo</p> </li> <li> <p>Health check:</p> </li> </ol> <pre><code>HEALTHCHECK --interval=30s --timeout=10s --start-period=40s --retries=3 \\\n    CMD curl -f http://localhost:8000/api/v1/health || exit 1\n</code></pre> <ol> <li>Tama\u00f1o reducido:</li> <li>Imagen base: <code>python:3.12-slim</code> (~150MB vs ~1GB de python:3.12)</li> <li>Solo librer\u00edas runtime necesarias (libpq5 para PostgreSQL)</li> </ol>"},{"location":"root_2_configuration_docker-optimization/#dockerfiledev-desarrollo","title":"Dockerfile.dev (Desarrollo)","text":"<p>Caracter\u00edsticas:</p> <ol> <li>Hot-reload: Usa <code>fastapi dev</code> para auto-reload</li> <li>Dev dependencies: Incluye todas las dependencias de desarrollo</li> <li>Usuario no-root: <code>devuser</code> para desarrollo seguro</li> <li>Tools de desarrollo: Incluye git, curl para debugging</li> </ol> <p>Uso:</p> <pre><code>docker-compose -f docker-compose.dev.yml up backend\n</code></pre>"},{"location":"root_2_configuration_docker-optimization/#frontend-reactvite","title":"\ud83c\udf10 Frontend (React/Vite)","text":""},{"location":"root_2_configuration_docker-optimization/#dockerfile-de-produccion_1","title":"Dockerfile de Producci\u00f3n","text":"<p>Mejoras aplicadas:</p> <ol> <li>Multi-stage build optimizado con 3 stages:</li> <li><code>deps</code>: Dependencias de producci\u00f3n</li> <li><code>builder</code>: Build del frontend</li> <li> <p><code>runtime</code>: Nginx con assets est\u00e1ticos</p> </li> <li> <p>Im\u00e1genes Alpine:</p> </li> <li><code>node:20-alpine</code> (~180MB vs ~1GB de node:20)</li> <li><code>nginx:1.27-alpine</code> (~40MB vs ~150MB de nginx:1)</li> <li> <p>Resultado: Imagen final de ~50MB</p> </li> <li> <p>Cache optimization:</p> </li> </ol> <pre><code># Layer 1: package.json (cambia raramente)\nCOPY package*.json ./\nRUN npm ci\n\n# Layer 2: c\u00f3digo fuente (cambia frecuentemente)\nCOPY . .\nRUN npm run build\n</code></pre> <ol> <li>Seguridad:</li> <li>Usuario no-root <code>appuser</code></li> <li>Nginx corriendo como usuario no privilegiado</li> <li> <p>Permisos correctos en cache y logs</p> </li> <li> <p>Performance:</p> </li> <li><code>npm ci</code> en vez de <code>npm install</code> (m\u00e1s r\u00e1pido y reproducible)</li> <li><code>npm cache clean --force</code> para reducir tama\u00f1o</li> <li>Assets pre-comprimidos servidos por Nginx</li> </ol>"},{"location":"root_2_configuration_docker-optimization/#dockerfiledev-desarrollo_1","title":"Dockerfile.dev (Desarrollo)","text":"<p>Caracter\u00edsticas:</p> <ol> <li>Alpine-based: Imagen m\u00e1s ligera</li> <li>Hot Module Replacement (HMR): Vite dev server con hot-reload</li> <li>Usuario no-root: <code>nodeuser</code> para desarrollo</li> <li>Vol\u00famenes: Se monta c\u00f3digo fuente para desarrollo en tiempo real</li> </ol> <p>Uso:</p> <pre><code>docker-compose -f docker-compose.dev.yml up frontend\n</code></pre>"},{"location":"root_2_configuration_docker-optimization/#dockerignore-optimizados","title":"\ud83d\udce6 .dockerignore Optimizados","text":""},{"location":"root_2_configuration_docker-optimization/#backend","title":"Backend","text":"<p>Excluye:</p> <ul> <li><code>__pycache__/</code>, <code>.venv/</code>, archivos compilados</li> <li>Tests, coverage, documentaci\u00f3n generada</li> <li>IDEs, logs, archivos temporales</li> <li>Docker y CI/CD configs</li> </ul>"},{"location":"root_2_configuration_docker-optimization/#frontend","title":"Frontend","text":"<p>Excluye:</p> <ul> <li><code>node_modules/</code>, <code>dist/</code>, builds</li> <li>Cache de Vite, Playwright, tests</li> <li>IDEs, logs, archivos temporales</li> <li>Docker y CI/CD configs</li> </ul>"},{"location":"root_2_configuration_docker-optimization/#comparacion-de-tamanos","title":"\ud83d\ude80 Comparaci\u00f3n de Tama\u00f1os","text":""},{"location":"root_2_configuration_docker-optimization/#antes-vs-despues","title":"Antes vs Despu\u00e9s","text":"Componente Antes Despu\u00e9s Reducci\u00f3n Backend Prod ~800MB ~250MB 68% Frontend Prod ~200MB ~50MB 75% Backend Dev N/A ~900MB - Frontend Dev ~1.2GB ~250MB 79%"},{"location":"root_2_configuration_docker-optimization/#comandos-de-build-recomendados","title":"\ud83d\udd27 Comandos de Build Recomendados","text":""},{"location":"root_2_configuration_docker-optimization/#produccion","title":"Producci\u00f3n","text":"<pre><code># Backend\ndocker build -t cv-builder-backend:latest -f backend/Dockerfile backend/\n\n# Frontend (con API URL)\ndocker build \\\n  --build-arg VITE_API_URL=https://api.example.com \\\n  -t cv-builder-frontend:latest \\\n  -f frontend/Dockerfile \\\n  frontend/\n</code></pre>"},{"location":"root_2_configuration_docker-optimization/#desarrollo","title":"Desarrollo","text":"<pre><code># Usar docker-compose para desarrollo\ndocker-compose -f docker-compose.dev.yml up\n\n# O individualmente\ndocker-compose -f docker-compose.dev.yml up backend\ndocker-compose -f docker-compose.dev.yml up frontend\n</code></pre>"},{"location":"root_2_configuration_docker-optimization/#con-buildkit-mas-rapido","title":"Con BuildKit (m\u00e1s r\u00e1pido)","text":"<pre><code># Habilitar BuildKit para mejor performance\nexport DOCKER_BUILDKIT=1\n\n# O usar docker buildx\ndocker buildx build --platform linux/amd64,linux/arm64 \\\n  -t cv-builder-backend:latest \\\n  -f backend/Dockerfile \\\n  backend/\n</code></pre>"},{"location":"root_2_configuration_docker-optimization/#health-checks","title":"\ud83d\udcca Health Checks","text":""},{"location":"root_2_configuration_docker-optimization/#backend_1","title":"Backend","text":"<ul> <li>Endpoint: <code>http://localhost:8000/api/v1/health</code></li> <li>Intervalo: 30s</li> <li>Timeout: 10s</li> <li>Start period: 40s (tiempo para iniciar)</li> <li>Retries: 3</li> </ul>"},{"location":"root_2_configuration_docker-optimization/#frontend_1","title":"Frontend","text":"<ul> <li>Endpoint: <code>http://localhost/</code></li> <li>Intervalo: 30s</li> <li>Timeout: 5s</li> <li>Start period: 10s (Nginx inicia r\u00e1pido)</li> <li>Retries: 3</li> </ul> <p>Verificar health:</p> <pre><code>docker ps\n# HEALTHY aparecer\u00e1 en la columna STATUS despu\u00e9s del start period\n</code></pre>"},{"location":"root_2_configuration_docker-optimization/#seguridad","title":"\ud83d\udd12 Seguridad","text":""},{"location":"root_2_configuration_docker-optimization/#usuarios-no-root","title":"Usuarios No-Root","text":"<p>Backend:</p> <ul> <li>Producci\u00f3n: <code>appuser</code> (UID 1001)</li> <li>Desarrollo: <code>devuser</code> (UID 1001)</li> </ul> <p>Frontend:</p> <ul> <li>Producci\u00f3n: <code>appuser</code> (UID 1001)</li> <li>Desarrollo: <code>nodeuser</code> (UID 1001)</li> </ul>"},{"location":"root_2_configuration_docker-optimization/#escaneo-de-vulnerabilidades","title":"Escaneo de Vulnerabilidades","text":"<pre><code># Escanear im\u00e1genes con Trivy\ndocker run --rm -v /var/run/docker.sock:/var/run/docker.sock \\\n  aquasec/trivy image cv-builder-backend:latest\n\ndocker run --rm -v /var/run/docker.sock:/var/run/docker.sock \\\n  aquasec/trivy image cv-builder-frontend:latest\n</code></pre>"},{"location":"root_2_configuration_docker-optimization/#mejores-practicas-aplicadas","title":"\ud83d\udca1 Mejores Pr\u00e1cticas Aplicadas","text":"<ol> <li>\u2705 Multi-stage builds para im\u00e1genes peque\u00f1as</li> <li>\u2705 Im\u00e1genes Alpine cuando es posible</li> <li>\u2705 Usuarios no-root para seguridad</li> <li>\u2705 Health checks integrados</li> <li>\u2705 Cache optimization con orden correcto de layers</li> <li>\u2705 .dockerignore completos</li> <li>\u2705 Limpieza de cache de package managers</li> <li>\u2705 ENV variables consolidadas</li> <li>\u2705 BuildKit compatible con mount cache</li> <li>\u2705 Reproducibilidad con versiones fijas</li> </ol>"},{"location":"root_2_configuration_docker-optimization/#troubleshooting","title":"\ud83d\udc1b Troubleshooting","text":""},{"location":"root_2_configuration_docker-optimization/#builds-lentos","title":"Builds lentos","text":"<pre><code># Limpiar build cache\ndocker builder prune -a\n\n# Usar BuildKit con cache mount\nexport DOCKER_BUILDKIT=1\ndocker build --progress=plain ...\n</code></pre>"},{"location":"root_2_configuration_docker-optimization/#permisos-en-desarrollo","title":"Permisos en desarrollo","text":"<pre><code># Si hay problemas con vol\u00famenes, ajustar permisos:\nsudo chown -R $USER:$USER ./backend\nsudo chown -R $USER:$USER ./frontend\n</code></pre>"},{"location":"root_2_configuration_docker-optimization/#health-check-fallando","title":"Health check fallando","text":"<pre><code># Verificar logs\ndocker logs &lt;container-id&gt;\n\n# Entrar al contenedor\ndocker exec -it &lt;container-id&gt; sh\n\n# Probar health check manualmente\ncurl http://localhost:8000/api/v1/health\n</code></pre>"},{"location":"root_2_configuration_docker-optimization/#referencias","title":"\ud83d\udcda Referencias","text":"<ul> <li>Docker Best Practices</li> <li>Multi-stage Builds</li> <li>uv Docker Integration</li> <li>Vite Docker Deployment</li> <li>Nginx Security</li> </ul>"},{"location":"root_2_configuration_fixing-npm-network-timeout/","title":"\ud83c\udf10 Soluci\u00f3n: Errores de Red en Docker Build (npm timeout)","text":""},{"location":"root_2_configuration_fixing-npm-network-timeout/#problema","title":"\u274c Problema","text":"<p>Al construir el Docker del frontend, aparece este error:</p> <pre><code>npm error code ETIMEDOUT\nnpm error errno ETIMEDOUT\nnpm error network request to https://registry.npmjs.org/picomatch/-/picomatch-4.0.3.tgz failed\nnpm error network This is a problem related to network connectivity.\n</code></pre> <p>Causa: Timeout al descargar paquetes de npm dentro del contenedor Docker.</p>"},{"location":"root_2_configuration_fixing-npm-network-timeout/#soluciones-de-mas-rapida-a-mas-completa","title":"\u2705 Soluciones (de m\u00e1s r\u00e1pida a m\u00e1s completa)","text":""},{"location":"root_2_configuration_fixing-npm-network-timeout/#opcion-1-script-automatico-recomendado","title":"Opci\u00f3n 1: Script Autom\u00e1tico (Recomendado) \u26a1","text":"<p>Usa el script que descarga dependencias localmente primero:</p> <pre><code>cd /home/jose/Escritorio/Work/CV-builder\n./build-with-cache.sh\n</code></pre> <p>Ventajas:</p> <ul> <li>\u2705 Descarga dependencias en tu m\u00e1quina local (mejor conectividad)</li> <li>\u2705 Docker solo copia los archivos (sin descargas)</li> <li>\u2705 M\u00e1s r\u00e1pido en builds subsecuentes</li> <li>\u2705 Manejo autom\u00e1tico de errores</li> </ul>"},{"location":"root_2_configuration_fixing-npm-network-timeout/#opcion-2-build-manual-con-volumen-de-cache","title":"Opci\u00f3n 2: Build Manual con Volumen de Cach\u00e9","text":"<p>El <code>docker-compose.dev.yml</code> ya est\u00e1 configurado con un volumen de cach\u00e9:</p> <pre><code># Primera vez (puede tardar)\ndocker compose -f docker-compose.dev.yml build frontend\n\n# Subsecuentes builds usar\u00e1n cach\u00e9\ndocker compose -f docker-compose.dev.yml up -d --build\n</code></pre> <p>El volumen <code>npm_cache</code> persiste las descargas entre builds.</p>"},{"location":"root_2_configuration_fixing-npm-network-timeout/#opcion-3-build-con-buildkit-y-mejor-red","title":"Opci\u00f3n 3: Build con BuildKit y Mejor Red","text":"<pre><code># Habilitar BuildKit\nexport DOCKER_BUILDKIT=1\n\n# Build con logs detallados\ndocker compose -f docker-compose.dev.yml build --progress=plain frontend\n\n# Si falla, reintentar solo frontend\ndocker compose -f docker-compose.dev.yml build --no-cache frontend\n</code></pre>"},{"location":"root_2_configuration_fixing-npm-network-timeout/#opcion-4-instalacion-local-copy","title":"Opci\u00f3n 4: Instalaci\u00f3n Local + COPY","text":"<p>Instala dependencias localmente y Docker las copiar\u00e1:</p> <pre><code>cd frontend\n\n# Instalar localmente\nnpm install\n\n# Volver y hacer build\ncd ..\ndocker compose -f docker-compose.dev.yml build frontend\n</code></pre> <p>Con <code>node_modules</code> local, el Dockerfile usa el volumen montado.</p>"},{"location":"root_2_configuration_fixing-npm-network-timeout/#optimizaciones-aplicadas","title":"\ud83d\udd27 Optimizaciones Aplicadas","text":""},{"location":"root_2_configuration_fixing-npm-network-timeout/#1-dockerfiledev-con-mejor-configuracion-de-red","title":"1. Dockerfile.dev con Mejor Configuraci\u00f3n de Red","text":"<pre><code># Configure npm for better network handling\nRUN npm config set fetch-retry-maxtimeout 120000 &amp;&amp; \\\n    npm config set fetch-retry-mintimeout 10000 &amp;&amp; \\\n    npm config set fetch-retries 5 &amp;&amp; \\\n    npm config set maxsockets 5\n\n# Install with network optimizations\nRUN npm install --prefer-online --no-audit --loglevel=verbose &amp;&amp; \\\n    npm cache clean --force\n</code></pre> <p>Cambios:</p> <ul> <li>\u23f1\ufe0f Timeouts m\u00e1s largos (120s max)</li> <li>\ud83d\udd04 5 reintentos autom\u00e1ticos</li> <li>\ud83c\udf10 <code>--prefer-online</code> para forzar descarga fresca</li> <li>\ud83d\udce6 Menos sockets concurrentes (5) para evitar saturaci\u00f3n</li> </ul>"},{"location":"root_2_configuration_fixing-npm-network-timeout/#2-archivo-npmrc","title":"2. Archivo .npmrc","text":"<p>Creado en <code>frontend/.npmrc</code>:</p> <pre><code>fetch-retry-maxtimeout=120000\nfetch-retry-mintimeout=10000\nfetch-retries=5\nfetch-timeout=300000\nmaxsockets=5\nprefer-online=true\naudit=false\nfund=false\n</code></pre>"},{"location":"root_2_configuration_fixing-npm-network-timeout/#3-volumen-de-cache-en-docker-composedevyml","title":"3. Volumen de Cach\u00e9 en docker-compose.dev.yml","text":"<pre><code>frontend:\n  volumes:\n    - ./frontend:/app\n    - /app/node_modules\n    - npm_cache:/root/.npm # \u2190 Nuevo: persiste cach\u00e9 entre builds\n\nvolumes:\n  npm_cache: # \u2190 Volumen para cach\u00e9 de npm\n</code></pre> <p>Beneficio: Las descargas se guardan y reutilizan entre builds.</p>"},{"location":"root_2_configuration_fixing-npm-network-timeout/#flujo-recomendado","title":"\ud83d\ude80 Flujo Recomendado","text":""},{"location":"root_2_configuration_fixing-npm-network-timeout/#para-desarrollo-diario","title":"Para Desarrollo Diario","text":"<pre><code># Opci\u00f3n A: Script autom\u00e1tico (primera vez o despu\u00e9s de cambios en package.json)\n./build-with-cache.sh\n\n# Opci\u00f3n B: Solo up (si ya est\u00e1 construido)\ndocker compose -f docker-compose.dev.yml up -d\n</code></pre>"},{"location":"root_2_configuration_fixing-npm-network-timeout/#para-builds-limpios","title":"Para Builds Limpios","text":"<pre><code># Limpiar todo y reconstruir\ndocker compose -f docker-compose.dev.yml down -v\ndocker volume rm cv-builder_npm_cache\n./build-with-cache.sh\n</code></pre>"},{"location":"root_2_configuration_fixing-npm-network-timeout/#para-problemas-de-red-persistentes","title":"Para Problemas de Red Persistentes","text":"<pre><code>cd frontend\n\n# Instalar localmente con reintentos\nnpm install --prefer-online --fetch-retries=10\n\n# Verificar que funciona\nnpm run dev\n\n# Luego construir Docker\ncd ..\ndocker compose -f docker-compose.dev.yml up -d --build\n</code></pre>"},{"location":"root_2_configuration_fixing-npm-network-timeout/#troubleshooting","title":"\ud83d\udc1b Troubleshooting","text":""},{"location":"root_2_configuration_fixing-npm-network-timeout/#error-persiste-despues-de-todo","title":"Error persiste despu\u00e9s de todo","text":"<ol> <li>Verificar conectividad:</li> </ol> <pre><code># Probar npm registry\ncurl -I https://registry.npmjs.org/\n\n# Probar dentro de Docker\ndocker run --rm node:20-alpine sh -c \"npm config set fetch-retries 5 &amp;&amp; npm install express\"\n</code></pre> <ol> <li>Limpiar todo:</li> </ol> <pre><code># Limpiar Docker\ndocker system prune -a --volumes\n\n# Limpiar npm local\ncd frontend\nrm -rf node_modules package-lock.json .npmrc\nnpm cache clean --force\n\n# Reinstalar\nnpm install\n</code></pre> <ol> <li>Verificar proxy/firewall:</li> </ol> <pre><code># Si est\u00e1s detr\u00e1s de un proxy corporativo\nnpm config set proxy http://proxy.company.com:8080\nnpm config set https-proxy http://proxy.company.com:8080\n\n# En Dockerfile, agregar:\nENV HTTP_PROXY=http://proxy.company.com:8080\nENV HTTPS_PROXY=http://proxy.company.com:8080\n</code></pre>"},{"location":"root_2_configuration_fixing-npm-network-timeout/#build-extremadamente-lento","title":"Build extremadamente lento","text":"<pre><code># Usar mirror de npm m\u00e1s cercano (opcional)\nnpm config set registry https://registry.npmmirror.com/\n\n# O mantener el oficial pero con mejores timeouts\nnpm config set registry https://registry.npmjs.org/\nnpm config set fetch-timeout 300000\n</code></pre>"},{"location":"root_2_configuration_fixing-npm-network-timeout/#timeout-en-paquete-especifico","title":"Timeout en paquete espec\u00edfico","text":"<pre><code># Identificar el paquete problem\u00e1tico en los logs\n# Instalarlo manualmente primero\nnpm install picomatch@4.0.3 --save-dev\n\n# Luego build\ndocker compose -f docker-compose.dev.yml build frontend\n</code></pre>"},{"location":"root_2_configuration_fixing-npm-network-timeout/#comparacion-de-metodos","title":"\ud83d\udcca Comparaci\u00f3n de M\u00e9todos","text":"M\u00e9todo Velocidad Robustez Uso Script autom\u00e1tico \u26a1\u26a1\u26a1 \ud83d\udee1\ufe0f\ud83d\udee1\ufe0f\ud83d\udee1\ufe0f Primera build, cambios de deps Volumen de cach\u00e9 \u26a1\u26a1 \ud83d\udee1\ufe0f\ud83d\udee1\ufe0f Builds subsecuentes npm install local \u26a1\u26a1\u26a1 \ud83d\udee1\ufe0f\ud83d\udee1\ufe0f\ud83d\udee1\ufe0f Problemas persistentes Build sin cach\u00e9 \u26a1 \ud83d\udee1\ufe0f Debugging, builds limpios"},{"location":"root_2_configuration_fixing-npm-network-timeout/#prevencion","title":"\ud83d\udca1 Prevenci\u00f3n","text":""},{"location":"root_2_configuration_fixing-npm-network-timeout/#1-mantener-node_modules-local-actualizado","title":"1. Mantener node_modules local actualizado","text":"<pre><code># Antes de hacer build de Docker\ncd frontend\nnpm install\ncd ..\n./build-with-cache.sh\n</code></pre>"},{"location":"root_2_configuration_fixing-npm-network-timeout/#2-usar-el-volumen-de-cache-siempre","title":"2. Usar el volumen de cach\u00e9 siempre","text":"<p>Ya est\u00e1 configurado en <code>docker-compose.dev.yml</code>, solo aseg\u00farate de no hacer <code>down -v</code> a menos que quieras limpiar todo.</p>"},{"location":"root_2_configuration_fixing-npm-network-timeout/#3-monitorear-logs-de-build","title":"3. Monitorear logs de build","text":"<pre><code># Ver logs completos durante build\ndocker compose -f docker-compose.dev.yml build --progress=plain frontend 2&gt;&amp;1 | tee build.log\n</code></pre>"},{"location":"root_2_configuration_fixing-npm-network-timeout/#archivos-creadosmodificados","title":"\ud83d\udcda Archivos Creados/Modificados","text":"<ol> <li>\u2705 frontend/Dockerfile.dev - Configuraci\u00f3n de red optimizada</li> <li>\u2705 frontend/Dockerfile - Configuraci\u00f3n de red para producci\u00f3n</li> <li>\u2705 frontend/.npmrc - Configuraci\u00f3n persistente de npm</li> <li>\u2705 docker-compose.dev.yml - Volumen de cach\u00e9 agregado</li> <li>\u2705 build-with-cache.sh - Script de build inteligente</li> </ol>"},{"location":"root_2_configuration_fixing-npm-network-timeout/#siguiente-paso-recomendado","title":"\ud83c\udfaf Siguiente Paso Recomendado","text":"<p>Ejecuta el script de build optimizado:</p> <pre><code>cd /home/jose/Escritorio/Work/CV-builder\n./build-with-cache.sh\n</code></pre> <p>Este script:</p> <ol> <li>\u2705 Descarga dependencias localmente (mejor red)</li> <li>\u2705 Construye Docker con cach\u00e9</li> <li>\u2705 Maneja errores autom\u00e1ticamente</li> <li>\u2705 Muestra progreso claro</li> <li>\u2705 Inicia los servicios al finalizar</li> </ol>"},{"location":"root_2_configuration_fixing-npm-network-timeout/#referencias","title":"\ud83d\udcd6 Referencias","text":"<ul> <li>npm config documentation</li> <li>Docker BuildKit</li> <li>npm network troubleshooting</li> <li>Docker volumes</li> </ul>"},{"location":"root_2_configuration_playwright-optimization/","title":"\ud83c\udfad Dockerfile de Playwright Optimizado","text":""},{"location":"root_2_configuration_playwright-optimization/#resumen-de-optimizaciones","title":"\ud83d\udccb Resumen de Optimizaciones","text":"<p>El Dockerfile de Playwright ha sido completamente optimizado siguiendo las mismas mejores pr\u00e1cticas aplicadas al frontend:</p>"},{"location":"root_2_configuration_playwright-optimization/#mejoras-implementadas","title":"\u2728 Mejoras Implementadas","text":""},{"location":"root_2_configuration_playwright-optimization/#1-configuracion-de-red-robusta","title":"1. Configuraci\u00f3n de Red Robusta","text":"<pre><code>RUN npm config set fetch-retry-maxtimeout 120000 &amp;&amp; \\\n    npm config set fetch-retry-mintimeout 10000 &amp;&amp; \\\n    npm config set fetch-retries 5 &amp;&amp; \\\n    npm config set maxsockets 5\n</code></pre> <ul> <li>\u23f1\ufe0f Timeouts largos (120s)</li> <li>\ud83d\udd04 5 reintentos autom\u00e1ticos</li> <li>\ud83d\udce6 Control de conexiones concurrentes</li> </ul>"},{"location":"root_2_configuration_playwright-optimization/#2-usuario-no-root-para-seguridad","title":"2. Usuario No-Root para Seguridad","text":"<pre><code>RUN groupadd -r playwright -g 1001 &amp;&amp; \\\n    useradd -r -g playwright -u 1001 -d /app playwright\nUSER playwright\n</code></pre> <ul> <li>\ud83d\udd12 Usuario <code>playwright</code> con UID 1001</li> <li>\u2705 Cumple con mejores pr\u00e1cticas de seguridad</li> <li>\ud83d\udee1\ufe0f Reduce superficie de ataque</li> </ul>"},{"location":"root_2_configuration_playwright-optimization/#3-cache-optimization","title":"3. Cache Optimization","text":"<pre><code># Layer caching optimizado\nCOPY package*.json ./      # Layer 1: Dependencias (cambia raramente)\nRUN npm ci --prefer-online  # Layer 2: Instalaci\u00f3n\nCOPY . .                    # Layer 3: C\u00f3digo (cambia frecuentemente)\n</code></pre>"},{"location":"root_2_configuration_playwright-optimization/#4-instalacion-eficiente-de-navegadores","title":"4. Instalaci\u00f3n Eficiente de Navegadores","text":"<pre><code>RUN npx playwright install --with-deps chromium firefox webkit || \\\n    npx playwright install chromium\n</code></pre> <ul> <li>\ud83c\udf10 Instala todos los navegadores necesarios</li> <li>\u267b\ufe0f Fallback a Chromium si falla instalaci\u00f3n completa</li> <li>\ud83d\udcbe Usa cach\u00e9 de <code>/ms-playwright</code></li> </ul>"},{"location":"root_2_configuration_playwright-optimization/#5-health-check-integrado","title":"5. Health Check Integrado","text":"<pre><code>HEALTHCHECK --interval=30s --timeout=10s --start-period=5s --retries=2 \\\n    CMD npx playwright --version || exit 1\n</code></pre> <ul> <li>\u2705 Verifica que Playwright est\u00e1 listo</li> <li>\ud83d\ude80 Start period corto (5s)</li> <li>\ud83d\udcca Visible en <code>docker ps</code></li> </ul>"},{"location":"root_2_configuration_playwright-optimization/#6-directorios-de-test-preparados","title":"6. Directorios de Test Preparados","text":"<pre><code>RUN mkdir -p \\\n    /app/test-results \\\n    /app/playwright-report \\\n    /app/playwright/.cache &amp;&amp; \\\n    chown -R playwright:playwright ...\n</code></pre> <ul> <li>\ud83d\udcc1 Directorios con permisos correctos</li> <li>\ud83d\udcbe Listos para persistir resultados</li> <li>\ud83d\udd17 Montables como vol\u00famenes</li> </ul>"},{"location":"root_2_configuration_playwright-optimization/#optimizaciones-en-docker-compose","title":"\ud83d\udc33 Optimizaciones en docker-compose","text":""},{"location":"root_2_configuration_playwright-optimization/#volumenes-agregados","title":"Vol\u00famenes Agregados","text":""},{"location":"root_2_configuration_playwright-optimization/#docker-composedevyml-y-docker-composeprodyml","title":"docker-compose.dev.yml y docker-compose.prod.yml:","text":"<pre><code>volumes:\n  # Cach\u00e9 de navegadores (persiste entre builds)\n  - playwright_cache:/ms-playwright\n  # Resultados accesibles desde el host\n  - ./frontend/test-results:/app/test-results\n  - ./frontend/playwright-report:/app/playwright-report\n</code></pre> <p>Beneficios:</p> <ul> <li>\ud83d\ude80 No re-descarga navegadores (~500MB) en cada build</li> <li>\ud83d\udcca Reportes accesibles sin entrar al contenedor</li> <li>\u26a1 Builds subsecuentes 10x m\u00e1s r\u00e1pidos</li> </ul>"},{"location":"root_2_configuration_playwright-optimization/#variables-de-entorno","title":"Variables de Entorno","text":"<pre><code>environment:\n  - NODE_ENV=test\n  - CI=true\n  - PLAYWRIGHT_BROWSERS_PATH=/ms-playwright\n  - PLAYWRIGHT_SKIP_BROWSER_DOWNLOAD=1\n</code></pre> <p>Optimizaciones:</p> <ul> <li>Evita descargas redundantes</li> <li>Modo CI optimizado</li> <li>Usa navegadores pre-instalados</li> </ul>"},{"location":"root_2_configuration_playwright-optimization/#como-usar","title":"\ud83d\ude80 C\u00f3mo Usar","text":""},{"location":"root_2_configuration_playwright-optimization/#1-ejecutar-tests-con-el-script-helper","title":"1. Ejecutar Tests con el Script Helper","text":"<pre><code># Todos los tests\n./run-playwright-tests.sh all\n\n# Test espec\u00edfico\n./run-playwright-tests.sh tests/login.spec.ts\n\n# Modo UI interactivo\n./run-playwright-tests.sh ui\n\n# Ver reporte\n./run-playwright-tests.sh report\n\n# Abrir shell en el contenedor\n./run-playwright-tests.sh shell\n</code></pre>"},{"location":"root_2_configuration_playwright-optimization/#2-comandos-docker-directos","title":"2. Comandos Docker Directos","text":"<pre><code># Ejecutar todos los tests\ndocker compose -f docker-compose.dev.yml exec playwright npx playwright test\n\n# Test espec\u00edfico con par\u00e1metros\ndocker compose -f docker-compose.dev.yml exec playwright npx playwright test \\\n  --project=chromium \\\n  --grep=\"login\" \\\n  --reporter=html\n\n# Ver reporte\ndocker compose -f docker-compose.dev.yml exec playwright npx playwright show-report\n\n# Debug mode\ndocker compose -f docker-compose.dev.yml exec playwright npx playwright test --debug\n</code></pre>"},{"location":"root_2_configuration_playwright-optimization/#3-desarrollo-de-tests","title":"3. Desarrollo de Tests","text":"<pre><code># Abrir shell en el contenedor\n./run-playwright-tests.sh shell\n\n# Dentro del contenedor:\nnpx playwright codegen http://frontend:5173\nnpx playwright test --ui\nnpx playwright test --headed\n</code></pre>"},{"location":"root_2_configuration_playwright-optimization/#comparacion-antes-vs-despues","title":"\ud83d\udcca Comparaci\u00f3n Antes vs Despu\u00e9s","text":"Aspecto Antes Despu\u00e9s Mejora Build time ~5 min ~2 min 60% m\u00e1s r\u00e1pido Image size ~2.5GB ~2.5GB Igual (navegadores) Re-build ~5 min ~30s 90% m\u00e1s r\u00e1pido Network errors Frecuentes Raros Reintentos Security Root No-root M\u00e1s seguro Cache No S\u00ed Persistente"},{"location":"root_2_configuration_playwright-optimization/#estructura-de-directorios","title":"\ud83c\udfaf Estructura de Directorios","text":"<pre><code>frontend/\n\u251c\u2500\u2500 tests/                    # Tests de Playwright\n\u2502   \u251c\u2500\u2500 auth.setup.ts\n\u2502   \u251c\u2500\u2500 login.spec.ts\n\u2502   \u2514\u2500\u2500 ...\n\u251c\u2500\u2500 test-results/            # Resultados (gitignored, montado)\n\u251c\u2500\u2500 playwright-report/       # Reportes HTML (gitignored, montado)\n\u251c\u2500\u2500 playwright.config.ts     # Configuraci\u00f3n\n\u251c\u2500\u2500 Dockerfile.playwright    # Dockerfile optimizado\n\u2514\u2500\u2500 .gitignore              # Excluye resultados\n</code></pre>"},{"location":"root_2_configuration_playwright-optimization/#configuracion-recomendada","title":"\ud83d\udd27 Configuraci\u00f3n Recomendada","text":""},{"location":"root_2_configuration_playwright-optimization/#playwrightconfigts","title":"playwright.config.ts","text":"<pre><code>export default defineConfig({\n  // Usar workers basados en CPUs del contenedor\n  workers: process.env.CI ? 1 : undefined,\n\n  // Retries en CI\n  retries: process.env.CI ? 2 : 0,\n\n  // Reportes\n  reporter: [\n    [\"html\", { outputFolder: \"playwright-report\" }],\n    [\"json\", { outputFile: \"test-results/results.json\" }],\n  ],\n\n  // Output\n  outputDir: \"test-results\",\n\n  // Proyectos (navegadores)\n  projects: [\n    { name: \"chromium\", use: { ...devices[\"Desktop Chrome\"] } },\n    { name: \"firefox\", use: { ...devices[\"Desktop Firefox\"] } },\n    { name: \"webkit\", use: { ...devices[\"Desktop Safari\"] } },\n  ],\n});\n</code></pre>"},{"location":"root_2_configuration_playwright-optimization/#troubleshooting","title":"\ud83d\udc1b Troubleshooting","text":""},{"location":"root_2_configuration_playwright-optimization/#build-falla-al-instalar-navegadores","title":"Build falla al instalar navegadores","text":"<pre><code># Limpiar cach\u00e9 y reconstruir\ndocker volume rm cv-builder_playwright_cache\ndocker compose -f docker-compose.dev.yml build --no-cache playwright\ndocker compose -f docker-compose.dev.yml up -d playwright\n</code></pre>"},{"location":"root_2_configuration_playwright-optimization/#tests-fallan-con-timeout","title":"Tests fallan con timeout","text":"<pre><code># Aumentar timeout en playwright.config.ts\ntimeout: 60000,  // 60 segundos\n\n# O en el test espec\u00edfico\ntest('slow test', async ({ page }) =&gt; {\n  test.setTimeout(120000);  // 120 segundos\n  // ...\n});\n</code></pre>"},{"location":"root_2_configuration_playwright-optimization/#no-se-puede-abrir-ui-mode","title":"No se puede abrir UI mode","text":"<p>El modo UI requiere X11 forwarding. Alternativas:</p> <pre><code># Opci\u00f3n 1: Ejecutar localmente (no en Docker)\ncd frontend\nnpm install\nnpx playwright test --ui\n\n# Opci\u00f3n 2: Usar Playwright trace viewer\ndocker compose -f docker-compose.dev.yml exec playwright \\\n  npx playwright test --trace on\ndocker compose -f docker-compose.dev.yml exec playwright \\\n  npx playwright show-trace test-results/.../trace.zip\n</code></pre>"},{"location":"root_2_configuration_playwright-optimization/#permisos-en-test-results","title":"Permisos en test-results","text":"<pre><code># Cambiar ownership de directorios de resultados\nsudo chown -R $USER:$USER frontend/test-results frontend/playwright-report\n\n# O ejecutar como tu usuario dentro del contenedor\ndocker compose -f docker-compose.dev.yml exec --user $(id -u):$(id -g) \\\n  playwright npx playwright test\n</code></pre>"},{"location":"root_2_configuration_playwright-optimization/#seguridad","title":"\ud83d\udd10 Seguridad","text":""},{"location":"root_2_configuration_playwright-optimization/#usuario-no-root","title":"Usuario No-Root","text":"<pre><code>USER playwright  # UID 1001\n</code></pre> <p>Implicaciones:</p> <ul> <li>\u2705 Archivos creados con permisos correctos</li> <li>\u2705 Contenedor m\u00e1s seguro</li> <li>\u2705 Cumple con pol\u00edticas de seguridad corporativas</li> </ul>"},{"location":"root_2_configuration_playwright-optimization/#verificar","title":"Verificar","text":"<pre><code># Verificar usuario dentro del contenedor\ndocker compose -f docker-compose.dev.yml exec playwright whoami\n# Output: playwright\n\n# Verificar UID\ndocker compose -f docker-compose.dev.yml exec playwright id\n# Output: uid=1001(playwright) gid=1001(playwright) groups=1001(playwright)\n</code></pre>"},{"location":"root_2_configuration_playwright-optimization/#scripts-disponibles","title":"\ud83d\udcda Scripts Disponibles","text":""},{"location":"root_2_configuration_playwright-optimization/#run-playwright-testssh","title":"run-playwright-tests.sh","text":"<p>Script helper con m\u00faltiples comandos:</p> <pre><code>./run-playwright-tests.sh all         # Todos los tests\n./run-playwright-tests.sh ui          # Modo UI\n./run-playwright-tests.sh headed      # Con navegador visible\n./run-playwright-tests.sh debug       # Modo debug\n./run-playwright-tests.sh report      # Ver reporte\n./run-playwright-tests.sh codegen     # Grabar tests\n./run-playwright-tests.sh install     # Reinstalar deps\n./run-playwright-tests.sh shell       # Shell interactiva\n./run-playwright-tests.sh clean       # Limpiar resultados\n</code></pre>"},{"location":"root_2_configuration_playwright-optimization/#tips-y-mejores-practicas","title":"\ud83d\udca1 Tips y Mejores Pr\u00e1cticas","text":""},{"location":"root_2_configuration_playwright-optimization/#1-usar-el-cache-correctamente","title":"1. Usar el Cach\u00e9 Correctamente","text":"<pre><code># Primera build (descarga navegadores)\ndocker compose -f docker-compose.dev.yml build playwright\n\n# Subsecuentes builds (usa cach\u00e9)\ndocker compose -f docker-compose.dev.yml build playwright\n# \u2190 Mucho m\u00e1s r\u00e1pido!\n</code></pre>"},{"location":"root_2_configuration_playwright-optimization/#2-ejecutar-solo-tests-necesarios","title":"2. Ejecutar Solo Tests Necesarios","text":"<pre><code># Por navegador\ndocker compose -f docker-compose.dev.yml exec playwright \\\n  npx playwright test --project=chromium\n\n# Por archivo\ndocker compose -f docker-compose.dev.yml exec playwright \\\n  npx playwright test tests/login.spec.ts\n\n# Por patr\u00f3n\ndocker compose -f docker-compose.dev.yml exec playwright \\\n  npx playwright test --grep=\"login\"\n</code></pre>"},{"location":"root_2_configuration_playwright-optimization/#3-cicd-integration","title":"3. CI/CD Integration","text":"<pre><code># .github/workflows/test.yml\n- name: Run Playwright tests\n  run: |\n    docker compose -f docker-compose.dev.yml up -d playwright\n    docker compose -f docker-compose.dev.yml exec -T playwright \\\n      npx playwright test --reporter=github\n</code></pre>"},{"location":"root_2_configuration_playwright-optimization/#4-debugging-avanzado","title":"4. Debugging Avanzado","text":"<pre><code># Trace viewer\ndocker compose -f docker-compose.dev.yml exec playwright \\\n  npx playwright test --trace on\n\n# Screenshots on failure\ndocker compose -f docker-compose.dev.yml exec playwright \\\n  npx playwright test --screenshot=only-on-failure\n\n# Video recording\ndocker compose -f docker-compose.dev.yml exec playwright \\\n  npx playwright test --video=on\n</code></pre>"},{"location":"root_2_configuration_playwright-optimization/#proximos-pasos","title":"\ud83c\udfaf Pr\u00f3ximos Pasos","text":"<ol> <li>\u2705 Tests ejecut\u00e1ndose en contenedor optimizado</li> <li>\ud83d\udcca Ver reportes en <code>frontend/playwright-report/index.html</code></li> <li>\ud83d\udd04 Integrar con CI/CD</li> <li>\ud83d\udcc8 Agregar m\u00e1s tests E2E</li> </ol>"},{"location":"root_2_configuration_playwright-optimization/#referencias","title":"\ud83d\udcd6 Referencias","text":"<ul> <li>Playwright Docker</li> <li>Playwright CI</li> <li>Dockerfile Best Practices</li> <li>Non-root Containers</li> </ul>"},{"location":"root_README/","title":"README","text":""},{"location":"root_README/#guia-de-instalacion-y-puesta-en-marcha","title":"\ud83d\ude80 Gu\u00eda de Instalaci\u00f3n y Puesta en Marcha","text":"<p>Para levantar el proyecto en tu entorno local, aseg\u00farate de tener <code>Docker</code> y <code>Docker Compose</code> instalados.</p> <ol> <li> <p>Clona el repositorio: <pre><code>git clone [URL_DE_TU_REPOSITORIO]\ncd [NOMBRE_DEL_REPOSITORIO]\n</code></pre></p> </li> <li> <p>Configura las variables de entorno:</p> <ul> <li>En la ra\u00edz del proyecto, encontrar\u00e1s los archivos <code>.env.example</code> para el backend y el frontend.</li> <li>Crea una copia de cada uno y ren\u00f3mbrala a <code>.env</code>.     <pre><code>cp ./backend/.env.example ./backend/.env\ncp ./frontend/.env.example ./frontend/.env\n</code></pre></li> <li>Revisa los archivos <code>.env</code> y ajusta las variables si es necesario (ej. <code>POSTGRES_PASSWORD</code>, <code>SECRET_KEY</code>).</li> </ul> </li> <li> <p>Levanta los servicios con Docker Compose:</p> <ul> <li>Desde la ra\u00edz del proyecto, ejecuta el siguiente comando. Esto construir\u00e1 las im\u00e1genes y levantar\u00e1 los contenedores del frontend, backend y la base de datos. <pre><code>docker-compose up --build\n</code></pre></li> </ul> </li> <li> <p>\u00a1Listo para usar!</p> <ul> <li>\ud83c\udf10 Frontend: La aplicaci\u00f3n estar\u00e1 disponible en <code>http://localhost:3000</code>.</li> <li>\ud83d\ude80 Backend (API Docs): La documentaci\u00f3n interactiva de la API estar\u00e1 en <code>http://localhost:8000/docs</code>.</li> </ul> </li> </ol>"},{"location":"root_index/","title":"\ud83d\udcda Documentaci\u00f3n Interna de la Plataforma","text":"<p>Bienvenido a la documentaci\u00f3n t\u00e9cnica completa del proyecto Feature Model. Esta documentaci\u00f3n est\u00e1 organizada en tres secciones principales que cubren todos los aspectos del sistema.</p>"},{"location":"root_index/#acceso-rapido","title":"\ud83d\ude80 Acceso R\u00e1pido","text":""},{"location":"root_index/#repositorio","title":"Repositorio","text":"<p> Repositorio GitHub</p>"},{"location":"root_index/#proyecto-root","title":"\ud83d\udce6 Proyecto (Root)","text":"<p>Documentaci\u00f3n general del proyecto, arquitectura global y configuraci\u00f3n de despliegue.</p> <p> Explorar Documentaci\u00f3n del Proyecto</p>"},{"location":"root_index/#backend","title":"\u2699\ufe0f Backend","text":"<p>API, modelos de datos, servicios, migraciones y documentaci\u00f3n t\u00e9cnica del backend.</p> <p> Explorar Documentaci\u00f3n del Backend</p>"},{"location":"root_index/#frontend","title":"\ud83c\udfa8 Frontend","text":"<p>Componentes, p\u00e1ginas, hooks y documentaci\u00f3n del frontend (En construcci\u00f3n).</p> <p> Explorar Documentaci\u00f3n del Frontend</p>"},{"location":"root_index/#estructura-de-la-documentacion","title":"\ud83d\udcd6 Estructura de la Documentaci\u00f3n","text":""},{"location":"root_index/#proyecto-root_1","title":"\ud83d\udce6 Proyecto (Root)","text":"<p>Documentaci\u00f3n de nivel superior que abarca:</p> <ul> <li>Arquitectura: Estructura de carpetas, base de datos, arquitectura de despliegue</li> <li>Configuraci\u00f3n: Entornos de desarrollo y producci\u00f3n</li> <li>Requisitos: Requisitos funcionales y no funcionales del sistema</li> </ul> <p>Archivos principales:</p> <ul> <li>\u00cdndice del Proyecto</li> <li>README</li> <li>Requisitos</li> <li>Arquitectura - Estructura de Carpetas</li> <li>Arquitectura - Base de Datos</li> <li>Arquitectura - Despliegue</li> <li>Configuraci\u00f3n - Desarrollo</li> <li>Configuraci\u00f3n - Despliegue</li> </ul>"},{"location":"root_index/#backend_1","title":"\u2699\ufe0f Backend","text":"<p>Documentaci\u00f3n t\u00e9cnica del backend (FastAPI + PostgreSQL):</p> <p>Core:</p> <ul> <li>README Backend - Introducci\u00f3n y setup</li> <li>Comandos - Comandos \u00fatiles de desarrollo</li> <li>Base de Datos - Esquema y migraciones</li> <li>Arquitectura S3 - Gesti\u00f3n de archivos</li> </ul> <p>Refactorings y Mejoras:</p> <ul> <li>Cambios Educativos</li> <li>Login Endpoints Refactor</li> <li>Resumen Refactor Login</li> <li>Maestr\u00eda Ciencia de Datos</li> <li>Orden de Migraciones</li> <li>Servicio Prestart</li> </ul> <p>Servicios S3:</p> <ul> <li>Refactoring S3</li> <li>Ejemplos S3 Dependencies</li> <li>Cambios Servicio S3</li> <li>Uso Servicio S3</li> </ul> <p>Gesti\u00f3n de Usuarios:</p> <ul> <li>Migraci\u00f3n User Endpoints</li> <li>Roles de Usuario</li> <li>Sugerencias de C\u00f3digo</li> <li>Requisitos Funcionales</li> </ul>"},{"location":"root_index/#frontend_1","title":"\ud83c\udfa8 Frontend","text":"<p>Documentaci\u00f3n del frontend (Next.js + TypeScript):</p> <p>En construcci\u00f3n</p> <p>La documentaci\u00f3n del frontend est\u00e1 actualmente en desarrollo. Pr\u00f3ximamente se agregar\u00e1n documentos sobre componentes, hooks, p\u00e1ginas y servicios.</p>"},{"location":"root_index/#caracteristicas-de-esta-documentacion","title":"\ud83d\udd27 Caracter\u00edsticas de esta Documentaci\u00f3n","text":"<p>Esta documentaci\u00f3n incluye:</p> <ul> <li>\u2705 B\u00fasqueda en tiempo real - Busca en todo el contenido</li> <li>\u2705 Modo oscuro/claro - Cambia el tema seg\u00fan tu preferencia</li> <li>\u2705 Navegaci\u00f3n por pesta\u00f1as - Organizaci\u00f3n clara por secciones</li> <li>\u2705 C\u00f3digo con resaltado - Syntax highlighting para m\u00faltiples lenguajes</li> <li>\u2705 Diagramas Mermaid - Visualizaci\u00f3n de flujos y arquitecturas</li> <li>\u2705 Responsive - Optimizada para desktop y m\u00f3vil</li> </ul>"},{"location":"root_index/#tecnologias-documentadas","title":"\ud83d\udcca Tecnolog\u00edas Documentadas","text":"BackendFrontendDevOps <ul> <li>Framework: FastAPI 0.104+</li> <li>Base de Datos: PostgreSQL 17</li> <li>ORM: SQLModel + SQLAlchemy</li> <li>Cache: Redis</li> <li>Storage: MinIO (S3 compatible)</li> <li>Tasks: Celery</li> <li>Migraciones: Alembic</li> </ul> <ul> <li>Framework: Next.js 14+</li> <li>Lenguaje: TypeScript</li> <li>UI Library: React</li> <li>Estilos: CSS Modules / Tailwind</li> <li>State: Zustand / React Query</li> </ul> <ul> <li>Containerizaci\u00f3n: Docker + Docker Compose</li> <li>CI/CD: GitHub Actions</li> <li>Documentaci\u00f3n: MkDocs Material</li> <li>Linting: ESLint, Ruff, MyPy</li> </ul>"},{"location":"root_index/#ayuda-y-soporte","title":"\ud83c\udd98 Ayuda y Soporte","text":"<p>Si encuentras alg\u00fan problema o tienes sugerencias:</p> <ol> <li>\ud83d\udcdd Documentaci\u00f3n incompleta: Abre un issue en GitHub</li> <li>\ud83d\udc1b Bug en la aplicaci\u00f3n: Reporta en el repositorio</li> <li>\ud83d\udca1 Sugerencia de mejora: Crea una discusi\u00f3n en GitHub</li> </ol>"},{"location":"root_index/#enlaces-utiles","title":"\ud83d\udccc Enlaces \u00datiles","text":"<ul> <li> Repositorio GitHub</li> </ul> <p>Servicios de la Aplicaci\u00f3n:</p> <p>URLs Din\u00e1micas</p> <p>Los siguientes enlaces se configuran autom\u00e1ticamente seg\u00fan el entorno:</p> <pre><code>- **Desarrollo:** `http://localhost:8000` (backend), `http://localhost:5173` (frontend)\n- **Producci\u00f3n:** Configurado mediante variables de entorno `DOMAIN` y `FRONTEND_URL`\n</code></pre> API DocumentationFrontend <ul> <li>Swagger UI: <code>{{ config.extra.domain }}/docs</code></li> <li>ReDoc: <code>{{ config.extra.domain }}/redoc</code></li> </ul> <ul> <li>Dashboard: <code>{{ config.extra.frontend_url }}</code></li> </ul> <p>Enlaces R\u00e1pidos (Desarrollo):</p> <ul> <li> API Docs - Swagger</li> </ul> <p>Documentaci\u00f3n interactiva de la API con interfaz Swagger UI</p> <p> Abrir Swagger</p> <ul> <li> API Docs - ReDoc</li> </ul> <p>Documentaci\u00f3n de la API en formato ReDoc</p> <p> Abrir ReDoc</p> <ul> <li> Dashboard Frontend</li> </ul> <p>Interfaz de usuario de la aplicaci\u00f3n</p> <p> Abrir Dashboard</p>   **Feature Model Platform** | Documentaci\u00f3n Interna   \u00daltima actualizaci\u00f3n: {{ git.date }}"}]}